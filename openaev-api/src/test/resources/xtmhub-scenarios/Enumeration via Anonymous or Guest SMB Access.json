{
  "export_version" : 1,
  "scenario_information" : {
    "scenario_id" : "0a66aed4-c93c-4a10-abde-4cd2cfe7a4ed",
    "scenario_name" : "Enumeration via Anonymous or Guest SMB Access",
    "scenario_description" : "Objectives:\n\nDetect systems that allow null session SMB connections.\nIdentify hosts accepting Guest authentication via SMB.\nEnumerate users, groups, and shared resources available through unauthenticated or weak access.\nAssess the lateral movement surface based on insecure SMB configurations.",
    "scenario_subtitle" : "",
    "scenario_category" : "attack-scenario",
    "scenario_main_focus" : "endpoint-protection",
    "scenario_severity" : "high",
    "scenario_message_header" : "SIMULATION HEADER",
    "scenario_message_footer" : "SIMULATION FOOTER",
    "scenario_mail_from" : "no-reply@openbas.io",
    "scenario_tags" : [ ],
    "scenario_documents" : [ ]
  },
  "scenario_teams" : [ ],
  "scenario_objectives" : null,
  "scenario_users" : [ ],
  "scenario_organizations" : [ ],
  "scenario_injects" : [ {
    "inject_id" : "5d778641-3904-4ba4-990b-371353445545",
    "inject_title" : "SMB Lateral Movement - Enumeration Guest authentication - Windows",
    "inject_description" : "",
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Prevention",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Detection",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ],
      "obfuscator" : "plain-text",
      "IP" : "127.0.0.1"
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 0,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "SMB Lateral Movement - Enumeration Guest authentication - Windows",
          "fr" : "SMB Lateral Movement - Enumeration Guest authentication - Windows"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        }, {
          "key" : "IP",
          "label" : "IP",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "192.168.56.0/24",
          "type" : "text"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "29412433-e4e9-45bf-9dc2-7d7722e6638b",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "29412433-e4e9-45bf-9dc2-7d7722e6638b",
      "injector_contract_labels" : {
        "en" : "SMB Lateral Movement - Enumeration Guest authentication - Windows",
        "fr" : "SMB Lateral Movement - Enumeration Guest authentication - Windows"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"SMB Lateral Movement - Enumeration Guest authentication - Windows\",\"fr\":\"SMB Lateral Movement - Enumeration Guest authentication - Windows\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"},{\"key\":\"IP\",\"label\":\"IP\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"192.168.56.0/24\",\"type\":\"text\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"29412433-e4e9-45bf-9dc2-7d7722e6638b\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "5949509d-47d9-490e-919d-2d1cad77d83f",
        "payload_type" : "Command",
        "payload_name" : "SMB Lateral Movement - Enumeration Guest authentication - Windows",
        "payload_description" : "Guest authentication is an authentication method that relies on guest accounts. These special accounts are used to give access to a Windows computer (local guest account) or to domain resources (domain guest account) to users who do not have valid credentials but still need to access a computer\nReference: https://blog.whiteflag.io/blog/guest-vs-null-session-on-windows/",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "c0ce4192-7224-42ec-b640-bec6a9501890",
          "attack_pattern_name" : "SMB/Windows Admin Shares",
          "attack_pattern_description" : "Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to interact with a remote network share using Server Message Block (SMB). The adversary may then perform actions as the logged-on user.\n\nSMB is a file, printer, and serial port sharing protocol for Windows machines on the same network or domain. Adversaries may use SMB to interact with file shares, allowing them to move laterally throughout a network. Linux and macOS implementations of SMB typically use Samba.\n\nWindows systems have hidden network shares that are accessible only to administrators and provide the ability for remote file copy and other administrative functions. Example network shares include `C$`, `ADMIN$`, and `IPC$`. Adversaries may use this technique in conjunction with administrator-level [Valid Accounts](https://attack.mitre.org/techniques/T1078) to remotely access a networked system over SMB,(Citation: Wikipedia Server Message Block) to interact with systems using remote procedure calls (RPCs),(Citation: TechNet RPC) transfer files, and run transferred binaries through remote Execution. Example execution techniques that rely on authenticated sessions over SMB/RPC are [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), [Service Execution](https://attack.mitre.org/techniques/T1569/002), and [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047). Adversaries can also use NTLM hashes to access administrator shares on systems with [Pass the Hash](https://attack.mitre.org/techniques/T1550/002) and certain configuration and patch levels.(Citation: Microsoft Admin Shares)",
          "attack_pattern_external_id" : "T1021.002",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "e03bd741-2536-48d6-8fd5-a36e0d2a3f2a",
            "phase_external_id" : "TA0008",
            "phase_stix_id" : "x-mitre-tactic--7141578b-e50b-4dcc-bfa4-08a8dd689e9e",
            "phase_name" : "Lateral Movement",
            "phase_shortname" : "lateral-movement",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to move through your environment.\n\nLateral Movement consists of techniques that adversaries use to enter and control remote systems on a network. Following through on their primary objective often requires exploring the network to find their target and subsequently gaining access to it. Reaching their objective often involves pivoting through multiple systems and accounts to gain. Adversaries might install their own remote access tools to accomplish Lateral Movement or use legitimate credentials with native network and operating system tools, which may be stealthier. ",
            "phase_order" : 9
          } ]
        }, {
          "attack_pattern_id" : "c007dc45-597d-479a-93e9-8e7f2611c020",
          "attack_pattern_name" : "Default Accounts",
          "attack_pattern_description" : "Adversaries may obtain and abuse credentials of a default account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Default accounts are those that are built-into an OS, such as the Guest or Administrator accounts on Windows systems. Default accounts also include default factory/provider set accounts on other types of systems, software, or devices, including the root user account in AWS, the root user account in ESXi, and the default service account in Kubernetes.(Citation: Microsoft Local Accounts Feb 2019)(Citation: AWS Root User)(Citation: Threat Matrix for Kubernetes)\n\nDefault accounts are not limited to client machines; rather, they also include accounts that are preset for equipment such as network devices and computer applications, whether they are internal, open source, or commercial. Appliances that come preset with a username and password combination pose a serious threat to organizations that do not change it post installation, as they are easy targets for an adversary. Similarly, adversaries may also utilize publicly disclosed or stolen [Private Keys](https://attack.mitre.org/techniques/T1552/004) or credential materials to legitimately connect to remote environments via [Remote Services](https://attack.mitre.org/techniques/T1021).(Citation: Metasploit SSH Module)\n\nDefault accounts may be created on a system after initial setup by connecting or integrating it with another application. For example, when an ESXi server is connected to a vCenter server, a default privileged account called `vpxuser` is created on the ESXi server. If a threat actor is able to compromise this account’s credentials (for example, via [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212) on the vCenter host), they will then have access to the ESXi server.(Citation: Google Cloud Threat Intelligence VMWare ESXi Zero-Day 2023)(Citation: Pentera vCenter Information Disclosure)",
          "attack_pattern_external_id" : "T1078.001",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "0a4b5f21-1067-4f02-ac43-9bf29c22b036",
            "phase_external_id" : "TA0001",
            "phase_stix_id" : "x-mitre-tactic--ffd5bcee-6e16-4dd2-8eca-7b3beedf33ca",
            "phase_name" : "Initial Access",
            "phase_shortname" : "initial-access",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to get into your network.\n\nInitial Access consists of techniques that use various entry vectors to gain their initial foothold within a network. Techniques used to gain a foothold include targeted spearphishing and exploiting weaknesses on public-facing web servers. Footholds gained through initial access may allow for continued access, like valid accounts and use of external remote services, or may be limited-use due to changing passwords.",
            "phase_order" : 2
          }, {
            "phase_id" : "85f85b70-0513-4765-a231-c6de150aad97",
            "phase_external_id" : "TA0004",
            "phase_stix_id" : "x-mitre-tactic--5e29b093-294e-49e9-a803-dab3d73b77dd",
            "phase_name" : "Privilege Escalation",
            "phase_shortname" : "privilege-escalation",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to gain higher-level permissions.\n\nPrivilege Escalation consists of techniques that adversaries use to gain higher-level permissions on a system or network. Adversaries can often enter and explore a network with unprivileged access but require elevated permissions to follow through on their objectives. Common approaches are to take advantage of system weaknesses, misconfigurations, and vulnerabilities. Examples of elevated access include: \n\n* SYSTEM/root level\n* local administrator\n* user account with admin-like access \n* user accounts with access to specific system or perform specific function\n\nThese techniques often overlap with Persistence techniques, as OS features that let an adversary persist can execute in an elevated context.  ",
            "phase_order" : 5
          }, {
            "phase_id" : "8bbdf37e-90c1-4e8a-98e9-a0fd61c92930",
            "phase_external_id" : "TA0003",
            "phase_stix_id" : "x-mitre-tactic--5bc1d813-693e-4823-9961-abf9af4b0e92",
            "phase_name" : "Persistence",
            "phase_shortname" : "persistence",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to maintain their foothold.\n\nPersistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access. Techniques used for persistence include any access, action, or configuration changes that let them maintain their foothold on systems, such as replacing or hijacking legitimate code or adding startup code. ",
            "phase_order" : 4
          }, {
            "phase_id" : "92c4f727-b17e-4641-825d-ac5e3bc97527",
            "phase_external_id" : "TA0005",
            "phase_stix_id" : "x-mitre-tactic--78b23412-0651-46d7-a540-170a1ce8bd5a",
            "phase_name" : "Defense Evasion",
            "phase_shortname" : "defense-evasion",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to avoid being detected.\n\nDefense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses. ",
            "phase_order" : 6
          } ]
        }, {
          "attack_pattern_id" : "af0e3886-c53d-416d-8c99-effedb433edd",
          "attack_pattern_name" : "Password Spraying",
          "attack_pattern_description" : "Adversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials. Password spraying uses one password (e.g. 'Password01'), or a small list of commonly used passwords, that may match the complexity policy of the domain. Logins are attempted with that password against many different accounts on a network to avoid account lockouts that would normally occur when brute forcing a single account with many passwords. (Citation: BlackHillsInfosec Password Spraying)\n\nTypically, management services over commonly used ports are used when password spraying. Commonly targeted services include the following:\n\n* SSH (22/TCP)\n* Telnet (23/TCP)\n* FTP (21/TCP)\n* NetBIOS / SMB / Samba (139/TCP & 445/TCP)\n* LDAP (389/TCP)\n* Kerberos (88/TCP)\n* RDP / Terminal Services (3389/TCP)\n* HTTP/HTTP Management Services (80/TCP & 443/TCP)\n* MSSQL (1433/TCP)\n* Oracle (1521/TCP)\n* MySQL (3306/TCP)\n* VNC (5900/TCP)\n\nIn addition to management services, adversaries may \"target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols,\" as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018)\n\nIn default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows \"logon failure\" event ID 4625.",
          "attack_pattern_external_id" : "T1110.003",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "447bbaf6-82da-4c43-90c8-713bd6117a85",
            "phase_external_id" : "TA0006",
            "phase_stix_id" : "x-mitre-tactic--2558fd61-8c75-4730-94c4-11926db2a263",
            "phase_name" : "Credential Access",
            "phase_shortname" : "credential-access",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to steal account names and passwords.\n\nCredential Access consists of techniques for stealing credentials like account names and passwords. Techniques used to get credentials include keylogging or credential dumping. Using legitimate credentials can give adversaries access to systems, make them harder to detect, and provide the opportunity to create more accounts to help achieve their goals.",
            "phase_order" : 7
          } ]
        } ],
        "payload_cleanup_executor" : "psh",
        "payload_cleanup_command" : "remove-item \"C:\\users\\public\\nxc-windows-latest\" -Recurse -Force",
        "payload_elevation_required" : false,
        "payload_arguments" : [ {
          "type" : "text",
          "key" : "IP",
          "default_value" : "192.168.56.0/24",
          "description" : null,
          "separator" : null
        } ],
        "payload_prerequisites" : [ {
          "executor" : "psh",
          "get_command" : "[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12;$zipUrl = \"https://github.com/Pennyw0rth/NetExec/releases/download/v1.4.0/nxc-windows-latest.zip\"; $tempZip = \"c:\\users\\public\\nxc-windows-latest.zip\"; $tempDir = \"c:\\users\\public\\nxc-windows-latest\"; $destPath = \"c:\\users\\public\\nxc-windows-latest\\nxc.exe\" ; Invoke-WebRequest -Uri $zipUrl -OutFile $tempZip; Expand-Archive -Path $tempZip -DestinationPath $tempDir -Force; Remove-Item -Path $tempZip -Force",
          "check_command" : "if (Test-Path 'c:\\users\\public\\nxc-windows-latest\\nxc.exe') {exit 0} else {exit 1}",
          "description" : null
        } ],
        "payload_external_id" : null,
        "payload_source" : "MANUAL",
        "payload_status" : "VERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : null,
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ {
          "listened" : true,
          "output_parser_id" : "e5b78a08-7931-4049-9369-ade57561a929",
          "output_parser_mode" : "STDOUT",
          "output_parser_type" : "REGEX",
          "output_parser_contract_output_elements" : [ {
            "listened" : true,
            "contract_output_element_id" : "b7ee9815-525b-40dc-825d-cd37cbd5df9b",
            "contract_output_element_is_finding" : true,
            "contract_output_element_rule" : "^\\s*SMB\\s+(\\d{1,3}(?:\\.\\d{1,3}){3})\\s+\\d+\\s+\\S+\\s+\\[\\+].*Guest",
            "contract_output_element_name" : "Guest_Enabled",
            "contract_output_element_regex_groups" : [ {
              "listened" : true,
              "regex_group_id" : "52169fee-0675-4d24-94d2-a03323b73ab3",
              "regex_group_field" : "ipv4",
              "regex_group_index_values" : "$1",
              "regex_group_created_at" : "2025-06-26T08:10:07.745830Z",
              "regex_group_updated_at" : "2025-06-26T08:10:07.745830Z"
            } ],
            "contract_output_element_key" : "Guest_Enabled",
            "contract_output_element_type" : "ipv4",
            "contract_output_element_tags" : [ ],
            "contract_output_element_created_at" : "2025-06-26T08:10:07.742667Z",
            "contract_output_element_updated_at" : "2025-06-26T08:10:07.742667Z"
          } ],
          "output_parser_created_at" : "2025-06-26T08:10:07.739839Z",
          "output_parser_updated_at" : "2025-06-26T08:10:07.739839Z"
        } ],
        "payload_created_at" : "2025-06-26T08:10:07.732299Z",
        "payload_updated_at" : "2025-06-26T08:10:07.732300Z",
        "command_executor" : "psh",
        "command_content" : "C:\\Users\\Public\\nxc-windows-latest\\nxc.exe smb #{IP} -u a -p a\n",
        "payload_collector_type" : null
      },
      "injector_contract_created_at" : "2025-06-26T08:10:07.800671Z",
      "injector_contract_updated_at" : "2025-06-26T08:10:07.800671Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "c0ce4192-7224-42ec-b640-bec6a9501890",
        "attack_pattern_name" : "SMB/Windows Admin Shares",
        "attack_pattern_description" : "Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to interact with a remote network share using Server Message Block (SMB). The adversary may then perform actions as the logged-on user.\n\nSMB is a file, printer, and serial port sharing protocol for Windows machines on the same network or domain. Adversaries may use SMB to interact with file shares, allowing them to move laterally throughout a network. Linux and macOS implementations of SMB typically use Samba.\n\nWindows systems have hidden network shares that are accessible only to administrators and provide the ability for remote file copy and other administrative functions. Example network shares include `C$`, `ADMIN$`, and `IPC$`. Adversaries may use this technique in conjunction with administrator-level [Valid Accounts](https://attack.mitre.org/techniques/T1078) to remotely access a networked system over SMB,(Citation: Wikipedia Server Message Block) to interact with systems using remote procedure calls (RPCs),(Citation: TechNet RPC) transfer files, and run transferred binaries through remote Execution. Example execution techniques that rely on authenticated sessions over SMB/RPC are [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), [Service Execution](https://attack.mitre.org/techniques/T1569/002), and [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047). Adversaries can also use NTLM hashes to access administrator shares on systems with [Pass the Hash](https://attack.mitre.org/techniques/T1550/002) and certain configuration and patch levels.(Citation: Microsoft Admin Shares)",
        "attack_pattern_external_id" : "T1021.002",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "e03bd741-2536-48d6-8fd5-a36e0d2a3f2a",
          "phase_external_id" : "TA0008",
          "phase_stix_id" : "x-mitre-tactic--7141578b-e50b-4dcc-bfa4-08a8dd689e9e",
          "phase_name" : "Lateral Movement",
          "phase_shortname" : "lateral-movement",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to move through your environment.\n\nLateral Movement consists of techniques that adversaries use to enter and control remote systems on a network. Following through on their primary objective often requires exploring the network to find their target and subsequently gaining access to it. Reaching their objective often involves pivoting through multiple systems and accounts to gain. Adversaries might install their own remote access tools to accomplish Lateral Movement or use legitimate credentials with native network and operating system tools, which may be stealthier. ",
          "phase_order" : 9
        } ]
      }, {
        "attack_pattern_id" : "c007dc45-597d-479a-93e9-8e7f2611c020",
        "attack_pattern_name" : "Default Accounts",
        "attack_pattern_description" : "Adversaries may obtain and abuse credentials of a default account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Default accounts are those that are built-into an OS, such as the Guest or Administrator accounts on Windows systems. Default accounts also include default factory/provider set accounts on other types of systems, software, or devices, including the root user account in AWS, the root user account in ESXi, and the default service account in Kubernetes.(Citation: Microsoft Local Accounts Feb 2019)(Citation: AWS Root User)(Citation: Threat Matrix for Kubernetes)\n\nDefault accounts are not limited to client machines; rather, they also include accounts that are preset for equipment such as network devices and computer applications, whether they are internal, open source, or commercial. Appliances that come preset with a username and password combination pose a serious threat to organizations that do not change it post installation, as they are easy targets for an adversary. Similarly, adversaries may also utilize publicly disclosed or stolen [Private Keys](https://attack.mitre.org/techniques/T1552/004) or credential materials to legitimately connect to remote environments via [Remote Services](https://attack.mitre.org/techniques/T1021).(Citation: Metasploit SSH Module)\n\nDefault accounts may be created on a system after initial setup by connecting or integrating it with another application. For example, when an ESXi server is connected to a vCenter server, a default privileged account called `vpxuser` is created on the ESXi server. If a threat actor is able to compromise this account’s credentials (for example, via [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212) on the vCenter host), they will then have access to the ESXi server.(Citation: Google Cloud Threat Intelligence VMWare ESXi Zero-Day 2023)(Citation: Pentera vCenter Information Disclosure)",
        "attack_pattern_external_id" : "T1078.001",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "0a4b5f21-1067-4f02-ac43-9bf29c22b036",
          "phase_external_id" : "TA0001",
          "phase_stix_id" : "x-mitre-tactic--ffd5bcee-6e16-4dd2-8eca-7b3beedf33ca",
          "phase_name" : "Initial Access",
          "phase_shortname" : "initial-access",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to get into your network.\n\nInitial Access consists of techniques that use various entry vectors to gain their initial foothold within a network. Techniques used to gain a foothold include targeted spearphishing and exploiting weaknesses on public-facing web servers. Footholds gained through initial access may allow for continued access, like valid accounts and use of external remote services, or may be limited-use due to changing passwords.",
          "phase_order" : 2
        }, {
          "phase_id" : "85f85b70-0513-4765-a231-c6de150aad97",
          "phase_external_id" : "TA0004",
          "phase_stix_id" : "x-mitre-tactic--5e29b093-294e-49e9-a803-dab3d73b77dd",
          "phase_name" : "Privilege Escalation",
          "phase_shortname" : "privilege-escalation",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to gain higher-level permissions.\n\nPrivilege Escalation consists of techniques that adversaries use to gain higher-level permissions on a system or network. Adversaries can often enter and explore a network with unprivileged access but require elevated permissions to follow through on their objectives. Common approaches are to take advantage of system weaknesses, misconfigurations, and vulnerabilities. Examples of elevated access include: \n\n* SYSTEM/root level\n* local administrator\n* user account with admin-like access \n* user accounts with access to specific system or perform specific function\n\nThese techniques often overlap with Persistence techniques, as OS features that let an adversary persist can execute in an elevated context.  ",
          "phase_order" : 5
        }, {
          "phase_id" : "8bbdf37e-90c1-4e8a-98e9-a0fd61c92930",
          "phase_external_id" : "TA0003",
          "phase_stix_id" : "x-mitre-tactic--5bc1d813-693e-4823-9961-abf9af4b0e92",
          "phase_name" : "Persistence",
          "phase_shortname" : "persistence",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to maintain their foothold.\n\nPersistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access. Techniques used for persistence include any access, action, or configuration changes that let them maintain their foothold on systems, such as replacing or hijacking legitimate code or adding startup code. ",
          "phase_order" : 4
        }, {
          "phase_id" : "92c4f727-b17e-4641-825d-ac5e3bc97527",
          "phase_external_id" : "TA0005",
          "phase_stix_id" : "x-mitre-tactic--78b23412-0651-46d7-a540-170a1ce8bd5a",
          "phase_name" : "Defense Evasion",
          "phase_shortname" : "defense-evasion",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to avoid being detected.\n\nDefense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses. ",
          "phase_order" : 6
        } ]
      }, {
        "attack_pattern_id" : "af0e3886-c53d-416d-8c99-effedb433edd",
        "attack_pattern_name" : "Password Spraying",
        "attack_pattern_description" : "Adversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials. Password spraying uses one password (e.g. 'Password01'), or a small list of commonly used passwords, that may match the complexity policy of the domain. Logins are attempted with that password against many different accounts on a network to avoid account lockouts that would normally occur when brute forcing a single account with many passwords. (Citation: BlackHillsInfosec Password Spraying)\n\nTypically, management services over commonly used ports are used when password spraying. Commonly targeted services include the following:\n\n* SSH (22/TCP)\n* Telnet (23/TCP)\n* FTP (21/TCP)\n* NetBIOS / SMB / Samba (139/TCP & 445/TCP)\n* LDAP (389/TCP)\n* Kerberos (88/TCP)\n* RDP / Terminal Services (3389/TCP)\n* HTTP/HTTP Management Services (80/TCP & 443/TCP)\n* MSSQL (1433/TCP)\n* Oracle (1521/TCP)\n* MySQL (3306/TCP)\n* VNC (5900/TCP)\n\nIn addition to management services, adversaries may \"target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols,\" as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018)\n\nIn default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows \"logon failure\" event ID 4625.",
        "attack_pattern_external_id" : "T1110.003",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "447bbaf6-82da-4c43-90c8-713bd6117a85",
          "phase_external_id" : "TA0006",
          "phase_stix_id" : "x-mitre-tactic--2558fd61-8c75-4730-94c4-11926db2a263",
          "phase_name" : "Credential Access",
          "phase_shortname" : "credential-access",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to steal account names and passwords.\n\nCredential Access consists of techniques for stealing credentials like account names and passwords. Techniques used to get credentials include keylogging or credential dumping. Using legitimate credentials can give adversaries access to systems, make them harder to detect, and provide the opportunity to create more accounts to help achieve their goals.",
          "phase_order" : 7
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  }, {
    "inject_id" : "3c99becc-4a46-4a9c-b716-d252b6fa91dd",
    "inject_title" : "SMB Lateral Movement - Enumeration Null Session - Windows",
    "inject_description" : "",
    "inject_country" : null,
    "inject_city" : null,
    "inject_enabled" : true,
    "inject_content" : {
      "expectations" : [ {
        "expectation_type" : "PREVENTION",
        "expectation_name" : "Prevention",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      }, {
        "expectation_type" : "DETECTION",
        "expectation_name" : "Detection",
        "expectation_description" : null,
        "expectation_score" : 100,
        "expectation_expectation_group" : false,
        "expectation_expiration_time" : 21600
      } ],
      "obfuscator" : "plain-text",
      "IP" : "127.0.0.1"
    },
    "inject_all_teams" : false,
    "inject_depends_on" : [ ],
    "inject_depends_duration" : 120,
    "inject_injector_contract" : {
      "convertedContent" : {
        "config" : {
          "type" : "openbas_implant",
          "expose" : true,
          "label" : {
            "en" : "OpenBAS Implant",
            "fr" : "OpenBAS Implant"
          },
          "color_dark" : "#000000",
          "color_light" : "#000000"
        },
        "label" : {
          "en" : "SMB Lateral Movement - Enumeration Null Session - Windows",
          "fr" : "SMB Lateral Movement - Enumeration Null Session - Windows"
        },
        "manual" : false,
        "fields" : [ {
          "key" : "assets",
          "label" : "Assets",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset"
        }, {
          "key" : "assetgroups",
          "label" : "Asset groups",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : [ "assets", "assetgroups" ],
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "type" : "asset-group"
        }, {
          "key" : "obfuscator",
          "label" : "Obfuscators",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "1",
          "defaultValue" : [ "plain-text" ],
          "choices" : [ {
            "label" : "plain-text",
            "value" : "plain-text",
            "information" : ""
          }, {
            "label" : "base64",
            "value" : "base64",
            "information" : "CMD does not support base64 obfuscation"
          } ],
          "type" : "choice"
        }, {
          "key" : "expectations",
          "label" : "Expectations",
          "mandatory" : false,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "cardinality" : "n",
          "defaultValue" : [ ],
          "predefinedExpectations" : [ {
            "expectation_type" : "PREVENTION",
            "expectation_name" : "Prevention",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "DETECTION",
            "expectation_name" : "Detection",
            "expectation_description" : null,
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          }, {
            "expectation_type" : "VULNERABILITY",
            "expectation_name" : "Not vulnerable",
            "expectation_description" : "",
            "expectation_score" : 100.0,
            "expectation_expectation_group" : false,
            "expectation_expiration_time" : 21600
          } ],
          "type" : "expectation"
        }, {
          "key" : "IP",
          "label" : "IP",
          "mandatory" : true,
          "readOnly" : false,
          "mandatoryGroups" : null,
          "mandatoryConditionField" : null,
          "mandatoryConditionValue" : null,
          "linkedFields" : [ ],
          "linkedValues" : [ ],
          "defaultValue" : "192.168.56.0/24",
          "type" : "text"
        } ],
        "variables" : [ {
          "key" : "user",
          "label" : "User that will receive the injection",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ {
            "key" : "user.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.email",
            "label" : "Email of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.firstname",
            "label" : "First name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lastname",
            "label" : "Last name of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "user.lang",
            "label" : "Language of the user",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "exercise",
          "label" : "Exercise of the current injection",
          "type" : "Object",
          "cardinality" : "1",
          "children" : [ {
            "key" : "exercise.id",
            "label" : "Id of the user in the platform",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.name",
            "label" : "Name of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          }, {
            "key" : "exercise.description",
            "label" : "Description of the exercise",
            "type" : "String",
            "cardinality" : "1",
            "children" : [ ]
          } ]
        }, {
          "key" : "teams",
          "label" : "List of team name for the injection",
          "type" : "String",
          "cardinality" : "n",
          "children" : [ ]
        }, {
          "key" : "player_uri",
          "label" : "Player interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "challenges_uri",
          "label" : "Challenges interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "scoreboard_uri",
          "label" : "Scoreboard interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        }, {
          "key" : "lessons_uri",
          "label" : "Lessons learned interface platform link",
          "type" : "String",
          "cardinality" : "1",
          "children" : [ ]
        } ],
        "context" : { },
        "contract_id" : "2092af6a-3dad-4f98-ab32-5e0f4acff4fe",
        "contract_attack_patterns_external_ids" : [ ],
        "is_atomic_testing" : true,
        "needs_executor" : true,
        "platforms" : [ "Windows" ]
      },
      "listened" : true,
      "injector_contract_id" : "2092af6a-3dad-4f98-ab32-5e0f4acff4fe",
      "injector_contract_labels" : {
        "en" : "SMB Lateral Movement - Enumeration Null Session - Windows",
        "fr" : "SMB Lateral Movement - Enumeration Null Session - Windows"
      },
      "injector_contract_manual" : false,
      "injector_contract_content" : "{\"config\":{\"type\":\"openbas_implant\",\"expose\":true,\"label\":{\"en\":\"OpenBAS Implant\",\"fr\":\"OpenBAS Implant\"},\"color_dark\":\"#000000\",\"color_light\":\"#000000\"},\"label\":{\"en\":\"SMB Lateral Movement - Enumeration Null Session - Windows\",\"fr\":\"SMB Lateral Movement - Enumeration Null Session - Windows\"},\"manual\":false,\"fields\":[{\"key\":\"assets\",\"label\":\"Assets\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset\"},{\"key\":\"assetgroups\",\"label\":\"Asset groups\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":[\"assets\",\"assetgroups\"],\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"type\":\"asset-group\"},{\"key\":\"obfuscator\",\"label\":\"Obfuscators\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"1\",\"defaultValue\":[\"plain-text\"],\"choices\":[{\"label\":\"plain-text\",\"value\":\"plain-text\",\"information\":\"\"},{\"label\":\"base64\",\"value\":\"base64\",\"information\":\"CMD does not support base64 obfuscation\"}],\"type\":\"choice\"},{\"key\":\"expectations\",\"label\":\"Expectations\",\"mandatory\":false,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"cardinality\":\"n\",\"defaultValue\":[],\"predefinedExpectations\":[{\"expectation_type\":\"PREVENTION\",\"expectation_name\":\"Prevention\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"DETECTION\",\"expectation_name\":\"Detection\",\"expectation_description\":null,\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600},{\"expectation_type\":\"VULNERABILITY\",\"expectation_name\":\"Not vulnerable\",\"expectation_description\":\"\",\"expectation_score\":100.0,\"expectation_expectation_group\":false,\"expectation_expiration_time\":21600}],\"type\":\"expectation\"},{\"key\":\"IP\",\"label\":\"IP\",\"mandatory\":true,\"readOnly\":false,\"mandatoryGroups\":null,\"mandatoryConditionField\":null,\"mandatoryConditionValue\":null,\"linkedFields\":[],\"linkedValues\":[],\"defaultValue\":\"192.168.56.0/24\",\"type\":\"text\"}],\"variables\":[{\"key\":\"user\",\"label\":\"User that will receive the injection\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[{\"key\":\"user.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.email\",\"label\":\"Email of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.firstname\",\"label\":\"First name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lastname\",\"label\":\"Last name of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"user.lang\",\"label\":\"Language of the user\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"exercise\",\"label\":\"Exercise of the current injection\",\"type\":\"Object\",\"cardinality\":\"1\",\"children\":[{\"key\":\"exercise.id\",\"label\":\"Id of the user in the platform\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.name\",\"label\":\"Name of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"exercise.description\",\"label\":\"Description of the exercise\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}]},{\"key\":\"teams\",\"label\":\"List of team name for the injection\",\"type\":\"String\",\"cardinality\":\"n\",\"children\":[]},{\"key\":\"player_uri\",\"label\":\"Player interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"challenges_uri\",\"label\":\"Challenges interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"scoreboard_uri\",\"label\":\"Scoreboard interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]},{\"key\":\"lessons_uri\",\"label\":\"Lessons learned interface platform link\",\"type\":\"String\",\"cardinality\":\"1\",\"children\":[]}],\"context\":{},\"contract_id\":\"2092af6a-3dad-4f98-ab32-5e0f4acff4fe\",\"contract_attack_patterns_external_ids\":[],\"is_atomic_testing\":true,\"needs_executor\":true,\"platforms\":[\"Windows\"]}",
      "injector_contract_custom" : false,
      "injector_contract_needs_executor" : true,
      "injector_contract_platforms" : [ "Windows" ],
      "injector_contract_payload" : {
        "listened" : true,
        "payload_id" : "6aaa6349-7091-4ff0-8ec3-b677bc67bee8",
        "payload_type" : "Command",
        "payload_name" : "SMB Lateral Movement - Enumeration Null Session - Windows",
        "payload_description" : "Null session, also known as anonymous authentication, is a special kind of authentication during which the user doesn’t submit any credentials. When a user connects via a null session, he connects as a member of the “Anonymous Logon” group and inherits all ACL’s assigned to this group. You can launch a null session authentication using the following commands with Netexec:\n\nReference: https://blog.whiteflag.io/blog/guest-vs-null-session-on-windows/",
        "payload_platforms" : [ "Windows" ],
        "payload_attack_patterns" : [ {
          "attack_pattern_id" : "7bdfe370-166f-4bd6-af6c-f46ec37a0a59",
          "attack_pattern_name" : "Domain Account",
          "attack_pattern_description" : "Adversaries may attempt to get a listing of domain accounts. This information can help adversaries determine which domain accounts exist to aid in follow-on behavior such as targeting specific accounts which possess particular privileges.\n\nCommands such as <code>net user /domain</code> and <code>net group /domain</code> of the [Net](https://attack.mitre.org/software/S0039) utility, <code>dscacheutil -q group</code> on macOS, and <code>ldapsearch</code> on Linux can list domain users and groups. [PowerShell](https://attack.mitre.org/techniques/T1059/001) cmdlets including <code>Get-ADUser</code> and <code>Get-ADGroupMember</code> may enumerate members of Active Directory groups.(Citation: CrowdStrike StellarParticle January 2022)  ",
          "attack_pattern_external_id" : "T1087.002",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
            "phase_external_id" : "TA0007",
            "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
            "phase_name" : "Discovery",
            "phase_shortname" : "discovery",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
            "phase_order" : 8
          } ]
        }, {
          "attack_pattern_id" : "11201cbd-c89d-4592-9dd6-61e2655637f3",
          "attack_pattern_name" : "Domain Groups",
          "attack_pattern_description" : "Adversaries may attempt to find domain-level groups and permission settings. The knowledge of domain-level permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as domain administrators.\n\nCommands such as <code>net group /domain</code> of the [Net](https://attack.mitre.org/software/S0039) utility,  <code>dscacheutil -q group</code> on macOS, and <code>ldapsearch</code> on Linux can list domain-level groups.",
          "attack_pattern_external_id" : "T1069.002",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
            "phase_external_id" : "TA0007",
            "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
            "phase_name" : "Discovery",
            "phase_shortname" : "discovery",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
            "phase_order" : 8
          } ]
        }, {
          "attack_pattern_id" : "853024a5-e051-4d81-b63a-1cdde660a397",
          "attack_pattern_name" : "Remote System Discovery",
          "attack_pattern_description" : "Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used such as  [Ping](https://attack.mitre.org/software/S0097), <code>net view</code> using [Net](https://attack.mitre.org/software/S0039), or, on ESXi servers, `esxcli network diag ping`.\n\nAdversaries may also analyze data from local host files (ex: <code>C:\\Windows\\System32\\Drivers\\etc\\hosts</code> or <code>/etc/hosts</code>) or other passive means (such as local [Arp](https://attack.mitre.org/software/S0099) cache entries) in order to discover the presence of remote systems in an environment.\n\nAdversaries may also target discovery of network infrastructure as well as leverage [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands on network devices to gather detailed information about systems within a network (e.g. <code>show cdp neighbors</code>, <code>show arp</code>).(Citation: US-CERT-TA18-106A)(Citation: CISA AR21-126A FIVEHANDS May 2021)  \n",
          "attack_pattern_external_id" : "T1018",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
            "phase_external_id" : "TA0007",
            "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
            "phase_name" : "Discovery",
            "phase_shortname" : "discovery",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
            "phase_order" : 8
          } ]
        }, {
          "attack_pattern_id" : "88d152fe-21af-49f0-bbd5-377598e9f6e9",
          "attack_pattern_name" : "Network Service Discovery",
          "attack_pattern_description" : "Adversaries may attempt to get a listing of services running on remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation. Common methods to acquire this information include port, vulnerability, and/or wordlist scans using tools that are brought onto a system.(Citation: CISA AR21-126A FIVEHANDS May 2021)   \n\nWithin cloud environments, adversaries may attempt to discover services running on other cloud hosts. Additionally, if the cloud environment is connected to a on-premises environment, adversaries may be able to identify services running on non-cloud systems as well.\n\nWithin macOS environments, adversaries may use the native Bonjour application to discover services running on other macOS hosts within a network. The Bonjour mDNSResponder daemon automatically registers and advertises a host’s registered services on the network. For example, adversaries can use a mDNS query (such as <code>dns-sd -B _ssh._tcp .</code>) to find other systems broadcasting the ssh service.(Citation: apple doco bonjour description)(Citation: macOS APT Activity Bradley)",
          "attack_pattern_external_id" : "T1046",
          "attack_pattern_kill_chain_phases" : [ {
            "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
            "phase_external_id" : "TA0007",
            "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
            "phase_name" : "Discovery",
            "phase_shortname" : "discovery",
            "phase_kill_chain_name" : "mitre-attack",
            "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
            "phase_order" : 8
          } ]
        } ],
        "payload_cleanup_executor" : "psh",
        "payload_cleanup_command" : "remove-item \"C:\\users\\public\\nxc-windows-latest\" -Recurse -Force",
        "payload_elevation_required" : false,
        "payload_arguments" : [ {
          "type" : "text",
          "key" : "IP",
          "default_value" : "192.168.56.0/24",
          "description" : null,
          "separator" : null
        } ],
        "payload_prerequisites" : [ {
          "executor" : "psh",
          "get_command" : "[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12;$zipUrl = \"https://github.com/Pennyw0rth/NetExec/releases/download/v1.4.0/nxc-windows-latest.zip\"; $tempZip = \"c:\\users\\public\\nxc-windows-latest.zip\"; $tempDir = \"c:\\users\\public\\nxc-windows-latest\"; $destPath = \"c:\\users\\public\\nxc-windows-latest\\nxc.exe\" ; Invoke-WebRequest -Uri $zipUrl -OutFile $tempZip; Expand-Archive -Path $tempZip -DestinationPath $tempDir -Force; Remove-Item -Path $tempZip -Force",
          "check_command" : "if (Test-Path 'c:\\users\\public\\nxc-windows-latest\\nxc.exe') {exit 0} else {exit 1}",
          "description" : null
        } ],
        "payload_external_id" : null,
        "payload_source" : "MANUAL",
        "payload_status" : "UNVERIFIED",
        "payload_execution_arch" : "ALL_ARCHITECTURES",
        "payload_collector" : null,
        "payload_detection_remediations" : [ ],
        "payload_tags" : [ ],
        "payload_output_parsers" : [ {
          "listened" : true,
          "output_parser_id" : "91491f79-c99d-463c-8de3-c3a341dbac3d",
          "output_parser_mode" : "STDOUT",
          "output_parser_type" : "REGEX",
          "output_parser_contract_output_elements" : [ {
            "listened" : true,
            "contract_output_element_id" : "96be0dbf-1932-4d60-91a3-d56ff9ea31dc",
            "contract_output_element_is_finding" : true,
            "contract_output_element_rule" : "^\\s*SMB\\s+(\\d{1,3}(?:\\.\\d{1,3}){3})\\s+\\d+\\s+\\S+\\s+\\[\\+\\](?!.*Guest)",
            "contract_output_element_name" : "anonymous",
            "contract_output_element_regex_groups" : [ {
              "listened" : true,
              "regex_group_id" : "031fe86b-55e3-4442-a394-57f7cf5137c3",
              "regex_group_field" : "ipv4",
              "regex_group_index_values" : "$1",
              "regex_group_created_at" : "2025-06-26T08:10:08.255374Z",
              "regex_group_updated_at" : "2025-06-26T08:10:08.255374Z"
            } ],
            "contract_output_element_key" : "anonymous",
            "contract_output_element_type" : "ipv4",
            "contract_output_element_tags" : [ ],
            "contract_output_element_created_at" : "2025-06-26T08:10:08.255113Z",
            "contract_output_element_updated_at" : "2025-06-26T08:10:08.255113Z"
          } ],
          "output_parser_created_at" : "2025-06-26T08:10:08.255042Z",
          "output_parser_updated_at" : "2025-06-26T08:10:08.255042Z"
        } ],
        "payload_created_at" : "2025-06-26T08:10:08.254824Z",
        "payload_updated_at" : "2025-06-26T08:10:08.254825Z",
        "command_executor" : "cmd",
        "command_content" : "C:\\Users\\Public\\nxc-windows-latest\\nxc.exe smb #{IP} -u '' -p ''",
        "payload_collector_type" : null
      },
      "injector_contract_created_at" : "2025-06-26T08:10:08.301867Z",
      "injector_contract_updated_at" : "2025-06-26T08:10:08.301867Z",
      "injector_contract_injector" : "49229430-b5b5-431f-ba5b-f36f599b0144",
      "injector_contract_attack_patterns" : [ {
        "attack_pattern_id" : "7bdfe370-166f-4bd6-af6c-f46ec37a0a59",
        "attack_pattern_name" : "Domain Account",
        "attack_pattern_description" : "Adversaries may attempt to get a listing of domain accounts. This information can help adversaries determine which domain accounts exist to aid in follow-on behavior such as targeting specific accounts which possess particular privileges.\n\nCommands such as <code>net user /domain</code> and <code>net group /domain</code> of the [Net](https://attack.mitre.org/software/S0039) utility, <code>dscacheutil -q group</code> on macOS, and <code>ldapsearch</code> on Linux can list domain users and groups. [PowerShell](https://attack.mitre.org/techniques/T1059/001) cmdlets including <code>Get-ADUser</code> and <code>Get-ADGroupMember</code> may enumerate members of Active Directory groups.(Citation: CrowdStrike StellarParticle January 2022)  ",
        "attack_pattern_external_id" : "T1087.002",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
          "phase_external_id" : "TA0007",
          "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
          "phase_name" : "Discovery",
          "phase_shortname" : "discovery",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
          "phase_order" : 8
        } ]
      }, {
        "attack_pattern_id" : "11201cbd-c89d-4592-9dd6-61e2655637f3",
        "attack_pattern_name" : "Domain Groups",
        "attack_pattern_description" : "Adversaries may attempt to find domain-level groups and permission settings. The knowledge of domain-level permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as domain administrators.\n\nCommands such as <code>net group /domain</code> of the [Net](https://attack.mitre.org/software/S0039) utility,  <code>dscacheutil -q group</code> on macOS, and <code>ldapsearch</code> on Linux can list domain-level groups.",
        "attack_pattern_external_id" : "T1069.002",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
          "phase_external_id" : "TA0007",
          "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
          "phase_name" : "Discovery",
          "phase_shortname" : "discovery",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
          "phase_order" : 8
        } ]
      }, {
        "attack_pattern_id" : "853024a5-e051-4d81-b63a-1cdde660a397",
        "attack_pattern_name" : "Remote System Discovery",
        "attack_pattern_description" : "Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used such as  [Ping](https://attack.mitre.org/software/S0097), <code>net view</code> using [Net](https://attack.mitre.org/software/S0039), or, on ESXi servers, `esxcli network diag ping`.\n\nAdversaries may also analyze data from local host files (ex: <code>C:\\Windows\\System32\\Drivers\\etc\\hosts</code> or <code>/etc/hosts</code>) or other passive means (such as local [Arp](https://attack.mitre.org/software/S0099) cache entries) in order to discover the presence of remote systems in an environment.\n\nAdversaries may also target discovery of network infrastructure as well as leverage [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands on network devices to gather detailed information about systems within a network (e.g. <code>show cdp neighbors</code>, <code>show arp</code>).(Citation: US-CERT-TA18-106A)(Citation: CISA AR21-126A FIVEHANDS May 2021)  \n",
        "attack_pattern_external_id" : "T1018",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
          "phase_external_id" : "TA0007",
          "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
          "phase_name" : "Discovery",
          "phase_shortname" : "discovery",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
          "phase_order" : 8
        } ]
      }, {
        "attack_pattern_id" : "88d152fe-21af-49f0-bbd5-377598e9f6e9",
        "attack_pattern_name" : "Network Service Discovery",
        "attack_pattern_description" : "Adversaries may attempt to get a listing of services running on remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation. Common methods to acquire this information include port, vulnerability, and/or wordlist scans using tools that are brought onto a system.(Citation: CISA AR21-126A FIVEHANDS May 2021)   \n\nWithin cloud environments, adversaries may attempt to discover services running on other cloud hosts. Additionally, if the cloud environment is connected to a on-premises environment, adversaries may be able to identify services running on non-cloud systems as well.\n\nWithin macOS environments, adversaries may use the native Bonjour application to discover services running on other macOS hosts within a network. The Bonjour mDNSResponder daemon automatically registers and advertises a host’s registered services on the network. For example, adversaries can use a mDNS query (such as <code>dns-sd -B _ssh._tcp .</code>) to find other systems broadcasting the ssh service.(Citation: apple doco bonjour description)(Citation: macOS APT Activity Bradley)",
        "attack_pattern_external_id" : "T1046",
        "attack_pattern_kill_chain_phases" : [ {
          "phase_id" : "e0a815b3-1d61-4145-915a-d17482f5887d",
          "phase_external_id" : "TA0007",
          "phase_stix_id" : "x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9",
          "phase_name" : "Discovery",
          "phase_shortname" : "discovery",
          "phase_kill_chain_name" : "mitre-attack",
          "phase_description" : "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
          "phase_order" : 8
        } ]
      } ],
      "injector_contract_atomic_testing" : true,
      "injector_contract_import_available" : false,
      "injector_contract_arch" : "ALL_ARCHITECTURES",
      "injector_contract_injector_type" : "openbas_implant",
      "injector_contract_injector_type_name" : "OpenBAS Implant"
    },
    "inject_tags" : [ ],
    "inject_teams" : [ ],
    "inject_documents" : [ ]
  } ],
  "scenario_tags" : [ ],
  "scenario_documents" : [ ],
  "scenario_channels" : [ ],
  "scenario_articles" : [ ],
  "scenario_challenges" : [ ],
  "scenario_lessons_categories" : [ ],
  "scenario_lessons_questions" : [ ],
  "scenario_variables" : [ ]
}
